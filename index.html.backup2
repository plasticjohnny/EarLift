<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="ToneDeath - Conquer tone deafness with ear training exercises">
    <meta name="theme-color" content="#2D5016">

    <!-- Prevent caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ToneDeath">

    <title>ToneDeath - Ear Training App</title>

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css?v=8">
</head>
<body>
    <!-- Setup Flow -->
    <div id="setupContainer" class="container" style="display: none;">
        <header>
            <h1>ToneDeath</h1>
            <p class="subtitle">Welcome! Let's set up your vocal range</p>
            <button id="audioSettingsBtn" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card">
                <div id="setupStepChoice" class="setup-step">
                    <h2>Choose Your Setup Method</h2>
                    <p>Select a standard vocal range or measure your own</p>

                    <div class="range-choice-container">
                        <button id="chooseStandardRangeBtn" class="btn-primary range-choice-btn">
                            <div class="btn-icon">üéº</div>
                            <div class="btn-text">Standard Range</div>
                            <div class="btn-subtitle">Select from common voice types</div>
                        </button>

                        <div class="choice-divider">
                            <span>OR</span>
                        </div>

                        <button id="chooseCustomRangeBtn" class="btn-primary range-choice-btn">
                            <div class="btn-icon">üé§</div>
                            <div class="btn-text">Custom Range</div>
                            <div class="btn-subtitle">Sing to find your range</div>
                        </button>
                    </div>
                </div>

                <div id="setupStepStandard" class="setup-step" style="display: none;">
                    <h2>Select Your Voice Type</h2>
                    <p>Choose the standard range that best matches your voice</p>

                    <div class="standard-ranges">
                        <button class="standard-range-btn" data-range="bass">
                            <div class="range-name">Bass</div>
                            <div class="range-notes">E2 - E4</div>
                            <div class="range-freq">82 - 330 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="baritone">
                            <div class="range-name">Baritone</div>
                            <div class="range-notes">A2 - A4</div>
                            <div class="range-freq">110 - 440 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="tenor">
                            <div class="range-name">Tenor</div>
                            <div class="range-notes">C3 - C5</div>
                            <div class="range-freq">131 - 523 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="alto">
                            <div class="range-name">Alto</div>
                            <div class="range-notes">F3 - F5</div>
                            <div class="range-freq">175 - 698 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="mezzo">
                            <div class="range-name">Mezzo-Soprano</div>
                            <div class="range-notes">A3 - A5</div>
                            <div class="range-freq">220 - 880 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="soprano">
                            <div class="range-name">Soprano</div>
                            <div class="range-notes">C4 - C6</div>
                            <div class="range-freq">262 - 1047 Hz</div>
                        </button>
                    </div>

                    <button id="backToChoiceBtn" class="btn-secondary" style="margin-top: 20px;">Back</button>
                </div>

                <div id="setupPromptLow" class="setup-step setup-prompt" style="display: none;">
                    <div class="prompt-content">
                        <h2>Let's Find Your Vocal Range</h2>
                        <p>To help your ear, we need to know your vocal range. We will start with the lowest note you can sing.</p>
                        <button id="startLowNoteBtn" class="btn-primary">Start</button>
                        <button id="cancelPromptLowBtn" class="btn-secondary" style="margin-top: 10px;">Cancel</button>
                    </div>
                </div>

                <div id="setupStep1" class="setup-step" style="display: none;">
                    <h2>Step 1: Find Your Low Note</h2>
                    <p>Sing the lowest comfortable note you can sustain for a few seconds.</p>
                    <p class="instruction">Hold your lowest note steadily until the button appears.</p>

                    <div class="vocal-range-container">
                        <div class="pitch-display-with-range">
                            <div class="pitch-display">
                                <div id="lowNoteName" class="note-name">--</div>
                                <div id="lowNoteFreq" class="note-freq">-- Hz</div>
                            </div>

                            <div class="range-bar-container">
                                <div class="range-bar">
                                    <div class="range-labels">
                                        <span class="range-label-top">High</span>
                                        <span class="range-label-bottom">Low</span>
                                    </div>
                                    <div class="range-bar-background"></div>
                                    <div id="lowRangeFill" class="range-fill" style="height: 0%;"></div>
                                    <div id="lowRangeMarker" class="range-marker" style="bottom: 0%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button id="setLowBtn" class="btn-success" style="display: none;">Set Note</button>
                    <button id="cancelLowBtn" class="btn-secondary" style="margin-top: 10px;">Cancel</button>
                </div>

                <div id="setupPromptHigh" class="setup-step setup-prompt" style="display: none;">
                    <div class="prompt-content">
                        <h2>Great! Now Your High Note</h2>
                        <p>Thanks! Now we need to set your highest note. Remember to sit up straight and relax your jaw.</p>
                        <button id="cancelPromptHighBtn" class="btn-secondary">Back</button>
                        <button id="startHighNoteBtn" class="btn-primary" style="margin-top: 10px;">Continue</button>
                    </div>
                </div>

                <div id="setupStep2" class="setup-step" style="display: none;">
                    <h2>Step 2: Find Your High Note</h2>
                    <p>Sing the highest comfortable note you can sustain for a few seconds.</p>
                    <p class="instruction">Hold your highest note steadily until the button appears.</p>

                    <div class="vocal-range-container">
                        <div class="pitch-display-with-range">
                            <div class="pitch-display">
                                <div id="highNoteName" class="note-name">--</div>
                                <div id="highNoteFreq" class="note-freq">-- Hz</div>
                            </div>

                            <div class="range-bar-container">
                                <div class="range-bar">
                                    <div class="range-labels">
                                        <span class="range-label-top">High</span>
                                        <span class="range-label-bottom">Low</span>
                                    </div>
                                    <div class="range-bar-background"></div>
                                    <div id="highRangeFill" class="range-fill" style="height: 0%;"></div>
                                    <div id="highRangeMarker" class="range-marker" style="bottom: 0%;"></div>
                                    <div id="highLowMarker" class="range-low-marker" style="bottom: 0%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button id="setHighBtn" class="btn-success" style="display: none;">Set Note</button>
                    <button id="cancelHighBtn" class="btn-secondary" style="margin-top: 10px;">Back</button>
                </div>

                <div id="setupStep3" class="setup-step" style="display: none;">
                    <h2>‚úì Setup Complete!</h2>
                    <p>Your vocal range has been saved:</p>

                    <div class="range-summary">
                        <div class="range-item">
                            <span class="range-label">Low Note:</span>
                            <span id="summaryLowNote" class="range-value">--</span>
                        </div>
                        <div class="range-item">
                            <span class="range-label">High Note:</span>
                            <span id="summaryHighNote" class="range-value">--</span>
                        </div>
                    </div>

                    <button id="redoSetupBtn" class="btn-secondary" style="margin-bottom: 10px;">Redo</button>
                    <button id="startAppBtn" class="btn-primary">Start Training</button>
                </div>
            </section>
        </main>
    </div>

    <!-- Main App -->
    <div id="appContainer" class="container" style="display: none;">
        <header>
            <h1>ToneDeath</h1>
            <p class="subtitle">Conquer tone deafness</p>
            <button id="audioSettingsBtnMain" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card">
                <h2>Choose an Exercise</h2>

                <!-- Tutorial Section -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üìö Tutorial</h3>
                        <button class="category-toggle" aria-label="Toggle Tutorial section">‚àí</button>
                    </div>
                    <p class="category-description">Start here! Guided exercises to learn the basics</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="earTrainingOverview">
                            <div class="exercise-icon">üìñ</div>
                            <h3>Ear Training Overview</h3>
                            <p>Learn the fundamentals of ear training</p>
                        </button>
                        <button class="exercise-card" data-exercise="intervalOverview">
                            <div class="exercise-icon">‚ö°</div>
                            <h3>Interval Overview</h3>
                            <p>Interactive tutorial on frequency, pitch, and intervals</p>
                        </button>
                    </div>
                </div>

                <!-- Unison Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéØ Unison Exercises</h3>
                        <button class="category-toggle" aria-label="Toggle Unison Exercises section">‚àí</button>
                    </div>
                    <p class="category-description">Match single pitches with precision</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="unisonOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Unison Overview</h3>
                            <p>Learn about pitch, frequency, and matching tones</p>
                        </button>

                        <button class="exercise-card" data-exercise="pitch">
                            <div class="exercise-icon">üé§</div>
                            <h3>Unison Explore</h3>
                            <p>Match your voice to the tone</p>
                        </button>

                        <button class="exercise-card" data-exercise="pitchhold">
                            <div class="exercise-icon">üëç</div>
                            <h3>Car Pitch Hold</h3>
                            <p>Hold a pitch for 3 seconds</p>
                        </button>

                        <button class="exercise-card" data-exercise="toneSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Tone Slide</h3>
                            <div class="exercise-category">Unison</div>
                            <p>Use the slider to match the tone of the played note</p>
                        </button>

                        <button class="exercise-card" data-exercise="unisonDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Unison Darts</h3>
                            <p>Match the root note - hit the bullseye</p>
                        </button>
                    </div>
                </div>

                <!-- Octave Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéµ Octave Exercises</h3>
                        <button class="category-toggle" aria-label="Toggle Octave Exercises section">‚àí</button>
                    </div>
                    <p class="category-description">Master octave relationships and jumps</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="octaveOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Octave Overview</h3>
                            <p>Learn about the octave interval and its 2:1 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="octaveFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Octave Explore</h3>
                            <p>Toggle between root and octave to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="octaveSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Octave Slide</h3>
                            <p>Slide your voice to match an octave above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="octaveDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Octave Darts</h3>
                            <p>Sing an octave above - hit the bullseye</p>
                        </button>
                    </div>
                </div>

                <!-- Whole-Step Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéµ Major Second (Whole-Steps)</h3>
                        <button class="category-toggle" aria-label="Toggle Major Second section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand whole-step (2 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="majorSecondOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Major Second Overview</h3>
                            <p>Learn about the major second interval and its 9:8 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="wholeStepFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Whole-Step Explore</h3>
                            <p>Toggle between root and whole-step to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="wholeStepSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Whole-Step Slide</h3>
                            <p>Slide your voice to match a whole-step above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="wholeStepDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Whole-Step Darts</h3>
                            <p>Sing a whole-step above - hit the bullseye</p>
                        </button>
                    </div>
                </div>

                <!-- Half-Step Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéº Minor Second (Half-Steps)</h3>
                        <button class="category-toggle" aria-label="Toggle Minor Second section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand half-step (semi-tone) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="minorSecondOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Minor Second Overview</h3>
                            <p>Learn about the minor second interval and its 16:15 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="halfStepFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Half-Step Explore</h3>
                            <p>Toggle between root and half-step to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="halfStepSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Half-Step Slide</h3>
                            <p>Slide your voice to match a half-step above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="halfStepDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Half-Step Darts</h3>
                            <p>Sing a half-step above - hit the bullseye</p>
                        </button>
                    </div>
                </div>

                <!-- Major Third Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Major Third</h3>
                        <button class="category-toggle" aria-label="Toggle Major Third section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand major third (4 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="majorThirdOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Major Third Overview</h3>
                            <p>Learn about the major third interval and its 5:4 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorThirdFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Major Third Explore</h3>
                            <p>Toggle between root and major third to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorThirdSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Major Third Slide</h3>
                            <p>Slide your voice to match a major third above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorThirdDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Major Third Darts</h3>
                            <p>Sing a major third above - hit the bullseye</p>
                        </button>
                    </div>
                </div>

                <!-- Perfect Fourth Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Perfect Fourth</h3>
                        <button class="category-toggle" aria-label="Toggle Perfect Fourth section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand perfect fourth (5 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="fourthOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Perfect Fourth Overview</h3>
                            <p>Learn about the perfect fourth interval and its 4:3 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFourthFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Perfect Fourth Explore</h3>
                            <p>Toggle between root and perfect fourth to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFourthSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Perfect Fourth Slide</h3>
                            <p>Slide your voice to match a perfect fourth above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFourthDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Perfect Fourth Darts</h3>
                            <p>Sing a perfect fourth above - hit the bullseye</p>
                        </button>
                    </div>
                </div>

                <!-- Perfect Fifth Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Perfect Fifth</h3>
                        <button class="category-toggle" aria-label="Toggle Perfect Fifth section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand perfect fifth (7 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="fifthOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Perfect Fifth Overview</h3>
                            <p>Learn about the perfect fifth interval and its 3:2 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFifthFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Perfect Fifth Explore</h3>
                            <p>Toggle between root and perfect fifth to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFifthSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Perfect Fifth Slide</h3>
                            <p>Slide your voice to match a perfect fifth above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFifthDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Perfect Fifth Darts</h3>
                            <p>Sing a perfect fifth above - hit the bullseye</p>
                        </button>
                    </div>
                </div>

                <!-- Major Sixth Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Major Sixth</h3>
                        <button class="category-toggle" aria-label="Toggle Major Sixth section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand major sixth (9 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="majorSixthOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Major Sixth Overview</h3>
                            <p>Learn about the major sixth interval and its 5:3 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSixthFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Major Sixth Explore</h3>
                            <p>Toggle between root and major sixth to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSixthSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Major Sixth Slide</h3>
                            <p>Slide your voice to match a major sixth above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSixthDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Major Sixth Darts</h3>
                            <p>Sing a major sixth above - hit the bullseye</p>
                        </button>
                    </div>
                </div>

                <!-- Major Seventh Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Major Seventh</h3>
                        <button class="category-toggle" aria-label="Toggle Major Seventh section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand major seventh (11 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="majorSeventhOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Major Seventh Overview</h3>
                            <p>Learn about the major seventh interval and its 15:8 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSeventhFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Major Seventh Explore</h3>
                            <p>Toggle between root and major seventh to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSeventhSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Major Seventh Slide</h3>
                            <p>Slide your voice to match a major seventh above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSeventhDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Major Seventh Darts</h3>
                            <p>Sing a major seventh above - hit the bullseye</p>
                        </button>
                    </div>
                </div>

                <!-- Scale Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéπ Scale Exercises</h3>
                        <button class="category-toggle" aria-label="Toggle Scale Exercises section">‚àí</button>
                    </div>
                    <p class="category-description">Practice singing scales and melodic patterns</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="scale">
                            <div class="exercise-icon">üéπ</div>
                            <h3>Scale Match Up</h3>
                            <p>Sing a major scale ascending</p>
                        </button>

                        <button class="exercise-card" data-exercise="scaleHopping">
                            <div class="exercise-icon">ü¶ò</div>
                            <h3>Scale Hopping</h3>
                            <p>PLACEHOLDER: Do Re Do, Do Mi Do. UP and down the scale</p>
                        </button>

                        <button class="exercise-card" data-exercise="hopToOctave">
                            <div class="exercise-icon">üéµ</div>
                            <h3>Hop to the Octave</h3>
                            <p>PLACEHOLDER: Starting with the root, go through the Do, Re, Mi scale and end on Do. See how close you were.</p>
                        </button>
                        <button class="exercise-card" data-exercise="scaleDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Scale Darts</h3>
                            <p>Hit the target scale degree - only the root is played</p>
                        </button>
                    </div>
                </div>

                <!-- Other Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéµ Other Exercises</h3>
                        <button class="category-toggle" aria-label="Toggle Other Exercises section">‚àí</button>
                    </div>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="glissando">
                            <div class="exercise-icon">üåä</div>
                            <h3>Glissando</h3>
                            <p>Slide your voice smoothly through it's range</p>
                        </button>

                        <button class="exercise-card" data-exercise="diagnostics">
                            <div class="exercise-icon">üî¨</div>
                            <h3>Mic Diagnostics</h3>
                            <p>Test and debug pitch detection</p>
                        </button>
                        <button class="exercise-card" data-exercise="interferenceVisualization">
                            <div class="exercise-icon">‚óà</div>
                            <h3>Interference Visualization</h3>
                            <p>Visualize harmonic interference patterns and intervals</p>
                        </button>
                        <button class="exercise-card" data-exercise="waveVisualization">
                            <div class="exercise-icon">ü™ó</div>
                            <h3>Wave Visualization</h3>
                            <p>Retro waveform blend with interval color spectrum</p>
                        </button>
                    </div>
                </div>
            </section>

            <section class="card">
                <h2>Your Vocal Range</h2>
                <div class="range-summary">
                    <div class="range-item">
                        <span class="range-label">Low Note:</span>
                        <span id="appLowNote" class="range-value">--</span>
                    </div>
                    <div class="range-item">
                        <span class="range-label">High Note:</span>
                        <span id="appHighNote" class="range-value">--</span>
                    </div>
                    <div class="range-item" id="voiceTypeContainer" style="display: none;">
                        <span class="range-label">Voice Type:</span>
                        <span id="appVoiceType" class="range-value">--</span>
                    </div>
                </div>
                <button id="resetSetupBtn" class="btn-secondary">Reset Vocal Range</button>
            </section>

            <button id="installBtn" class="btn-primary" style="display: none; margin-top: 20px;">Install App</button>

            <!-- Tips and Tricks Browse Button -->
            <button id="tipsBrowseBtn" class="btn-secondary" style="margin-top: 20px;">
                üí° Tips & Tricks
            </button>
        </main>

        <footer>
            <p>&copy; 2025 ToneDeath.app</p>
        </footer>
    </div>

    <!-- Tips and Tricks Modal -->
    <div id="tipsModal" class="tips-modal" style="display: none;">
        <div class="tips-modal-content">
            <button id="closeTipBtn" class="tips-close-btn">‚úï</button>

            <div class="tip-card">
                <div class="tip-image" id="tipImage">üí°</div>
                <h2 class="tip-title" id="tipTitle">Tip Title</h2>
                <p class="tip-text" id="tipText">Tip content goes here.</p>
            </div>

            <div class="tips-navigation">
                <button id="prevTipBtn" class="btn-tip-nav">‚Üê</button>
                <button id="nextTipBtn" class="btn-tip-nav">‚Üí</button>
            </div>
        </div>
    </div>

    <!-- iOS Install Instructions Modal -->
    <div id="iosInstallModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Install ToneDeath</h2>
            <button id="closeInstallModal" class="exit-btn" aria-label="Close">‚úï</button>

            <div style="padding: 20px; text-align: left;">
                <p style="margin-bottom: 20px; color: var(--neon-cyan);">For the best experience and proper Bluetooth audio support, install ToneDeath to your home screen:</p>

                <ol style="line-height: 2; color: var(--text-primary); margin-left: 20px;">
                    <li>Tap the <strong style="color: var(--neon-pink);">Share button</strong> <span style="font-size: 1.2em;">‚éã</span> in Safari</li>
                    <li>Scroll down and tap <strong style="color: var(--neon-pink);">"Add to Home Screen"</strong></li>
                    <li>Tap <strong style="color: var(--neon-pink);">"Add"</strong> in the top right</li>
                    <li>Open ToneDeath from your home screen</li>
                </ol>

                <p style="margin-top: 20px; font-size: 0.875rem; color: var(--text-secondary);">Note: iOS requires PWAs to be installed for full Bluetooth speaker support.</p>

                <button id="dontShowAgain" class="btn-secondary" style="margin-top: 20px;">Close</button>
            </div>
        </div>
    </div>

    <!-- Audio Settings Modal -->
    <div id="audioSettings" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Audio Settings</h2>
            <button id="closeAudioSettings" class="exit-btn" aria-label="Close">‚úï</button>

            <div class="settings-section">
                <label for="usageModeSelect">Usage Mode:</label>
                <select id="usageModeSelect" class="settings-select">
                    <option value="headphone-mic">üéß Headphone + Mic</option>
                    <option value="speaker-mic">üîä Speaker + Mic</option>
                    <option value="car-mode">üöó Car Mode</option>
                </select>
                <p class="settings-description" id="usageModeDescription">Single headphone with microphone (default)</p>
            </div>

            <div class="settings-divider"></div>

            <div class="settings-section">
                <label for="micSelect">Microphone:</label>
                <select id="micSelect" class="settings-select">
                    <option>Loading...</option>
                </select>
                <p class="settings-description" style="color: var(--neon-yellow); font-size: 0.75rem;">‚ö†Ô∏è iOS Note: Select your AirPods BEFORE starting exercise. Check Debug panel "Device" to verify.</p>
            </div>

            <div class="settings-section">
                <label for="speakerSelect">Speaker:</label>
                <select id="speakerSelect" class="settings-select">
                    <option>Loading...</option>
                </select>
            </div>

            <div class="settings-divider"></div>

            <div class="settings-section">
                <label for="sensitivityPreset">Pitch Sensitivity:</label>
                <select id="sensitivityPreset" class="settings-select">
                    <option value="very-strict">Very Strict</option>
                    <option value="strict">Strict</option>
                    <option value="normal" selected>Normal</option>
                    <option value="forgiving">Forgiving</option>
                    <option value="very-forgiving">Very Forgiving</option>
                </select>
                <p class="settings-description" id="sensitivityDescription">Balanced - good for most users</p>
            </div>

            <div class="settings-section">
                <label for="toleranceSelect">Match Tolerance:</label>
                <select id="toleranceSelect" class="settings-select">
                    <option value="0.0005">0.05% (~8 cents) - Very Strict</option>
                    <option value="0.001" selected>0.1% (~17 cents) - Strict</option>
                    <option value="0.01">1% (~85 cents) - Normal</option>
                    <option value="0.02">2% (~170 cents) - Forgiving</option>
                </select>
                <p class="settings-description">How close your pitch must match the target</p>
            </div>

            <div class="settings-divider"></div>

            <div class="settings-section">
                <label for="micGainSlider">Microphone Gain:</label>
                <div class="gain-control-container">
                    <input type="range" id="micGainSlider" class="gain-slider" min="0.1" max="5.0" step="0.1" value="1.0">
                    <span id="micGainValue" class="gain-value">1.0x</span>
                </div>
                <p class="settings-description">Increase if microphone is too quiet (1.0x = normal)</p>
            </div>

            <div class="settings-divider"></div>

            <div class="settings-section">
                <label for="debugControlsToggle">Debug Controls:</label>
                <div class="toggle-container">
                    <input type="checkbox" id="debugControlsToggle" class="toggle-checkbox" checked>
                    <label for="debugControlsToggle" class="toggle-label">
                        <span class="toggle-slider"></span>
                    </label>
                    <span id="debugControlsStatus" class="toggle-status">On</span>
                </div>
                <p class="settings-description">Show debug button and diagnostics exercise</p>
            </div>

            <div class="settings-divider"></div>

            <button id="requestPermissions" class="btn-primary">Request Microphone Access</button>
            <button id="testAudio" class="btn-secondary">Test Audio</button>
            <button id="showInstallBtn" class="btn-secondary" style="margin-top: 10px;">Installation Instructions</button>
        </div>
    </div>

    <!-- Glissando Exercise -->
    <div id="glissandoExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitGlissandoExercise" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Glissando</p>
            </div>
            <button id="audioSettingsBtnGlissando" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>

            <section class="card exercise-main">
                <div class="glissando-container">
                    <!-- Progress Display -->
                    <div class="glissando-progress">
                        <div class="progress-text">
                            <span id="glissandoCount">0</span> / 5 Complete
                        </div>
                        <div class="progress-direction" id="glissandoDirection">Slide Up! üîº</div>
                    </div>

                    <!-- Pitch Display with Range Visualization -->
                    <div class="pitch-display-with-range">
                        <div class="pitch-display" id="glissandoPitchDisplay">
                            <div class="note-name" id="glissandoNoteName">‚ô™</div>
                            <div class="note-freq" id="glissandoNoteFreq">Sing to begin</div>
                        </div>

                        <div class="range-bar-container">
                            <div class="range-bar">
                                <div class="range-labels">
                                    <div class="range-label-top" id="glissandoHighLabel">--</div>
                                    <div class="range-label-bottom" id="glissandoLowLabel">--</div>
                                </div>
                                <div class="range-bar-background">
                                    <div class="range-fill" id="glissandoRangeFill"></div>
                                    <div class="range-marker" id="glissandoMarker"></div>
                                    <div class="range-low-marker" id="glissandoLowMarker"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Instruction -->
                    <div class="glissando-instruction">
                        Start at your lowest note and smoothly slide your voice to your highest note
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Pitch Match Exercise -->
    <div id="intonationExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitExercise" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Unison Explore</p>
            </div>
            <button id="audioSettingsBtnExercise" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>

            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="currentNote" style="display: none;">--</div>
                <div id="currentFreq" style="display: none;">-- Hz</div>

                <!-- Instructions Container -->
                <div id="pitchMatchInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Play/Pause Button -->
                    <button id="pitchMatchPlayBtn" class="btn-exercise-big btn-stop">
                        <div class="btn-content-vertical">
                            <div id="toneAnimation" class="tone-animation-btn">
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                            </div>
                            <div class="btn-text">Play Tone</div>
                            <div id="pitchMatchPlayIcon" class="play-pause-icon">‚è∏</div>
                        </div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="nextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="toneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Pitch Hold Exercise -->
    <div id="pitchHoldExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitPitchHold" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Car Pitch Hold</p>
            </div>
            <button id="audioSettingsBtnPitchHold" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="pitchHoldNote" style="display: none;">--</div>
                <div id="pitchHoldFreq" style="display: none;">-- Hz</div>

                <!-- Instruction -->
                <div class="pitch-match-instruction">
                    Headphones with a microphone is ideal
                </div>

                <!-- Tone Counter -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="pitchHoldCounter">0</span>
                </div>

                <!-- Success Animation -->
                <div id="pitchHoldSuccess" class="pitch-hold-success" style="display: none;">
                    <div class="success-thumbs">üëç</div>
                </div>

                <div class="exercise-controls-big">
                    <div class="pitch-hold-controls-row">
                        <!-- Progress Bucket (left side) -->
                        <div id="pitchHoldProgress" class="pitch-hold-bucket" style="display: none;">
                            <div class="bucket-container">
                                <div id="pitchHoldProgressFill" class="bucket-fill"></div>
                                <svg class="bucket-outline" viewBox="0 0 100 120" xmlns="http://www.w3.org/2000/svg">
                                    <!-- Bucket shape: wider at top, narrower at bottom -->
                                    <path d="M 15 10 L 25 110 L 75 110 L 85 10 Z"
                                          fill="none"
                                          stroke="var(--neon-cyan)"
                                          stroke-width="3"
                                          stroke-linejoin="round"/>
                                    <!-- Handle -->
                                    <path d="M 20 10 Q 50 0 80 10"
                                          fill="none"
                                          stroke="var(--neon-cyan)"
                                          stroke-width="2.5"/>
                                </svg>
                            </div>
                        </div>

                        <div class="pitch-hold-buttons">
                            <!-- Match This Button -->
                            <button id="pitchHoldMatchBtn" class="btn-exercise-big btn-stop">
                        <div class="btn-content">
                            <div id="pitchHoldAnimation" class="tone-animation-btn">
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                            </div>
                            <div class="btn-text">Match This</div>
                        </div>
                    </button>

                            <!-- Next Tone Button -->
                            <button id="pitchHoldNextBtn" class="btn-exercise-big btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-icon">‚Üí</div>
                                    <div class="btn-text">Next Tone</div>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Octave Match Exercise -->
    <div id="octaveExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitOctaveExercise" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Octave Match</p>
            </div>
            <button id="audioSettingsBtnOctave" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>

            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="octaveNote" style="display: none;">--</div>
                <div id="octaveFreq" style="display: none;">-- Hz</div>

                <div class="exercise-controls-big">
                    <!-- High Note Button (Top) -->
                    <button id="playHighOctaveBtn" class="btn-exercise-big btn-next">
                        <div class="btn-content-vertical">
                            <div id="octaveHighAnimation" class="tone-animation-btn">
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                            </div>
                            <div class="btn-icon">‚¨ÜÔ∏è</div>
                            <div class="btn-text">High Note</div>
                            <div id="octaveHighPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>

                    <!-- Both Button -->
                    <button id="playBothOctaveBtn" class="btn-exercise-small btn-secondary">
                        <div class="btn-content">
                            <div class="btn-text">Both</div>
                        </div>
                    </button>

                    <!-- Next Octave Button -->
                    <button id="nextOctavePairBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Octave</div>
                        </div>
                    </button>

                    <!-- Low Note Button (Bottom) -->
                    <button id="playLowOctaveBtn" class="btn-exercise-big btn-next">
                        <div class="btn-content-vertical">
                            <div id="octaveLowAnimation" class="tone-animation-btn">
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                            </div>
                            <div class="btn-icon">‚¨áÔ∏è</div>
                            <div class="btn-text">Low Note</div>
                            <div id="octaveLowPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Scale Match Up Exercise -->
    <div id="scaleExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitScaleExercise" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Scale Match</p>
            </div>
            <button id="audioSettingsBtnScale" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>

            <section class="card exercise-main">
                <!-- Scale Horizontal Layout -->
                <div class="scale-horizontal-layout">
                    <!-- High Do (note 7) - Top, Right Aligned -->
                    <div class="scale-row scale-row-do-high">
                        <button id="scaleNote7Btn" class="btn-scale-horizontal btn-do-half">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote7Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Do</div>
                                <div id="scaleNote7PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Ti (note 6) -->
                    <div class="scale-row scale-row-6">
                        <button id="scaleNote6Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote6Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Ti</div>
                                <div id="scaleNote6PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- La (note 5) -->
                    <div class="scale-row scale-row-5">
                        <button id="scaleNote5Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote5Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">La</div>
                                <div id="scaleNote5PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Sol (note 4) -->
                    <div class="scale-row scale-row-4">
                        <button id="scaleNote4Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote4Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Sol</div>
                                <div id="scaleNote4PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Fa (note 3) -->
                    <div class="scale-row scale-row-3">
                        <button id="scaleNote3Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote3Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Fa</div>
                                <div id="scaleNote3PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Mi (note 2) -->
                    <div class="scale-row scale-row-2">
                        <button id="scaleNote2Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote2Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Mi</div>
                                <div id="scaleNote2PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Re (note 1) -->
                    <div class="scale-row scale-row-1">
                        <button id="scaleNote1Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote1Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Re</div>
                                <div id="scaleNote1PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Low Do (note 0) - Bottom, Left Aligned -->
                    <div class="scale-row scale-row-do-low">
                        <button id="scaleNote0Btn" class="btn-scale-horizontal btn-do-half">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote0Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Do</div>
                                <div id="scaleNote0PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- New Scale Button -->
                    <button id="newScaleBtn" class="btn-scale-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">üîÑ</div>
                            <div class="btn-text">New Scale</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Tone Slide Exercise -->
    <div id="toneSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="toneSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Tone Slide</p>
            </div>
            <button id="audioSettingsBtnToneSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="toneSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="toneSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="toneSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="toneSlideSlider" class="tone-slide-slider">
                        <div id="toneSlideKnob" class="tone-slide-knob"></div>
                        <div id="toneSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="toneSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="toneSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="toneSlidePlayBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Play Tone</div>
                                    <div id="toneSlidePlayIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="toneSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Tone Darts Exercise -->
    <div id="toneDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitToneDarts" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Tone Darts</p>
            </div>
            <button id="audioSettingsBtnDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="dartRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="dartScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="dartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="dartPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Tone</div>
                            <div id="dartPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Unison Darts Exercise -->
    <div id="unisonDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="unisonDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Unison Darts</p>
            </div>
            <button id="audioSettingsBtnUnisonDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="unisonDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="unisonDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="unisonDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="unisonDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="unisonDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Half-Step Darts Exercise -->
    <div id="halfStepDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="halfStepDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Half-Step Darts</p>
            </div>
            <button id="audioSettingsBtnHalfStepDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="halfStepDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="halfStepDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="halfStepDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="halfStepDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="halfStepDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Whole-Step Darts Exercise -->
    <div id="wholeStepDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="wholeStepDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Whole-Step Darts</p>
            </div>
            <button id="audioSettingsBtnWholeStepDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="wholeStepDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="wholeStepDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="wholeStepDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="wholeStepDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="wholeStepDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Octave Darts Exercise -->
    <div id="octaveDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="octaveDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Octave Darts</p>
            </div>
            <button id="audioSettingsBtnOctaveDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="octaveDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="octaveDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="octaveDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="octaveDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="octaveDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Mic Diagnostics Exercise -->
    <div id="audioDiagnostics" class="container exercise-container" style="display: none;">
        <header>
            <h1>üî¨ Mic Diagnostics</h1>
            <button id="exitDiagnostics" class="exit-btn">‚úï</button>
        </header>

        <main class="diag-main">
            <section class="card diag-controls">
                <h2>Run Tests</h2>
                <p class="diag-instructions">
                    These tests help diagnose why pitch detection might drop off during singing.
                    Run each test and report the results back.
                </p>

                <div class="diag-test-buttons">
                    <button id="diagTestSpeech" class="btn-diag">Test: Speech</button>
                    <button id="diagTestSinging" class="btn-diag">Test: Singing</button>
                    <button id="diagTestTone" class="btn-diag">Test: Match Tone</button>
                    <button id="diagStopTest" class="btn-diag btn-stop" disabled>Stop Test</button>
                </div>

                <div class="diag-current-test">
                    <span class="diag-label">Current Test:</span>
                    <span id="diagCurrentTest" class="diag-value">None</span>
                </div>
            </section>

            <section class="card diag-waveform-section">
                <h2>Live Waveform (Time Domain)</h2>
                <canvas id="diagWaveform" width="800" height="200"></canvas>
            </section>

            <section class="card diag-waveform-section">
                <h2>FFT Spectrum (Frequency Domain)</h2>
                <canvas id="diagSpectrum" width="800" height="200"></canvas>
            </section>

            <section class="card diag-metrics">
                <h2>Real-Time Metrics</h2>
                <div class="diag-metrics-grid">
                    <div class="diag-metric">
                        <span class="diag-label">RMS (Raw):</span>
                        <span id="diagRMS" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">RMS Threshold:</span>
                        <span id="diagRMSThreshold" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Detected Pitch:</span>
                        <span id="diagPitch" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Clipping:</span>
                        <span id="diagClipping" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Buffer Size:</span>
                        <span id="diagBufferSize" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">FFT Size:</span>
                        <span id="diagFFTSize" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Audio Processing:</span>
                        <span id="diagProcessing" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Detection Method:</span>
                        <span id="diagMethod" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">FFT Freq:</span>
                        <span id="diagFFTFreq" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Autocorr Freq:</span>
                        <span id="diagAutocorrFreq" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">FFT Confidence:</span>
                        <span id="diagFFTConfidence" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">FFT Threshold:</span>
                        <span id="diagFFTThreshold" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Smoothing:</span>
                        <span id="diagSmoothing" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Mic Gain:</span>
                        <span id="diagMicGain" class="diag-value">--</span>
                    </div>
                </div>
            </section>

            <section class="card diag-results-section">
                <h2>Test Results & Recommendations</h2>
                <button id="diagCopyLog" class="btn-diag" style="width: 100%; margin-bottom: 15px;">
                    üìã Copy Diagnostic Log to Clipboard
                </button>
                <div id="diagResults" class="diag-results"></div>
            </section>
        </main>
    </div>

    <!-- Half-Step Feel the Root Exercise -->
    <div id="halfStepFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="halfStepFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Half-Step Explore</p>
            </div>
            <button id="audioSettingsBtnHalfStepFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="halfStepFeelRootCurrentNote" style="display: none;">--</div>
                <div id="halfStepFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="halfStepFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="halfStepFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="halfStepFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="halfStepFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="halfStepFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="halfStepFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="halfStepFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Half-Step</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="halfStepFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="halfStepFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Octave Feel the Root Exercise -->
    <div id="octaveFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="octaveFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Octave Explore</p>
            </div>
            <button id="audioSettingsBtnOctaveFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="octaveFeelRootCurrentNote" style="display: none;">--</div>
                <div id="octaveFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="octaveFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="octaveFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="octaveFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="octaveFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="octaveFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="octaveFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="octaveFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Octave</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="octaveFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="octaveFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Whole-Step Feel the Root Exercise -->
    <div id="wholeStepFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="wholeStepFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Whole-Step Explore</p>
            </div>
            <button id="audioSettingsBtnWholeStepFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="wholeStepFeelRootCurrentNote" style="display: none;">--</div>
                <div id="wholeStepFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="wholeStepFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="wholeStepFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="wholeStepFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="wholeStepFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="wholeStepFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="wholeStepFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="wholeStepFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Whole-Step</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="wholeStepFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="wholeStepFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Half-Step Slide Exercise -->
    <div id="halfStepSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="halfStepSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Half-Step Slide</p>
            </div>
            <button id="audioSettingsBtnHalfStepSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="halfStepSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="halfStepSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="halfStepSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="halfStepSlideSlider" class="tone-slide-slider">
                        <div id="halfStepSlideKnob" class="tone-slide-knob"></div>
                        <div id="halfStepSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="halfStepSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="halfStepSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="halfStepSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="halfStepSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="halfStepSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="halfStepSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="halfStepSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Whole-Step Slide Exercise -->
    <div id="wholeStepSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="wholeStepSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Whole-Step Slide</p>
            </div>
            <button id="audioSettingsBtnWholeStepSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="wholeStepSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="wholeStepSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="wholeStepSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="wholeStepSlideSlider" class="tone-slide-slider">
                        <div id="wholeStepSlideKnob" class="tone-slide-knob"></div>
                        <div id="wholeStepSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="wholeStepSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="wholeStepSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="wholeStepSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="wholeStepSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="wholeStepSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="wholeStepSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="wholeStepSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Octave Slide Exercise -->
    <div id="octaveSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="octaveSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Octave Slide</p>
            </div>
            <button id="audioSettingsBtnOctaveSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="octaveSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="octaveSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="octaveSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="octaveSlideSlider" class="tone-slide-slider">
                        <div id="octaveSlideKnob" class="tone-slide-knob"></div>
                        <div id="octaveSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="octaveSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="octaveSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="octaveSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="octaveSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="octaveSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="octaveSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="octaveSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Third Feel the Root Exercise -->
    <div id="majorThirdFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorThirdFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Third Explore</p>
            </div>
            <button id="audioSettingsBtnMajorThirdFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="majorThirdFeelRootCurrentNote" style="display: none;">--</div>
                <div id="majorThirdFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="majorThirdFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="majorThirdFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorThirdFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="majorThirdFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="majorThirdFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="majorThirdFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorThirdFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Major Third</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="majorThirdFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="majorThirdFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Third Slide Exercise -->
    <div id="majorThirdSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorThirdSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Third Slide</p>
            </div>
            <button id="audioSettingsBtnMajorThirdSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="majorThirdSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="majorThirdSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="majorThirdSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="majorThirdSlideSlider" class="tone-slide-slider">
                        <div id="majorThirdSlideKnob" class="tone-slide-knob"></div>
                        <div id="majorThirdSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="majorThirdSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="majorThirdSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="majorThirdSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="majorThirdSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="majorThirdSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="majorThirdSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="majorThirdSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Third Darts Exercise -->
    <div id="majorThirdDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorThirdDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Third Darts</p>
            </div>
            <button id="audioSettingsBtnMajorThirdDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="majorThirdDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="majorThirdDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="majorThirdDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="majorThirdDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="majorThirdDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fourth Feel the Root Exercise -->
    <div id="perfectFourthFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFourthFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fourth Explore</p>
            </div>
            <button id="audioSettingsBtnPerfectFourthFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="perfectFourthFeelRootCurrentNote" style="display: none;">--</div>
                <div id="perfectFourthFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="perfectFourthFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="perfectFourthFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="perfectFourthFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="perfectFourthFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="perfectFourthFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="perfectFourthFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="perfectFourthFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Perfect Fourth</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="perfectFourthFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="perfectFourthFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fourth Slide Exercise -->
    <div id="perfectFourthSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFourthSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fourth Slide</p>
            </div>
            <button id="audioSettingsBtnPerfectFourthSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="perfectFourthSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="perfectFourthSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="perfectFourthSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="perfectFourthSlideSlider" class="tone-slide-slider">
                        <div id="perfectFourthSlideKnob" class="tone-slide-knob"></div>
                        <div id="perfectFourthSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="perfectFourthSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="perfectFourthSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="perfectFourthSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="perfectFourthSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="perfectFourthSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="perfectFourthSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="perfectFourthSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fourth Darts Exercise -->
    <div id="perfectFourthDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFourthDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fourth Darts</p>
            </div>
            <button id="audioSettingsBtnPerfectFourthDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="perfectFourthDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="perfectFourthDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="perfectFourthDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="perfectFourthDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="perfectFourthDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fifth Feel the Root Exercise -->
    <div id="perfectFifthFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFifthFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fifth Explore</p>
            </div>
            <button id="audioSettingsBtnPerfectFifthFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="perfectFifthFeelRootCurrentNote" style="display: none;">--</div>
                <div id="perfectFifthFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="perfectFifthFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="perfectFifthFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="perfectFifthFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="perfectFifthFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="perfectFifthFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="perfectFifthFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="perfectFifthFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Perfect Fifth</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="perfectFifthFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="perfectFifthFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fifth Slide Exercise -->
    <div id="perfectFifthSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFifthSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fifth Slide</p>
            </div>
            <button id="audioSettingsBtnPerfectFifthSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="perfectFifthSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="perfectFifthSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="perfectFifthSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="perfectFifthSlideSlider" class="tone-slide-slider">
                        <div id="perfectFifthSlideKnob" class="tone-slide-knob"></div>
                        <div id="perfectFifthSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="perfectFifthSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="perfectFifthSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="perfectFifthSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="perfectFifthSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="perfectFifthSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="perfectFifthSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="perfectFifthSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fifth Darts Exercise -->
    <div id="perfectFifthDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFifthDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fifth Darts</p>
            </div>
            <button id="audioSettingsBtnPerfectFifthDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="perfectFifthDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="perfectFifthDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="perfectFifthDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="perfectFifthDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="perfectFifthDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Sixth Feel the Root Exercise -->
    <div id="majorSixthFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSixthFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Sixth Explore</p>
            </div>
            <button id="audioSettingsBtnMajorSixthFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="majorSixthFeelRootCurrentNote" style="display: none;">--</div>
                <div id="majorSixthFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="majorSixthFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="majorSixthFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorSixthFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="majorSixthFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="majorSixthFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="majorSixthFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorSixthFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Major Sixth</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="majorSixthFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="majorSixthFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Sixth Slide Exercise -->
    <div id="majorSixthSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSixthSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Sixth Slide</p>
            </div>
            <button id="audioSettingsBtnMajorSixthSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="majorSixthSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="majorSixthSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="majorSixthSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="majorSixthSlideSlider" class="tone-slide-slider">
                        <div id="majorSixthSlideKnob" class="tone-slide-knob"></div>
                        <div id="majorSixthSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="majorSixthSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="majorSixthSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="majorSixthSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="majorSixthSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="majorSixthSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="majorSixthSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="majorSixthSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Sixth Darts Exercise -->
    <div id="majorSixthDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSixthDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Sixth Darts</p>
            </div>
            <button id="audioSettingsBtnMajorSixthDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="majorSixthDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="majorSixthDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="majorSixthDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="majorSixthDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="majorSixthDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Seventh Feel the Root Exercise -->
    <div id="majorSeventhFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSeventhFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Seventh Explore</p>
            </div>
            <button id="audioSettingsBtnMajorSeventhFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="majorSeventhFeelRootCurrentNote" style="display: none;">--</div>
                <div id="majorSeventhFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="majorSeventhFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="majorSeventhFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorSeventhFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="majorSeventhFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="majorSeventhFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="majorSeventhFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorSeventhFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Major Seventh</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="majorSeventhFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="majorSeventhFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Seventh Slide Exercise -->
    <div id="majorSeventhSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSeventhSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Seventh Slide</p>
            </div>
            <button id="audioSettingsBtnMajorSeventhSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="majorSeventhSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="majorSeventhSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="majorSeventhSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="majorSeventhSlideSlider" class="tone-slide-slider">
                        <div id="majorSeventhSlideKnob" class="tone-slide-knob"></div>
                        <div id="majorSeventhSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="majorSeventhSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="majorSeventhSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="majorSeventhSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="majorSeventhSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="majorSeventhSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="majorSeventhSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="majorSeventhSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Seventh Darts Exercise -->
    <div id="majorSeventhDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSeventhDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Seventh Darts</p>
            </div>
            <button id="audioSettingsBtnMajorSeventhDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="majorSeventhDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="majorSeventhDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="majorSeventhDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="majorSeventhDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="majorSeventhDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Tuning Fork Visualization Exercise -->
    <div id="tuningForkVizExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="tuningForkVizExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Tuning Fork Visualization</p>
            </div>
            <button id="audioSettingsBtnTuningFork" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>
        <main>
            <section class="card tuning-fork-viz-main">
                <!-- Control Panel and Strobe Visualizer -->
                <div class="tuning-fork-top-section">
                    <div class="tuning-fork-controls">
                        <div class="tuning-fork-frequency-display">
                            <div class="tuning-fork-freq-control">
                                <label>Root Tone:</label>
                                <div class="tuning-fork-freq-sliders">
                                    <input type="range" id="tuningForkRootSlider1" class="tuning-fork-slider" min="200" max="800" step="1" value="440">
                                    <input type="range" id="tuningForkRootSlider2" class="tuning-fork-slider" min="200" max="800" step="1" value="440">
                                </div>
                                <input type="number" id="tuningForkRootFreq" value="440" min="200" max="800" step="1">
                                <span>Hz</span>
                            </div>
                            <div class="tuning-fork-freq-control">
                                <label>Target Tone:</label>
                                <div class="tuning-fork-freq-sliders">
                                    <input type="range" id="tuningForkTargetSlider1" class="tuning-fork-slider" min="200" max="800" step="1" value="659">
                                    <input type="range" id="tuningForkTargetSlider2" class="tuning-fork-slider" min="200" max="800" step="1" value="659">
                                </div>
                                <input type="number" id="tuningForkTargetFreq" value="659" min="200" max="800" step="1">
                                <span>Hz</span>
                            </div>
                            <div class="tuning-fork-interval-name">
                                <span id="tuningForkIntervalName">Perfect Fifth (700 cents)</span>
                            </div>
                        </div>

                        <div class="tuning-fork-button-group">
                            <button id="tuningForkPlayRootBtn" class="btn-exercise btn-secondary">Play Root</button>
                            <button id="tuningForkPlayTargetBtn" class="btn-exercise btn-secondary">Play Target</button>
                            <button id="tuningForkPlayBothBtn" class="btn-exercise-large btn-next">Play Both</button>
                            <button id="tuningForkRandomizeBtn" class="btn-exercise btn-secondary">üé≤ Randomize</button>
                        </div>
                    </div>

                    <!-- Combined Visualizations Canvas -->
                    <div class="tuning-fork-viz-container">
                        <canvas id="tuningForkStrobeCanvas" class="tuning-fork-combined-canvas"></canvas>
                    </div>
                </div>

                <!-- Settings Panel -->
                <details class="tuning-fork-settings-panel">
                    <summary class="tuning-fork-settings-header">‚öôÔ∏è Visualization Settings</summary>
                    <div class="tuning-fork-settings-grid">
                        <!-- Visibility Settings -->
                        <div class="tuning-fork-setting-group">
                            <h4>Show/Hide Elements</h4>
                            <label>
                                <input type="checkbox" id="settingShowTuningForks">
                                <span>Show Tuning Forks</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingShowWaves">
                                <span>Show Waves</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingShowInterference">
                                <span>Show Interference</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingShowGrid" checked>
                                <span>Show Background Grid</span>
                            </label>
                        </div>

                        <!-- Fork Settings -->
                        <div class="tuning-fork-setting-group">
                            <h4>Tuning Fork</h4>
                            <label>
                                <span>Fork Size:</span>
                                <input type="range" id="settingForkSize" min="0.5" max="2" step="0.1" value="1">
                                <span id="valueForkSize">1.0x</span>
                            </label>
                            <label>
                                <span>Vibration Speed:</span>
                                <input type="range" id="settingVibrationSpeed" min="0.05" max="0.5" step="0.05" value="0.125">
                                <span id="valueVibrationSpeed">0.125</span>
                            </label>
                            <label>
                                <span>Vibration Amount:</span>
                                <input type="range" id="settingVibrationAmount" min="5" max="30" step="1" value="15">
                                <span id="valueVibrationAmount">15px</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingShowForkLabels" checked>
                                <span>Show Fork Labels</span>
                            </label>
                        </div>

                        <!-- Wave Settings -->
                        <div class="tuning-fork-setting-group">
                            <h4>Sound Waves</h4>
                            <label>
                                <span>Wave Speed:</span>
                                <input type="range" id="settingWaveSpeed" min="0.1" max="1" step="0.1" value="0.5">
                                <span id="valueWaveSpeed">0.5x</span>
                            </label>
                            <label>
                                <span>Number of Waves:</span>
                                <input type="range" id="settingNumWaves" min="3" max="12" step="1" value="8">
                                <span id="valueNumWaves">8</span>
                            </label>
                            <label>
                                <span>Wave Opacity:</span>
                                <input type="range" id="settingWaveOpacity" min="0.3" max="1" step="0.1" value="0.8">
                                <span id="valueWaveOpacity">0.8</span>
                            </label>
                            <label>
                                <span>Max Wave Radius:</span>
                                <input type="range" id="settingMaxRadius" min="100" max="250" step="10" value="150">
                                <span id="valueMaxRadius">150px</span>
                            </label>
                            <label>
                                <span>Wave Style:</span>
                                <select id="settingWaveStyle">
                                    <option value="circle">Circle</option>
                                    <option value="oscilloscope">Oscilloscope</option>
                                    <option value="square">Square</option>
                                    <option value="hexagon">Hexagon</option>
                                    <option value="spiral">Spiral</option>
                                </select>
                            </label>
                            <label>
                                <span>Wave Modulation:</span>
                                <input type="range" id="settingWaveModulation" min="0" max="10" step="0.5" value="0">
                                <span id="valueWaveModulation">0px</span>
                            </label>
                            <label>
                                <span>Modulation Frequency:</span>
                                <input type="range" id="settingModulationFreq" min="1" max="12" step="1" value="4">
                                <span id="valueModulationFreq">4</span>
                            </label>
                            <label>
                                <span>Line Thickness:</span>
                                <input type="range" id="settingLineThickness" min="1" max="8" step="0.5" value="2">
                                <span id="valueLineThickness">2px</span>
                            </label>
                            <label>
                                <span>Wave Spacing Variation:</span>
                                <input type="range" id="settingSpacingVariation" min="0" max="50" step="5" value="0">
                                <span id="valueSpacingVariation">0%</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingFrequencyScaling" checked>
                                <span>Frequency-Based Speed</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingFrequencyColor" checked>
                                <span>Frequency-Based Hue Shift</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingPitchSize">
                                <span>Frequency-Based Thickness</span>
                            </label>
                        </div>

                        <!-- Interference Settings -->
                        <div class="tuning-fork-setting-group">
                            <h4>Interference Pulse</h4>
                            <label>
                                <span>Beat Speed:</span>
                                <input type="range" id="settingBeatSpeed" min="0.1" max="1" step="0.1" value="0.5">
                                <span id="valueBeatSpeed">0.5x</span>
                            </label>
                            <label>
                                <span>Pulse Size:</span>
                                <input type="range" id="settingPulseSize" min="5" max="30" step="1" value="15">
                                <span id="valuePulseSize">15px</span>
                            </label>
                            <label>
                                <span>Interference Rings:</span>
                                <input type="range" id="settingInterferenceRings" min="0" max="8" step="1" value="3">
                                <span id="valueInterferenceRings">3</span>
                            </label>
                            <label>
                                <span>Ring Spacing:</span>
                                <input type="range" id="settingRingSpacing" min="10" max="40" step="5" value="20">
                                <span id="valueRingSpacing">20px</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingShowBeatLabel" checked>
                                <span>Show Beat Frequency</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingShowInterferenceState" checked>
                                <span>Show Interference State</span>
                            </label>
                        </div>

                        <!-- Color Settings -->
                        <div class="tuning-fork-setting-group">
                            <h4>Colors</h4>
                            <label>
                                <span>Root Color:</span>
                                <input type="color" id="settingRootColor" value="#00ffff">
                            </label>
                            <label>
                                <span>Target Color:</span>
                                <input type="color" id="settingTargetColor" value="#ff00ff">
                            </label>
                            <label>
                                <span>Interference Color:</span>
                                <input type="color" id="settingInterferenceColor" value="#ffff00">
                            </label>
                            <label>
                                <input type="checkbox" id="settingWaveGlow" checked>
                                <span>Wave Glow Effect</span>
                            </label>
                        </div>

                        <!-- Strobe Settings -->
                        <div class="tuning-fork-setting-group">
                            <h4>Strobe Tuner</h4>
                            <label>
                                <input type="checkbox" id="settingShowStrobe" checked>
                                <span>Show Strobe</span>
                            </label>
                            <label>
                                <span>Pattern:</span>
                                <select id="settingStrobePattern">
                                    <option value="radial">Radial Spokes</option>
                                    <option value="dots">Dots</option>
                                    <option value="bars">Segmented Bars</option>
                                    <option value="wave">Wave Effect</option>
                                </select>
                            </label>
                            <label>
                                <span>Mode:</span>
                                <select id="settingStrobeMode">
                                    <option value="single">Single Ring</option>
                                    <option value="dual">Dual Rings</option>
                                    <option value="triple">Triple Rings</option>
                                    <option value="expanding">Expanding Rings</option>
                                </select>
                            </label>
                            <label>
                                <input type="checkbox" id="settingStrobeCircleFork" checked>
                                <span>Circle Tuning Fork</span>
                            </label>
                            <label>
                                <span>Segments:</span>
                                <input type="range" id="settingStrobeSegments" min="6" max="24" step="1" value="12">
                                <span id="valueStrobeSegments">12</span>
                            </label>
                            <label>
                                <span>Radius:</span>
                                <input type="range" id="settingStrobeRadius" min="50" max="200" step="10" value="100">
                                <span id="valueStrobeRadius">100px</span>
                            </label>
                            <label>
                                <span>Width:</span>
                                <input type="range" id="settingStrobeWidth" min="10" max="60" step="5" value="30">
                                <span id="valueStrobeWidth">30px</span>
                            </label>
                            <label>
                                <span>Speed:</span>
                                <input type="range" id="settingStrobeSpeed" min="0.5" max="3" step="0.1" value="1">
                                <span id="valueStrobeSpeed">1.0x</span>
                            </label>
                            <label>
                                <span>Opacity:</span>
                                <input type="range" id="settingStrobeOpacity" min="0.3" max="1" step="0.1" value="0.7">
                                <span id="valueStrobeOpacity">0.7</span>
                            </label>
                            <label>
                                <span>Reference Frequency:</span>
                                <input type="number" id="settingStrobeReferenceFreq" min="200" max="800" step="1" value="440">
                                <span id="valueStrobeReferenceFreq">440 Hz</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingStrobeAlternateDirection">
                                <span>Alternate Rotation Direction</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingStrobeFrequencySize">
                                <span>Frequency-Based Size</span>
                            </label>
                        </div>

                        <!-- Peterson Strobe Settings -->
                        <div class="tuning-fork-setting-group">
                            <h4>Peterson Strobe Effect</h4>
                            <label>
                                <input type="checkbox" id="settingPetersonMode" checked>
                                <span>Enable Peterson Mode</span>
                            </label>
                            <label>
                                <span>Number of Rings:</span>
                                <input type="range" id="settingPetersonRings" min="2" max="4" step="1" value="3">
                                <span id="valuePetersonRings">3</span>
                            </label>
                            <label>
                                <span>Ring Spacing:</span>
                                <input type="range" id="settingPetersonRingSpacing" min="10" max="30" step="1" value="15">
                                <span id="valuePetersonRingSpacing">15px</span>
                            </label>
                            <label>
                                <span>Calibrated Note:</span>
                                <input type="number" id="settingPetersonCalibratedNote" min="200" max="800" step="1" value="440">
                                <span id="valuePetersonCalibratedNote">440 Hz</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingPetersonHarmonics" checked>
                                <span>Include Harmonic Rings</span>
                            </label>
                        </div>

                        <!-- Layout Settings -->
                        <div class="tuning-fork-setting-group">
                            <h4>Layout</h4>
                            <label>
                                <span>Fork Spacing:</span>
                                <input type="range" id="settingForkSpacing" min="0.2" max="0.4" step="0.05" value="0.25">
                                <span id="valueForkSpacing">25%</span>
                            </label>
                            <label>
                                <span>Fork Y Position:</span>
                                <input type="range" id="settingForkYPosition" min="0.3" max="0.7" step="0.05" value="0.5">
                                <span id="valueForkYPosition">50%</span>
                            </label>
                        </div>

                        <!-- Preset Buttons -->
                        <div class="tuning-fork-setting-group">
                            <h4>Presets</h4>
                            <button id="presetDefault" class="btn-preset">Default</button>
                            <button id="presetMinimal" class="btn-preset">Minimal</button>
                            <button id="presetMaximal" class="btn-preset">Maximal</button>
                            <button id="presetFast" class="btn-preset">Fast Motion</button>
                            <button id="presetSlow" class="btn-preset">Slow Motion</button>
                        </div>
                    </div>
                </details>
            </section>
        </main>
    </div>

    <!-- Cymatic Visualizations Exercise -->
    <div id="cymaticVizExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="cymaticVizExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Cymatic Visualizations</p>
            </div>
            <button id="audioSettingsBtnCymatic" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>
        <main>
            <section class="card cymatic-viz-main">
                <!-- Cymatic Type Selection -->
                <div class="cymatic-type-selector">
                    <button id="cymaticTypeChladni" class="cymatic-type-btn active" data-type="chladni">
                        Chladni Plate
                    </button>
                    <button id="cymaticTypeWater" class="cymatic-type-btn" data-type="water">
                        Water Cymatics
                    </button>
                    <button id="cymaticTypeSand" class="cymatic-type-btn" data-type="sand">
                        Sand Patterns
                    </button>
                    <button id="cymaticTypeHarmonic" class="cymatic-type-btn" data-type="harmonic">
                        Harmonic Field
                    </button>
                    <button id="cymaticTypeMembrane" class="cymatic-type-btn" data-type="membrane">
                        Circular Membrane
                    </button>
                </div>

                <!-- Control Panel -->
                <div class="cymatic-controls">
                    <div class="cymatic-tone-controls">
                        <div class="cymatic-tone-control">
                            <label>Tone 1 Position:</label>
                            <div class="cymatic-position-inputs">
                                <input type="range" id="cymaticTone1X" class="cymatic-position-slider" min="0" max="100" step="1" value="25">
                                <span id="cymaticTone1XValue">25%</span>
                            </div>
                        </div>
                        <div class="cymatic-tone-control">
                            <label>Tone 1 Frequency:</label>
                            <input type="range" id="cymaticTone1Freq" class="cymatic-freq-slider" min="27.5" max="4186" step="0.1" value="330">
                            <input type="number" id="cymaticTone1FreqNum" value="330" min="27.5" max="4186" step="0.1">
                            <span>Hz</span>
                        </div>
                    </div>

                    <div class="cymatic-tone-controls">
                        <div class="cymatic-tone-control">
                            <label>Tone 2 Position:</label>
                            <div class="cymatic-position-inputs">
                                <input type="range" id="cymaticTone2X" class="cymatic-position-slider" min="0" max="100" step="1" value="75">
                                <span id="cymaticTone2XValue">75%</span>
                            </div>
                        </div>
                        <div class="cymatic-tone-control">
                            <label>Tone 2 Frequency:</label>
                            <input type="range" id="cymaticTone2Freq" class="cymatic-freq-slider" min="27.5" max="4186" step="0.1" value="440">
                            <input type="number" id="cymaticTone2FreqNum" value="440" min="27.5" max="4186" step="0.1">
                            <span>Hz</span>
                        </div>
                    </div>

                    <div class="cymatic-button-group">
                        <button id="cymaticPlayTone1Btn" class="btn-exercise btn-secondary">Play Tone 1</button>
                        <button id="cymaticPlayTone2Btn" class="btn-exercise btn-secondary">Play Tone 2</button>
                        <button id="cymaticPlayBothBtn" class="btn-exercise-large btn-next">Play Both</button>
                        <button id="cymaticRandomizeBtn" class="btn-exercise btn-secondary">üé≤ Randomize</button>
                    </div>
                </div>

                <!-- Visualization Canvas -->
                <div class="cymatic-viz-container">
                    <canvas id="cymaticCanvas" class="cymatic-canvas"></canvas>
                </div>

                <!-- Settings Panel -->
                <details class="cymatic-settings-panel">
                    <summary class="cymatic-settings-header">‚öôÔ∏è Cymatic Settings</summary>
                    <div class="cymatic-settings-grid">
                        <!-- General Settings -->
                        <div class="cymatic-setting-group">
                            <h4>General</h4>
                            <label>
                                <span>Resolution:</span>
                                <input type="range" id="settingCymaticResolution" min="50" max="200" step="10" value="100">
                                <span id="valueCymaticResolution">100</span>
                            </label>
                            <label>
                                <span>Amplitude:</span>
                                <input type="range" id="settingCymaticAmplitude" min="0.5" max="2" step="0.1" value="1.5">
                                <span id="valueCymaticAmplitude">1.5x</span>
                            </label>
                            <label>
                                <span>Damping:</span>
                                <input type="range" id="settingCymaticDamping" min="0.9" max="0.999" step="0.001" value="0.96">
                                <span id="valueCymaticDamping">0.96</span>
                            </label>
                            <label>
                                <span>Animation Speed:</span>
                                <input type="range" id="settingCymaticSpeed" min="0.1" max="2" step="0.1" value="1.2">
                                <span id="valueCymaticSpeed">1.2x</span>
                            </label>
                        </div>

                        <!-- Chladni Plate Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Chladni Plate</h4>
                            <label>
                                <span>Plate Shape:</span>
                                <select id="settingChladniPlateShape">
                                    <option value="square">Square</option>
                                    <option value="circular">Circular</option>
                                </select>
                            </label>
                            <label>
                                <span>Particle Count:</span>
                                <input type="range" id="settingChladniParticles" min="1000" max="15000" step="500" value="6000">
                                <span id="valueChladniParticles">6000</span>
                            </label>
                            <label>
                                <span>Particle Size:</span>
                                <input type="range" id="settingChladniParticleSize" min="1" max="5" step="0.5" value="2.5">
                                <span id="valueChladniParticleSize">2.5px</span>
                            </label>
                            <label>
                                <span>Node Attraction:</span>
                                <input type="range" id="settingChladniAttraction" min="0.1" max="1" step="0.1" value="0.7">
                                <span id="valueChladniAttraction">0.7</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingChladniShowNodes" checked>
                                <span>Show Nodal Lines</span>
                            </label>
                            <label>
                                <span>Nodal Line Width:</span>
                                <input type="range" id="settingChladniNodalLineWidth" min="1" max="6" step="0.5" value="3">
                                <span id="valueChladniNodalLineWidth">3px</span>
                            </label>
                            <label>
                                <span>Nodal Line Color:</span>
                                <input type="color" id="settingChladniNodalLineColor" value="#ffffff">
                            </label>
                            <label>
                                <input type="checkbox" id="settingChladniShowInteraction" checked>
                                <span>Highlight Interaction Zones</span>
                            </label>
                        </div>

                        <!-- Water Cymatics Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Water Cymatics</h4>
                            <label>
                                <span>Wave Height:</span>
                                <input type="range" id="settingWaterHeight" min="5" max="40" step="1" value="20">
                                <span id="valueWaterHeight">20px</span>
                            </label>
                            <label>
                                <span>Ripple Count:</span>
                                <input type="range" id="settingWaterRipples" min="5" max="24" step="1" value="16">
                                <span id="valueWaterRipples">16</span>
                            </label>
                            <label>
                                <span>Surface Tension:</span>
                                <input type="range" id="settingWaterTension" min="0.1" max="1" step="0.1" value="0.4">
                                <span id="valueWaterTension">0.4</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingWaterReflection" checked>
                                <span>Show Reflections</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingWaterShowBeats" checked>
                                <span>Show Beat Patterns</span>
                            </label>
                            <label>
                                <span>Wave Layers:</span>
                                <input type="range" id="settingWaterLayers" min="1" max="10" step="1" value="5">
                                <span id="valueWaterLayers">5</span>
                            </label>
                        </div>

                        <!-- Circular Membrane Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Circular Membrane</h4>
                            <label>
                                <span>Membrane Radius:</span>
                                <input type="range" id="settingMembraneRadius" min="150" max="400" step="10" value="250">
                                <span id="valueMembraneRadius">250px</span>
                            </label>
                            <label>
                                <span>Resolution:</span>
                                <input type="range" id="settingMembraneResolution" min="40" max="120" step="10" value="80">
                                <span id="valueMembraneResolution">80</span>
                            </label>
                            <label>
                                <span>Wave Layers:</span>
                                <input type="range" id="settingMembraneLayers" min="1" max="5" step="1" value="3">
                                <span id="valueMembraneLayers">3</span>
                            </label>
                            <label>
                                <span>Nodal Line Width:</span>
                                <input type="range" id="settingMembraneNodalLineWidth" min="1" max="6" step="1" value="3">
                                <span id="valueMembraneNodalLineWidth">3px</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingMembraneShowNodes" checked>
                                <span>Show Nodal Circles</span>
                            </label>
                        </div>

                        <!-- Sand Pattern Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Sand Patterns</h4>
                            <label>
                                <span>Grain Count:</span>
                                <input type="range" id="settingSandGrains" min="2000" max="20000" step="500" value="10000">
                                <span id="valueSandGrains">10000</span>
                            </label>
                            <label>
                                <span>Grain Size:</span>
                                <input type="range" id="settingSandGrainSize" min="0.5" max="4" step="0.5" value="2">
                                <span id="valueSandGrainSize">2px</span>
                            </label>
                            <label>
                                <span>Gravity:</span>
                                <input type="range" id="settingSandGravity" min="0.1" max="2" step="0.1" value="0.6">
                                <span id="valueSandGravity">0.6</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingSandShowField" checked>
                                <span>Show Vibration Field</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingSandShowInterference" checked>
                                <span>Highlight Interference</span>
                            </label>
                        </div>

                        <!-- Harmonic Field Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Harmonic Field</h4>
                            <label>
                                <span>Field Lines:</span>
                                <input type="range" id="settingHarmonicLines" min="8" max="40" step="1" value="20">
                                <span id="valueHarmonicLines">20</span>
                            </label>
                            <label>
                                <span>Field Density:</span>
                                <input type="range" id="settingHarmonicDensity" min="0.5" max="2" step="0.1" value="1.3">
                                <span id="valueHarmonicDensity">1.3x</span>
                            </label>
                            <label>
                                <span>Line Thickness:</span>
                                <input type="range" id="settingHarmonicLineThickness" min="0.5" max="5" step="0.5" value="2">
                                <span id="valueHarmonicLineThickness">2px</span>
                            </label>
                            <label>
                                <span>Harmonic Order:</span>
                                <input type="range" id="settingHarmonicOrder" min="1" max="8" step="1" value="4">
                                <span id="valueHarmonicOrder">4</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingHarmonicShowPhase" checked>
                                <span>Show Phase Relationships</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingHarmonicShowBeats" checked>
                                <span>Show Beat Frequency</span>
                            </label>
                        </div>

                        <!-- Interference Patterns -->
                        <div class="cymatic-setting-group">
                            <h4>Interference Patterns</h4>
                            <label>
                                <input type="checkbox" id="settingShowInterferenceZonesToggle" checked>
                                <span>Enable Interference Visualization</span>
                            </label>
                            <label>
                                <span>Interference Opacity:</span>
                                <input type="range" id="settingInterferenceOpacityControl" min="0.1" max="1" step="0.1" value="0.8">
                                <span id="valueInterferenceOpacityControl">0.8</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingHighlightInterference" checked>
                                <span>Brighten Interference Zones</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingCymaticColorBlend" checked>
                                <span>Blend Colors at Intersection</span>
                            </label>
                        </div>

                        <!-- Color Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Colors & Intervals</h4>
                            <label>
                                <input type="checkbox" id="settingUseIntervalColors" checked>
                                <span>Use Interval-Based Colors</span>
                            </label>

                            <hr style="margin: 12px 0; border: none; border-top: 1px solid rgba(138, 43, 226, 0.3);">

                            <p style="font-size: 0.85rem; color: #888; margin: 8px 0;">Manual Colors (when Interval-Based is off)</p>

                            <label>
                                <span>Tone 1 Color:</span>
                                <input type="color" id="settingCymaticTone1Color" value="#00ffff">
                            </label>
                            <label>
                                <span>Tone 2 Color:</span>
                                <input type="color" id="settingCymaticTone2Color" value="#ff00ff">
                            </label>
                            <label>
                                <span>Intersection Color:</span>
                                <input type="color" id="settingCymaticIntersectionColor" value="#ffff00">
                            </label>

                            <hr style="margin: 12px 0; border: none; border-top: 1px solid rgba(138, 43, 226, 0.3);">

                            <p style="font-size: 0.85rem; color: #888; margin: 8px 0;">Interval Color Settings</p>

                            <label>
                                <span>Root/Consonance Color:</span>
                                <input type="color" id="settingConsonanceColor" value="#00ffff">
                            </label>
                            <label>
                                <span>Dissonance Color:</span>
                                <input type="color" id="settingDissonanceColor" value="#ff0000">
                            </label>
                            <label>
                                <span>Overlap Effect:</span>
                                <select id="settingOverlapEffect">
                                    <option value="additive">Additive (Light)</option>
                                    <option value="intensity" selected>Intensity Boost</option>
                                    <option value="saturation">Saturation Boost</option>
                                    <option value="multiply">Multiply (Dark)</option>
                                </select>
                            </label>
                            <label>
                                <span>Color Contrast:</span>
                                <input type="range" id="settingColorContrast" min="0.5" max="2" step="0.1" value="1">
                                <span id="valueColorContrast">1.0x</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingBlackTransparent">
                                <span>Black = Transparent</span>
                            </label>
                        </div>

                        <!-- Pulse Effects Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Pulse Effects</h4>
                            <label>
                                <input type="checkbox" id="settingShowStartPulse" checked>
                                <span>Show Start Pulse</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingShowStopPulse" checked>
                                <span>Show Stop Pulse</span>
                            </label>
                            <label>
                                <input type="checkbox" id="settingShowInterferencePulse" checked>
                                <span>Show Interference Pulse</span>
                            </label>
                            <label>
                                <span>Pulse Speed:</span>
                                <input type="range" id="settingPulseSpeed" min="100" max="600" step="50" value="300">
                                <span id="valuePulseSpeed">300 px/s</span>
                            </label>
                            <label>
                                <span>Pulse Duration:</span>
                                <input type="range" id="settingPulseDuration" min="500" max="4000" step="500" value="2000">
                                <span id="valuePulseDuration">2000ms</span>
                            </label>
                            <label>
                                <span>Pulse Opacity:</span>
                                <input type="range" id="settingPulseOpacity" min="0.1" max="1" step="0.1" value="0.6">
                                <span id="valuePulseOpacity">0.6</span>
                            </label>
                            <label>
                                <span>Pulse Width:</span>
                                <input type="range" id="settingPulseWidth" min="1" max="6" step="0.5" value="3">
                                <span id="valuePulseWidth">3px</span>
                            </label>
                            <label>
                                <span>Interference Pulse Interval:</span>
                                <input type="range" id="settingInterferencePulseInterval" min="250" max="2000" step="250" value="1000">
                                <span id="valueInterferencePulseInterval">1000ms</span>
                            </label>
                        </div>

                        <!-- Preset Buttons -->
                        <div class="cymatic-setting-group">
                            <h4>Presets</h4>
                            <button id="cymaticPresetDefault" class="btn-preset">Default</button>
                            <button id="cymaticPresetSubtle" class="btn-preset">Subtle</button>
                            <button id="cymaticPresetIntense" class="btn-preset">Intense</button>
                            <button id="cymaticPresetHarmonic" class="btn-preset">Harmonic</button>
                        </div>
                    </div>
                </details>
            </section>
        </main>
    </div>

    <!-- Cymatic Harmonic Visualization Exercise -->
    <div id="cymaticHarmonicVizExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="cymaticHarmonicVizExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Cymatic Harmonic Visualization</p>
            </div>
        </header>
        <main>
            <section class="card">
                <!-- Canvas container for renderers -->
                <div id="cymaticCanvasContainer" style="position: relative; width: 100%; height: 600px; background: #0a0a14; border-radius: 8px;">
                    <!-- Canvas 2D renderer -->
                    <canvas id="cymaticHarmonicCanvas" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: block;"></canvas>
                    <!-- WebGL renderer (separate canvas) -->
                    <canvas id="cymaticHarmonicCanvasWebGL" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: none;"></canvas>
                </div>

                <!-- Main Controls -->
                <div style="margin-top: 20px; display: grid; gap: 20px;">
                    <!-- Primary Actions -->
                    <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                        <button id="cymaticHarmonicPlayBothBtn" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            ‚ñ∂Ô∏è Play Both
                        </button>
                        <button id="cymaticHarmonicRandomizeBtn" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            üé≤ Randomize & Play
                        </button>
                    </div>

                    <!-- Individual Tone Controls -->
                    <details open style="border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 16px;">
                        <summary style="cursor: pointer; font-weight: bold; font-size: 16px; margin-bottom: 12px;">üéµ Individual Tone Controls</summary>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 12px;">
                            <!-- Tone 1 -->
                            <div style="padding: 12px; background: rgba(0, 255, 255, 0.05); border-radius: 8px; border: 1px solid rgba(0, 255, 255, 0.2);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <h3 style="margin: 0; color: #00ffff;">Tone 1 (Root)</h3>
                                    <button id="cymaticHarmonicPlayTone1Btn" class="btn-control" style="padding: 6px 16px;">Play</button>
                                </div>
                                <div class="frequency-controls">
                                    <input type="range" id="cymaticHarmonicTone1Freq" min="27" max="4186" value="440" step="1" style="width: 100%;">
                                    <input type="number" id="cymaticHarmonicTone1FreqNum" min="27" max="4186" value="440" step="1" style="width: 100%; margin-top: 8px;">
                                </div>
                            </div>

                            <!-- Tone 2 -->
                            <div style="padding: 12px; background: rgba(255, 0, 255, 0.05); border-radius: 8px; border: 1px solid rgba(255, 0, 255, 0.2);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <h3 style="margin: 0; color: #ff00ff;">Tone 2 (Interval)</h3>
                                    <button id="cymaticHarmonicPlayTone2Btn" class="btn-control" style="padding: 6px 16px;">Play</button>
                                </div>
                                <div class="frequency-controls">
                                    <input type="range" id="cymaticHarmonicTone2Freq" min="27" max="4186" value="554" step="1" style="width: 100%;">
                                    <input type="number" id="cymaticHarmonicTone2FreqNum" min="27" max="4186" value="554" step="1" style="width: 100%; margin-top: 8px;">
                                </div>
                            </div>
                        </div>

                        <!-- Solfege Scale Buttons (2 octaves from Do = Tone 1) -->
                        <div style="margin-top: 16px; padding: 12px; background: rgba(255, 255, 255, 0.02); border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="display: flex; flex-wrap: wrap; gap: 6px; justify-content: center;">
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="0" style="padding: 8px 12px;">Do</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="2" style="padding: 8px 12px;">Re</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="4" style="padding: 8px 12px;">Mi</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="5" style="padding: 8px 12px;">Fa</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="7" style="padding: 8px 12px;">Sol</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="9" style="padding: 8px 12px;">La</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="11" style="padding: 8px 12px;">Ti</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="12" style="padding: 8px 12px;">Do¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="14" style="padding: 8px 12px;">Re¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="16" style="padding: 8px 12px;">Mi¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="17" style="padding: 8px 12px;">Fa¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="19" style="padding: 8px 12px;">Sol¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="21" style="padding: 8px 12px;">La¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="23" style="padding: 8px 12px;">Ti¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="24" style="padding: 8px 12px;">Do¬≥</button>
                            </div>
                        </div>
                    </details>
                </div>

                <!-- Settings -->
                <details open style="margin-top: 20px;">
                    <summary style="display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0;">Settings</h3>
                        <div style="display: flex; gap: 8px;">
                            <button id="cymaticHarmonicColorSpectrumBtn" class="btn-control" style="padding: 4px 12px; font-size: 12px;">üåà Color Spectrum</button>
                            <button id="cymaticHarmonicPianoSpectrumBtn" class="btn-control" style="padding: 4px 12px; font-size: 12px;">üéπ Piano Spectrum</button>
                            <button id="cymaticHarmonicCopySettingsBtn" class="btn-control" style="padding: 4px 12px; font-size: 12px;">üìã Copy Settings</button>
                        </div>
                    </summary>
                    <div class="settings-panel">
                        <!-- Renderer Selection -->
                        <div class="cymatic-setting-group">
                            <h4>Renderer</h4>
                            <label title="Choose rendering engine - WebGL for high performance, Canvas 2D for compatibility">
                                <span>Engine:</span>
                                <select id="settingRenderer">
                                    <option value="webgl">WebGL (High Performance)</option>
                                    <option value="canvas2d">Canvas 2D (Compatible)</option>
                                </select>
                            </label>
                            <div id="rendererInfo" style="font-size: 11px; color: #888; margin-top: 4px;"></div>
                        </div>

                        <!-- Color System Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Color System</h4>
                            <label title="Choose how frequencies are mapped to colors">
                                <span>Color Mode:</span>
                                <select id="settingColorMode2">
                                    <option value="piano">Piano Coloring</option>
                                    <option value="continuous">Continuous Gradient</option>
                                </select>
                            </label>
                        </div>

                        <!-- Harmonic Field Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Harmonic Field</h4>
                            <label title="Toggle visibility of the radiating field lines from tone sources">
                                <input type="checkbox" id="settingShowFieldLines2" checked>
                                <span>Show Field Lines</span>
                            </label>
                            <label title="Toggle visibility of the interference pattern visualization">
                                <input type="checkbox" id="settingShowInterferencePattern2" checked>
                                <span>Show Interference Pattern</span>
                            </label>
                            <label title="Number of radiating lines emanating from each tone source">
                                <span>Field Lines:</span>
                                <input type="range" id="settingHarmonicLines2" min="8" max="40" step="1" value="20">
                                <span id="valueHarmonicLines2">20</span>
                            </label>
                            <label title="Wave curvature of field lines - higher values create more waviness">
                                <span>Density:</span>
                                <input type="range" id="settingHarmonicDensity2" min="0.5" max="2.0" step="0.1" value="1.3">
                                <span id="valueHarmonicDensity2">1.3x</span>
                            </label>
                            <label title="Number of harmonic overtones in interference calculation - creates richer patterns">
                                <span>Harmonic Order:</span>
                                <input type="range" id="settingHarmonicOrder2" min="1" max="8" step="1" value="5">
                                <span id="valueHarmonicOrder2">5</span>
                            </label>
                            <label title="Visual thickness of field lines">
                                <span>Line Thickness:</span>
                                <input type="range" id="settingHarmonicLineThickness2" min="0.5" max="5" step="0.5" value="2">
                                <span id="valueHarmonicLineThickness2">2px</span>
                            </label>
                            <label title="Overall brightness and intensity of interference patterns">
                                <span>Amplitude:</span>
                                <input type="range" id="settingAmplitude2" min="0.5" max="3.0" step="0.1" value="1.5">
                                <span id="valueAmplitude2">1.5x</span>
                            </label>
                            <label title="Animation speed of wave propagation">
                                <span>Speed:</span>
                                <input type="range" id="settingSpeed2" min="0.5" max="2.5" step="0.1" value="1.2">
                                <span id="valueSpeed2">1.2x</span>
                            </label>
                            <label title="Grid size for interference patterns - lower values = higher detail but slower performance">
                                <span>Interference Resolution:</span>
                                <input type="range" id="settingInterferenceResolution2" min="5" max="40" step="1" value="15">
                                <span id="valueInterferenceResolution2">15px</span>
                            </label>
                            <label title="Grid size for overlapping interference zones - lower values = finer detail in overlap regions">
                                <span>Overlap Resolution:</span>
                                <input type="range" id="settingOverlapResolution2" min="2" max="20" step="1" value="8">
                                <span id="valueOverlapResolution2">8px</span>
                            </label>
                        </div>

                        <!-- Edge Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Edge Quality</h4>
                            <label title="Use high-resolution calculated edges near boundaries for maximum smoothness">
                                <input type="checkbox" id="settingUseSmoothCalculatedEdges2">
                                <span>Smooth Calculated Edges</span>
                            </label>
                            <label title="Grid size for boundary edges - lower values = smoother edges with higher detail (only when Smooth Calculated Edges enabled)">
                                <span>Edge Resolution:</span>
                                <input type="range" id="settingEdgeResolution2" min="1" max="10" step="1" value="3">
                                <span id="valueEdgeResolution2">3px</span>
                            </label>
                            <label title="Distance from boundary to apply edge resolution - larger values = more area with fine detail (only when Smooth Calculated Edges enabled)">
                                <span>Edge Size:</span>
                                <input type="range" id="settingEdgeSize2" min="20" max="200" step="10" value="100">
                                <span id="valueEdgeSize2">100px</span>
                            </label>
                            <label title="Apply simple blur effect at boundaries for soft edges without expensive calculations">
                                <input type="checkbox" id="settingUseFoggyEdge2">
                                <span>Foggy Edge</span>
                            </label>
                            <label title="Resolution for foggy edge rendering - lower values = smoother but slower (only when Foggy Edge enabled)">
                                <span>Foggy Edge Resolution:</span>
                                <input type="range" id="settingFoggyEdgeResolution2" min="1" max="5" step="1" value="2">
                                <span id="valueFoggyEdgeResolution2">2px</span>
                            </label>
                            <label title="Where the fade starts as percentage of radius - lower values = more fade area">
                                <span>Fade Start:</span>
                                <input type="range" id="settingFoggyEdgeStart2" min="0.5" max="0.9" step="0.05" value="0.7">
                                <span id="valueFoggyEdgeStart2">70%</span>
                            </label>
                            <label title="Amount of feathering in the fade - higher values = softer gradient">
                                <span>Feather Amount:</span>
                                <input type="range" id="settingFoggyEdgeFeather2" min="0.1" max="0.5" step="0.05" value="0.3">
                                <span id="valueFoggyEdgeFeather2">30%</span>
                            </label>
                        </div>

                        <!-- Boundary Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Boundary</h4>
                            <label title="Enable circular boundary around each tone - limits pattern extent for clearer visualization">
                                <input type="checkbox" id="settingUseBoundary2" checked>
                                <span>Use Boundary</span>
                            </label>
                            <label title="Maximum distance interference patterns extend from each tone source">
                                <span>Boundary Radius:</span>
                                <input type="range" id="settingBoundaryRadius2" min="100" max="800" step="25" value="300">
                                <span id="valueBoundaryRadius2">300px</span>
                            </label>
                            <label title="Fade distance at boundary edge - creates smooth gradient instead of hard cutoff">
                                <span>Boundary Falloff:</span>
                                <input type="range" id="settingBoundaryFalloff2" min="10" max="200" step="10" value="50">
                                <span id="valueBoundaryFalloff2">50px</span>
                            </label>
                            <label title="Visual radius of speaker icon - interference circles start at speaker edge">
                                <span>Speaker Radius:</span>
                                <input type="range" id="settingSpeakerRadius2" min="15" max="60" step="5" value="30">
                                <span id="valueSpeakerRadius2">30px</span>
                            </label>
                        </div>

                        <!-- Pulse Effects Settings -->
                        <details class="cymatic-setting-group">
                            <summary style="cursor: pointer; font-weight: bold; font-size: 14px; margin-bottom: 12px;">
                                <h4 style="display: inline; font-size: 14px;">üîò Pulse Effects (Advanced)</h4>
                            </summary>
                            <div style="margin-left: 12px;">
                                <label title="Show expanding rings when tones start - solid circles spreading from tone sources">
                                    <input type="checkbox" id="settingShowStartPulse2">
                                    <span>Show Start Pulse</span>
                                </label>
                                <label title="Show expanding rings when tones stop - dashed circles spreading from tone sources">
                                    <input type="checkbox" id="settingShowStopPulse2">
                                    <span>Show Stop Pulse</span>
                                </label>
                                <label title="Show periodic pulses at the interference midpoint - reveals beating frequency patterns">
                                    <input type="checkbox" id="settingShowInterferencePulse2">
                                    <span>Show Interference Pulse</span>
                                </label>
                                <label title="Sync interference pulses to the actual beat frequency between tones instead of fixed interval">
                                    <input type="checkbox" id="settingUseBeatFrequency2" checked>
                                    <span>Use Beat Frequency</span>
                                </label>
                                <label title="How fast pulse rings expand across the canvas">
                                    <span>Pulse Speed:</span>
                                    <input type="range" id="settingPulseSpeed2" min="100" max="600" step="50" value="300">
                                    <span id="valuePulseSpeed2">300 px/s</span>
                                </label>
                                <label title="How long pulse rings remain visible before fading out">
                                    <span>Pulse Duration:</span>
                                    <input type="range" id="settingPulseDuration2" min="500" max="4000" step="500" value="2000">
                                    <span id="valuePulseDuration2">2000ms</span>
                                </label>
                                <label title="Initial transparency of pulse rings">
                                    <span>Pulse Opacity:</span>
                                    <input type="range" id="settingPulseOpacity2" min="0.1" max="1" step="0.1" value="0.6">
                                    <span id="valuePulseOpacity2">0.6</span>
                                </label>
                                <label title="Line thickness of pulse rings">
                                    <span>Pulse Width:</span>
                                    <input type="range" id="settingPulseWidth2" min="1" max="6" step="0.5" value="3">
                                    <span id="valuePulseWidth2">3px</span>
                                </label>
                                <label title="Time between interference pulses - shorter intervals create more frequent visual beats (only used when Beat Frequency is off)">
                                    <span>Interference Pulse Interval:</span>
                                    <input type="range" id="settingInterferencePulseInterval2" min="250" max="2000" step="250" value="1000">
                                    <span id="valueInterferencePulseInterval2">1000ms</span>
                                </label>
                            </div>
                        </details>

                        <!-- Beat Frequency Visualization -->
                        <details class="cymatic-setting-group">
                            <summary style="cursor: pointer; font-weight: bold; font-size: 14px; margin-bottom: 12px;">
                                <h4 style="display: inline; font-size: 14px;">üìä Beat Frequency Visualization (Advanced)</h4>
                            </summary>
                            <div style="margin-left: 12px;">
                                <label title="Enable overall beat frequency brightness pulsing across entire overlap area">
                                    <input type="checkbox" id="settingShowOverallBeat2" checked>
                                    <span>Overall Beat Pulsing</span>
                                </label>
                                <label title="Intensity of overall beat brightness pulsing">
                                    <span>Overall Beat Intensity:</span>
                                    <input type="range" id="settingOverallBeatIntensity2" min="0.0" max="1.0" step="0.05" value="0.0">
                                    <span id="valueOverallBeatIntensity2">0.0x</span>
                                </label>

                                <hr style="margin: 12px 0; border: none; border-top: 1px solid #444;">

                                <label title="Highlight dark interference nodes (destructive interference points) with pulsing effect">
                                    <input type="checkbox" id="settingShowNodePulse2">
                                    <span>Dark Node Pulsing</span>
                                </label>
                                <label title="Intensity of dark node pulsing effect">
                                    <span>Node Pulse Intensity:</span>
                                    <input type="range" id="settingNodePulseIntensity2" min="0.0" max="2.0" step="0.1" value="0.5">
                                    <span id="valueNodePulseIntensity2">0.5x</span>
                                </label>
                                <label title="Color of the node pulse glow effect">
                                    <span>Node Pulse Color:</span>
                                    <input type="color" id="settingNodePulseColor2" value="#ffffff">
                                </label>
                            </div>
                        </details>

                        <details class="cymatic-setting-group">
                            <summary style="cursor: pointer; font-weight: bold; font-size: 14px; margin-bottom: 12px;">
                                <h4 style="display: inline; font-size: 14px;">üåä Advanced Beat Visualizations</h4>
                            </summary>
                            <div style="margin-left: 12px;">

                            <!-- Ring Breathing -->
                            <label title="Make interference rings expand/contract with beat - shows wave relationship changing" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingRingBreathing2">
                                <span style="font-weight: bold;">Ring Breathing Effect</span>
                            </label>
                            <label title="Intensity of ring breathing" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Intensity:</span>
                                <input type="range" id="settingRingBreathingIntensity2" min="0.0" max="2.0" step="0.1" value="0.5" style="width: 150px;">
                                <span id="valueRingBreathingIntensity2" style="display: inline-block; width: 40px;">0.5x</span>
                            </label>

                            <!-- Heat Map -->
                            <label title="Color-code pattern by constructive (warm) vs destructive (cool) interference" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingHeatMap2">
                                <span style="font-weight: bold;">Interference Heat Map</span>
                            </label>
                            <label title="Intensity of heat map coloring" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Intensity:</span>
                                <input type="range" id="settingHeatMapIntensity2" min="0.0" max="1.0" step="0.1" value="0.5" style="width: 150px;">
                                <span id="valueHeatMapIntensity2" style="display: inline-block; width: 40px;">0.5x</span>
                            </label>

                            <!-- Node Migration -->
                            <label title="Make dark nodes drift/migrate along interference pattern with beat" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingNodeMigration2">
                                <span style="font-weight: bold;">Node Migration Animation</span>
                            </label>
                            <label title="Speed of node migration" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Speed:</span>
                                <input type="range" id="settingNodeMigrationSpeed2" min="0.0" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valueNodeMigrationSpeed2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>
                            <label title="Animate migration effect in and out" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <input type="checkbox" id="settingNodeMigrationAnimate2">
                                <span>Animate Migration</span>
                            </label>

                            </div>
                        </details>

                        <!-- Advanced Migration Modes -->
                        <details class="cymatic-setting-group">
                            <summary style="cursor: pointer; font-weight: bold; font-size: 14px; margin-bottom: 12px;">
                                <h4 style="display: inline; font-size: 14px;">üîÄ Advanced Migration Modes</h4>
                            </summary>
                            <div style="margin-left: 12px;">

                            <!-- Node Density Flow -->
                            <label title="Node spacing changes based on frequency ratio and oscillates with beat" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingNodeDensityFlow2">
                                <span style="font-weight: bold;">Node Density Flow</span>
                            </label>
                            <label title="Intensity of density oscillation" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Intensity:</span>
                                <input type="range" id="settingNodeDensityIntensity2" min="0.0" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valueNodeDensityIntensity2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>

                            <!-- Phase Coherence Trails -->
                            <label title="Nodes leave trailing echoes, length determined by consonance" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingPhaseTrails2">
                                <span style="font-weight: bold;">Phase Coherence Trails</span>
                            </label>
                            <label title="Length of phase trails" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Trail Length:</span>
                                <input type="range" id="settingPhaseTrailLength2" min="0.1" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valuePhaseTrailLength2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>

                            <!-- Node Coalescence -->
                            <label title="Nodes attract and repel, merging cleanly for consonance, chaotically for dissonance" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingNodeCoalescence2">
                                <span style="font-weight: bold;">Node Coalescence Pattern</span>
                            </label>
                            <label title="Strength of node attraction/repulsion" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Force Strength:</span>
                                <input type="range" id="settingCoalescenceStrength2" min="0.0" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valueCoalescenceStrength2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>

                            <!-- Harmonic Flow Field -->
                            <label title="Nodes follow flow patterns - smooth for consonance, turbulent for dissonance" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingFlowField2">
                                <span style="font-weight: bold;">Harmonic Flow Field</span>
                            </label>
                            <label title="Turbulence amount in flow field" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Turbulence:</span>
                                <input type="range" id="settingFlowTurbulence2" min="0.0" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valueFlowTurbulence2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>

                            <!-- Interference Depth Layers -->
                            <label title="Multiple stacked phase layers with parallax - few for consonance, many for dissonance" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingDepthLayers2">
                                <span style="font-weight: bold;">Interference Depth Layers</span>
                            </label>
                            <label title="Number of depth layers" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Layer Count:</span>
                                <input type="range" id="settingDepthLayerCount2" min="2" max="8" step="1" value="4" style="width: 150px;">
                                <span id="valueDepthLayerCount2" style="display: inline-block; width: 40px;">4</span>
                            </label>
                            <label title="Parallax depth separation" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Parallax:</span>
                                <input type="range" id="settingDepthParallax2" min="0.0" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valueDepthParallax2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>

                            <!-- Zone Toggle -->
                            <label title="Alternate highlighting between constructive and destructive zones with beat" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingZoneToggle2">
                                <span style="font-weight: bold;">Constructive/Destructive Toggle</span>
                            </label>
                            <label title="Contrast between constructive and destructive zones" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Contrast:</span>
                                <input type="range" id="settingZoneToggleContrast2" min="0.0" max="1.0" step="0.1" value="0.5" style="width: 150px;">
                                <span id="valueZoneToggleContrast2" style="display: inline-block; width: 40px;">0.5x</span>
                            </label>

                            </div>
                        </details>

                        <!-- Gravity Well Effects - Main Features -->
                        <details open class="cymatic-setting-group">
                            <summary style="cursor: pointer; font-weight: bold; font-size: 14px; margin-bottom: 12px;">
                                <h4 style="display: inline; font-size: 14px;">üåÄ Gravity Well Effects</h4>
                            </summary>
                            <div style="margin-left: 12px;">

                            <!-- Gravity Well Warp -->
                            <label title="Beat creates gravity wells that bend interference pattern like spacetime" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingGravityWell2" checked>
                                <span style="font-weight: bold;">Gravity Well Warp</span>
                            </label>
                            <label title="Strength of gravitational warping" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Well Strength:</span>
                                <input type="range" id="settingGravityStrength2" min="0.0" max="200.0" step="10.0" value="170.0" style="width: 150px;">
                                <span id="valueGravityStrength2" style="display: inline-block; width: 40px;">170.0</span>
                            </label>
                            <label title="Number of gravity wells" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Well Count:</span>
                                <input type="range" id="settingGravityWellCount2" min="1" max="5" step="1" value="5" style="width: 150px;">
                                <span id="valueGravityWellCount2" style="display: inline-block; width: 40px;">5</span>
                            </label>

                            <!-- Pulsing Black Holes -->
                            <label title="Wells pulse at beat frequency with event horizon visualization" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingGravityVariant5_2" checked>
                                <span style="font-weight: bold;">Pulsing Black Holes</span>
                            </label>
                            <label title="Pulse depth (min to max strength ratio)" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Pulse Depth:</span>
                                <input type="range" id="settingPulseDepth2" min="0.0" max="1.0" step="0.1" value="0.0" style="width: 150px;">
                                <span id="valuePulseDepth2" style="display: inline-block; width: 40px;">0.0</span>
                            </label>
                            <label title="Event horizon radius where extreme warping occurs" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Event Horizon:</span>
                                <input type="range" id="settingEventHorizon2" min="10.0" max="100.0" step="10.0" value="10.0" style="width: 150px;">
                                <span id="valueEventHorizon2" style="display: inline-block; width: 40px;">10.0</span>
                            </label>

                            <!-- Gravity Well Personality Features -->
                            <div style="margin-top: 16px; padding: 10px; background: rgba(255, 255, 255, 0.03); border-radius: 6px; border: 1px solid rgba(255, 255, 255, 0.1);">
                                <label title="Wells wobble/jitter erratically when dissonant, stay stable when consonant" style="display: block; margin-bottom: 8px;">
                                    <input type="checkbox" id="settingWellJitter2" checked>
                                    <span style="font-weight: 500;">Dissonant Well Jitter</span>
                                </label>
                                <label title="Intensity of well position jitter" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                    <span style="display: inline-block; width: 120px;">Jitter Intensity:</span>
                                    <input type="range" id="settingJitterIntensity2" min="0.0" max="20.0" step="1.0" value="1.0" style="width: 150px;">
                                    <span id="valueJitterIntensity2" style="display: inline-block; width: 40px;">1.0</span>
                                </label>

                                <label title="Wells breathe slowly when consonant, pulse rapidly when dissonant" style="display: block; margin-bottom: 8px;">
                                    <input type="checkbox" id="settingWellBreathing2" checked>
                                    <span style="font-weight: 500;">Consonance Breathing</span>
                                </label>
                                <label title="Breathing speed for consonant intervals (slow, meditative)" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                    <span style="display: inline-block; width: 120px;">Consonant Speed:</span>
                                    <input type="range" id="settingConsonantBreathSpeed2" min="0.1" max="2.0" step="0.1" value="0.1" style="width: 150px;">
                                    <span id="valueConsonantBreathSpeed2" style="display: inline-block; width: 40px;">0.1x</span>
                                </label>
                                <label title="Pulse speed for dissonant intervals (fast, anxious)" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                    <span style="display: inline-block; width: 120px;">Dissonant Speed:</span>
                                    <input type="range" id="settingDissonantPulseSpeed2" min="1.0" max="8.0" step="0.5" value="2.0" style="width: 150px;">
                                    <span id="valueDissonantPulseSpeed2" style="display: inline-block; width: 40px;">2.0x</span>
                                </label>
                            </div>

                            <!-- Other Gravity Well Variants -->
                            <details style="margin-top: 16px;">
                                <summary style="cursor: pointer; font-size: 13px; color: #aaa; margin-bottom: 8px;">
                                    Other Gravity Well Variants (Advanced)
                                </summary>
                                <div style="margin-left: 12px;">

                                    <label title="Dissonance Amplitude / Consonance Size" style="display: block; margin-bottom: 8px;">
                                        <input type="checkbox" id="settingGravityVariant1_2">
                                        <span>Dissonant Rapid / Consonant Deep</span>
                                    </label>
                                    <label title="Dissonance Amplitude control" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 120px;">Amplitude Range:</span>
                                        <input type="range" id="settingGravityAmpRange2" min="1.0" max="5.0" step="0.5" value="3.0" style="width: 150px;">
                                        <span id="valueGravityAmpRange2" style="display: inline-block; width: 40px;">3.0x</span>
                                    </label>
                                    <label title="Consonance Size control" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                        <span style="display: inline-block; width: 120px;">Well Size Range:</span>
                                        <input type="range" id="settingGravityWellSize2" min="50.0" max="300.0" step="25.0" value="150.0" style="width: 150px;">
                                        <span id="valueGravityWellSize2" style="display: inline-block; width: 40px;">150.0</span>
                                    </label>

                                    <label title="Wells push away instead of pull, fragmenting dissonant patterns" style="display: block; margin-bottom: 8px;">
                                        <input type="checkbox" id="settingGravityVariant2_2">
                                        <span>Repulsion Mode</span>
                                    </label>
                                    <label title="Repulsion strength" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                        <span style="display: inline-block; width: 120px;">Repulsion Force:</span>
                                        <input type="range" id="settingRepulsionForce2" min="0.5" max="3.0" step="0.25" value="1.5" style="width: 150px;">
                                        <span id="valueRepulsionForce2" style="display: inline-block; width: 40px;">1.5x</span>
                                    </label>

                                    <label title="Tangential force creates spiraling vortex motion around wells" style="display: block; margin-bottom: 8px;">
                                        <input type="checkbox" id="settingGravityVariant3_2">
                                        <span>Orbital Vortex</span>
                                    </label>
                                    <label title="Vortex rotation speed" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                        <span style="display: inline-block; width: 120px;">Vortex Speed:</span>
                                        <input type="range" id="settingVortexSpeed2" min="0.5" max="3.0" step="0.25" value="1.5" style="width: 150px;">
                                        <span id="valueVortexSpeed2" style="display: inline-block; width: 40px;">1.5x</span>
                                    </label>
                                    <label title="Tightness of spiral" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                        <span style="display: inline-block; width: 120px;">Spiral Tightness:</span>
                                        <input type="range" id="settingSpiralTightness2" min="0.5" max="3.0" step="0.25" value="1.5" style="width: 150px;">
                                        <span id="valueSpiralTightness2" style="display: inline-block; width: 40px;">1.5x</span>
                                    </label>

                                    <label title="Wells at tone sources create competing tidal forces" style="display: block; margin-bottom: 8px;">
                                        <input type="checkbox" id="settingGravityVariant4_2">
                                        <span>Tidal Locking</span>
                                    </label>
                                    <label title="Tidal stretching strength" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                        <span style="display: inline-block; width: 120px;">Tidal Strength:</span>
                                        <input type="range" id="settingTidalStrength2" min="0.5" max="3.0" step="0.25" value="1.5" style="width: 150px;">
                                        <span id="valueTidalStrength2" style="display: inline-block; width: 40px;">1.5x</span>
                                    </label>

                                    <label title="Consonance attracts, dissonance repels" style="display: block; margin-bottom: 8px;">
                                        <input type="checkbox" id="settingGravityVariant6_2">
                                        <span>Consonance Attraction / Dissonance Repulsion</span>
                                    </label>
                                    <label title="Force magnitude" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                        <span style="display: inline-block; width: 120px;">Force Magnitude:</span>
                                        <input type="range" id="settingAttractionRepulsionForce2" min="0.5" max="3.0" step="0.25" value="2.0" style="width: 150px;">
                                        <span id="valueAttractionRepulsionForce2" style="display: inline-block; width: 40px;">2.0x</span>
                                    </label>

                                </div>
                            </details>

                            </div>
                        </details>

                        <!-- Other Emergent Beat Systems -->
                        <details class="cymatic-setting-group">
                            <summary style="cursor: pointer; font-weight: bold; font-size: 14px; margin-bottom: 12px;">
                                <h4 style="display: inline; font-size: 14px;">‚ö° Other Emergent Beat Systems (Advanced)</h4>
                            </summary>
                            <div style="margin-left: 12px;">

                            <!-- Particle Resonance -->
                            <label title="Particles pushed by waves that collide and resonate at beat frequency" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingParticleResonance2">
                                <span style="font-weight: bold;">Particle Resonance System</span>
                            </label>
                            <label title="Number of particles in the system" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Particle Count:</span>
                                <input type="range" id="settingParticleCount2" min="10" max="100" step="10" value="50" style="width: 150px;">
                                <span id="valueParticleCount2" style="display: inline-block; width: 40px;">50</span>
                            </label>
                            <label title="Size of particles" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Particle Size:</span>
                                <input type="range" id="settingParticleSize2" min="0.5" max="5.0" step="0.5" value="2.0" style="width: 150px;">
                                <span id="valueParticleSize2" style="display: inline-block; width: 40px;">2.0</span>
                            </label>

                            <!-- Energy Transfer Arcs -->
                            <label title="Lightning-like arcs between speakers that pulse at beat frequency" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingEnergyArcs2">
                                <span style="font-weight: bold;">Energy Transfer Arcs</span>
                            </label>
                            <label title="Thickness of energy arcs" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Arc Thickness:</span>
                                <input type="range" id="settingArcThickness2" min="0.5" max="5.0" step="0.5" value="2.0" style="width: 150px;">
                                <span id="valueArcThickness2" style="display: inline-block; width: 40px;">2.0</span>
                            </label>
                            <label title="Number of arc branches" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Branching:</span>
                                <input type="range" id="settingArcBranching2" min="1" max="5" step="1" value="3" style="width: 150px;">
                                <span id="valueArcBranching2" style="display: inline-block; width: 40px;">3</span>
                            </label>
                            <label title="Amplitude of wave oscillation along the arc" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Wave Amplitude:</span>
                                <input type="range" id="settingArcWaveAmplitude2" min="0.0" max="100.0" step="5.0" value="30.0" style="width: 150px;">
                                <span id="valueArcWaveAmplitude2" style="display: inline-block; width: 40px;">30.0</span>
                            </label>

                            <!-- Pressure Wave Atmosphere Variants -->
                            <label title="Canvas breathes like an atmosphere, compressing and expanding with beat" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingPressureWave2">
                                <span style="font-weight: bold;">Pressure Wave Atmosphere</span>
                            </label>
                            <label title="Intensity of pressure breathing effect" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Intensity:</span>
                                <input type="range" id="settingPressureIntensity2" min="0.0" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valuePressureIntensity2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>

                            <h6 style="margin: 12px 0 8px 20px; color: #999; font-size: 0.9em;">Pressure Wave Variants</h6>

                            <!-- Canvas Stretch -->
                            <label title="Canvas stretches and compresses radially, distorting interference pattern" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <input type="checkbox" id="settingCanvasStretch2">
                                <span style="font-weight: bold;">Canvas Stretch</span>
                            </label>
                            <label title="Amount of radial stretching" style="display: block; margin-left: 40px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Stretch Amount:</span>
                                <input type="range" id="settingStretchAmount2" min="0.0" max="0.5" step="0.05" value="0.2" style="width: 150px;">
                                <span id="valueStretchAmount2" style="display: inline-block; width: 40px;">0.2</span>
                            </label>

                            <!-- Drum Membrane Push -->
                            <label title="Canvas acts like drum membrane being pushed, creating z-depth illusion" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <input type="checkbox" id="settingDrumPush2">
                                <span style="font-weight: bold;">Drum Membrane Push</span>
                            </label>
                            <label title="Depth of membrane push" style="display: block; margin-left: 40px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Push Depth:</span>
                                <input type="range" id="settingDrumDepth2" min="0.0" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valueDrumDepth2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>

                            <!-- Gravity Well Variants (other modes) moved to advanced section -->
                            <!-- See "Gravity Well Effects" section above for main controls -->

                            <!-- Lens Refraction -->
                            <label title="Moving lens effects refract and magnify the interference pattern" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <input type="checkbox" id="settingLensRefraction2">
                                <span style="font-weight: bold;">Lens Refraction Swim</span>
                            </label>
                            <label title="Magnitude of lens refraction" style="display: block; margin-left: 40px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Refraction:</span>
                                <input type="range" id="settingRefractionAmount2" min="0.0" max="50.0" step="5.0" value="20.0" style="width: 150px;">
                                <span id="valueRefractionAmount2" style="display: inline-block; width: 40px;">20.0</span>
                            </label>
                            <label title="Size of lens regions" style="display: block; margin-left: 40px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Lens Size:</span>
                                <input type="range" id="settingLensSize2" min="50.0" max="200.0" step="10.0" value="100.0" style="width: 150px;">
                                <span id="valueLensSize2" style="display: inline-block; width: 40px;">100.0</span>
                            </label>

                            <!-- Temporal Phase Shift -->
                            <label title="Different regions show different time slices, creating temporal echoes" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <input type="checkbox" id="settingTemporalShift2">
                                <span style="font-weight: bold;">Temporal Phase Shift</span>
                            </label>
                            <label title="Amount of time offset" style="display: block; margin-left: 40px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Time Offset:</span>
                                <input type="range" id="settingTimeOffset2" min="0.0" max="2.0" step="0.1" value="0.5" style="width: 150px;">
                                <span id="valueTimeOffset2" style="display: inline-block; width: 40px;">0.5</span>
                            </label>
                            <label title="Number of temporal layers" style="display: block; margin-left: 40px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Echo Layers:</span>
                                <input type="range" id="settingTemporalLayers2" min="2" max="8" step="1" value="4" style="width: 150px;">
                                <span id="valueTemporalLayers2" style="display: inline-block; width: 40px;">4</span>
                            </label>

                            <!-- Membrane Tension Ripples -->
                            <label title="Canvas surface ripples like a drum membrane responding to interference" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingMembraneRipples2">
                                <span style="font-weight: bold;">Membrane Tension Ripples</span>
                            </label>
                            <label title="Amplitude of membrane ripple waves" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Ripple Amplitude:</span>
                                <input type="range" id="settingRippleAmplitude2" min="0.0" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valueRippleAmplitude2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>

                            <!-- Harmonic Crystal Growth -->
                            <label title="Crystalline structures grow from speakers, pulsing and branching with beat" style="display: block; margin-bottom: 8px;">
                                <input type="checkbox" id="settingCrystalGrowth2">
                                <span style="font-weight: bold;">Harmonic Crystal Growth</span>
                            </label>
                            <label title="Complexity of crystal branching" style="display: block; margin-left: 20px; margin-bottom: 8px;">
                                <span style="display: inline-block; width: 120px;">Complexity:</span>
                                <input type="range" id="settingCrystalComplexity2" min="1" max="5" step="1" value="3" style="width: 150px;">
                                <span id="valueCrystalComplexity2" style="display: inline-block; width: 40px;">3</span>
                            </label>
                            <label title="Growth speed of crystals" style="display: block; margin-left: 20px; margin-bottom: 12px;">
                                <span style="display: inline-block; width: 120px;">Growth Speed:</span>
                                <input type="range" id="settingCrystalGrowthSpeed2" min="0.0" max="2.0" step="0.1" value="1.0" style="width: 150px;">
                                <span id="valueCrystalGrowthSpeed2" style="display: inline-block; width: 40px;">1.0x</span>
                            </label>

                            </div>
                        </details>

                        <!-- Remaining Beat Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Additional Beat Settings</h4>

                            <label title="Pulse brightness at interference zone at the beat frequency - creates visible pulsing glow">
                                <input type="checkbox" id="settingShowBeatBrightness2">
                                <span>Beat Brightness Pulsing</span>
                            </label>
                            <label title="Intensity of the brightness pulsing effect">
                                <span>Brightness Intensity:</span>
                                <input type="range" id="settingBeatBrightnessIntensity2" min="0.1" max="5.0" step="0.1" value="0.0">
                                <span id="valueBeatBrightnessIntensity2">0.0x</span>
                            </label>
                            <label title="Synchronize boundary circles to pulse in/out together at beat frequency - visualizes beating as expanding/contracting fields">
                                <input type="checkbox" id="settingShowBeatBoundary2">
                                <span>Beat Boundary Pulsing</span>
                            </label>
                            <label title="Amount boundaries expand/contract (percentage of radius)">
                                <span>Boundary Pulse Amount:</span>
                                <input type="range" id="settingBeatBoundaryAmount2" min="5" max="100" step="5" value="30">
                                <span id="valueBeatBoundaryAmount2">30%</span>
                            </label>

                            <hr style="margin: 12px 0; border: none; border-top: 1px solid #333;">
                            <p style="font-size: 0.9rem; color: #888; margin: 8px 0;">Standalone Visualizations (visible even without interference pattern)</p>

                            <label title="Show pulsing circle at interference point">
                                <input type="checkbox" id="settingShowBeatCircle2">
                                <span>Beat Circle</span>
                            </label>
                            <label title="Base size of beat circle">
                                <span>Circle Size:</span>
                                <input type="range" id="settingBeatCircleSize2" min="20" max="100" step="5" value="50">
                                <span id="valueBeatCircleSize2">50px</span>
                            </label>

                            <label title="Show visual metronome indicator">
                                <input type="checkbox" id="settingShowBeatMetronome2">
                                <span>Beat Metronome</span>
                            </label>
                            <label title="Size of metronome dot">
                                <span>Metronome Size:</span>
                                <input type="range" id="settingBeatMetronomeSize2" min="15" max="50" step="5" value="30">
                                <span id="valueBeatMetronomeSize2">30px</span>
                            </label>

                            <label title="Show waveform displaying beat amplitude">
                                <input type="checkbox" id="settingShowBeatWaveform2">
                                <span>Beat Waveform</span>
                            </label>
                            <label title="Height of waveform display">
                                <span>Waveform Height:</span>
                                <input type="range" id="settingBeatWaveformHeight2" min="50" max="200" step="10" value="100">
                                <span id="valueBeatWaveformHeight2">100px</span>
                            </label>

                            <label title="Show radiating pulses from interference point">
                                <input type="checkbox" id="settingShowBeatPulses2">
                                <span>Beat Pulses</span>
                            </label>
                            <label title="Interval between pulses">
                                <span>Pulse Interval:</span>
                                <input type="range" id="settingBeatPulseInterval2" min="100" max="2000" step="100" value="500">
                                <span id="valueBeatPulseInterval2">500ms</span>
                            </label>
                        </div>

                        <!-- Color Settings -->
                        <div class="cymatic-setting-group">
                            <h4>Colors & Theme</h4>
                            <label title="Color tones by their harmonic interval - blue for consonance (unison, 5ths), red for dissonance (tritones, 2nds)">
                                <input type="checkbox" id="settingUseIntervalColors2" checked>
                                <span>Use Interval-Based Colors</span>
                            </label>

                            <hr style="margin: 12px 0; border: none; border-top: 1px solid #333;">

                            <label title="Color for Tone 1 (root tone)">
                                <span>Tone 1 Color:</span>
                                <input type="color" id="settingTone1Color2" value="#00ffff" style="width: 60px; height: 30px; border: none; cursor: pointer;">
                            </label>

                            <label title="Color for Tone 2 (interval tone)">
                                <span>Tone 2 Color:</span>
                                <input type="color" id="settingTone2Color2" value="#ffff00" style="width: 60px; height: 30px; border: none; cursor: pointer;">
                            </label>

                            <label title="Color for intersection/overlap region">
                                <span>Intersection Color:</span>
                                <input type="color" id="settingIntersectionColor2" value="#ff00ff" style="width: 60px; height: 30px; border: none; cursor: pointer;">
                            </label>

                            <hr style="margin: 12px 0; border: none; border-top: 1px solid #333;">

                            <label title="Color intensity for root tone when playing alone">
                                <span>Root Tone Intensity:</span>
                                <input type="range" id="settingRootIntensity2" min="0.3" max="1.0" step="0.05" value="0.6">
                                <span id="valueRootIntensity2">60%</span>
                            </label>

                            <label title="Color intensity for interval tone when playing alone">
                                <span>Interval Tone Intensity:</span>
                                <input type="range" id="settingIntervalIntensity2" min="0.2" max="0.8" step="0.05" value="0.35">
                                <span id="valueIntervalIntensity2">35%</span>
                            </label>

                            <label title="Base color intensity for intersection region">
                                <span>Intersection Intensity:</span>
                                <input type="range" id="settingIntersectionIntensity2" min="0.2" max="0.8" step="0.05" value="0.4">
                                <span id="valueIntersectionIntensity2">40%</span>
                            </label>
                        </div>
                    </div>
                </details>
            </section>
        </main>
    </div>


    <!-- Unison Overview Exercise -->
    <div id="unisonOverviewExercise" class="container exercise-container" style="display: none;">
        <header>
            <button class="back-btn" aria-label="Back" data-unison="exit">‚Üê Back</button>
            <div class="header-center">
                <h1>Unison Overview</h1>
            </div>
        </header>

        <main>
            <!-- Tutorial Panel -->
            <div class="tutorial-panel card" data-tutorial="panel" style="display: none;">
                <div class="tutorial-text" data-tutorial="text">
                    <!-- Tutorial text injected here -->
                </div>
                <div class="tutorial-nav">
                    <button class="btn-control" data-tutorial="prev">‚Üê</button>
                    <span data-tutorial="progress">1 / 3</span>
                    <button class="btn-control" data-tutorial="next">‚Üí</button>
                </div>
            </div>

            <!-- Visualization Panels -->
            <div class="claude-viz-panels">
                <div class="claude-panel" data-unison-panel="interference" data-tutorial-target="interferencePanel">
                    <h3 class="panel-title">Interference Pattern <span class="panel-hz-labels" data-unison="interference-hz-labels"></span></h3>
                    <div class="claude-canvas-container">
                        <canvas data-unison="interference-canvas"></canvas>
                    </div>
                </div>

                <div class="claude-panel" data-unison-panel="wave" data-tutorial-target="wavePanel">
                    <div class="claude-canvas-container">
                        <canvas data-unison="wave-canvas"></canvas>
                        <div class="wave-flash-overlay wave-flash-left" data-tutorial-target="waveFlashLeft"></div>
                        <div class="wave-flash-overlay wave-flash-right" data-tutorial-target="waveFlashRight"></div>
                    </div>
                </div>
            </div>

            <!-- Advanced Controls -->
            <div class="advanced-controls card" data-tutorial-target="advancedControls">
                <h3 style="margin: 0 0 16px 0; color: rgba(0, 255, 136, 0.95);">Advanced Controls</h3>

                <!-- Primary Actions -->
                <div class="claude-primary-actions">
                    <button data-unison="play-both" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        ‚ñ∂ Play Both
                    </button>
                    <button data-unison="randomize" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        üé≤ Randomize
                    </button>
                </div>

                <!-- Tone Controls -->
                <div class="claude-tone-controls">
                    <div class="claude-tone-group">
                        <label class="control-label">Tone 1 (Hz)</label>
                        <input type="range" data-unison="tone1-slider" class="slider" min="20" max="2000" value="440" step="1">
                        <input type="number" data-unison="tone1-input" class="number-input" min="20" max="2000" value="440" step="0.1">
                    </div>
                    <div class="claude-tone-group">
                        <label class="control-label">Tone 2 (Hz)</label>
                        <input type="range" data-unison="tone2-slider" class="slider" min="20" max="2000" value="660" step="1">
                        <input type="number" data-unison="tone2-input" class="number-input" min="20" max="2000" value="660" step="0.1">
                    </div>
                </div>

                <!-- Solfege Selection -->
                <div class="claude-solfege">
                    <label class="control-label">Interval Presets:</label>
                    <div class="solfege-buttons">
                        <button data-unison-solfege="unison" class="btn-solfege no-sound" title="Unison">Unison</button>
                        <button data-unison-solfege="minor-second" class="btn-solfege no-sound" title="Minor 2nd">m2</button>
                        <button data-unison-solfege="major-second" class="btn-solfege no-sound" title="Major 2nd">M2</button>
                        <button data-unison-solfege="minor-third" class="btn-solfege no-sound" title="Minor 3rd">m3</button>
                        <button data-unison-solfege="major-third" class="btn-solfege no-sound" title="Major 3rd">M3</button>
                        <button data-unison-solfege="fourth" class="btn-solfege no-sound" title="Perfect 4th">P4</button>
                        <button data-unison-solfege="tritone" class="btn-solfege no-sound" title="Tritone">TT</button>
                        <button data-unison-solfege="fifth" class="btn-solfege no-sound" title="Perfect 5th">P5</button>
                        <button data-unison-solfege="minor-sixth" class="btn-solfege no-sound" title="Minor 6th">m6</button>
                        <button data-unison-solfege="major-sixth" class="btn-solfege no-sound" title="Major 6th">M6</button>
                        <button data-unison-solfege="minor-seventh" class="btn-solfege no-sound" title="Minor 7th">m7</button>
                        <button data-unison-solfege="major-seventh" class="btn-solfege no-sound" title="Major 7th">M7</button>
                        <button data-unison-solfege="octave" class="btn-solfege no-sound" title="Octave">Octave</button>
                    </div>
                </div>

                <!-- Visualization Selection -->
                <div class="claude-view-toggles" data-tutorial-target="vizSelection">
                    <label class="control-label">Active Visualization:</label>
                    <div class="viz-selection-options">
                        <label class="radio-label">
                            <input type="radio" name="unisonVizSelection" data-viz-select="none" checked>
                            <span>None</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="unisonVizSelection" data-viz-select="interference">
                            <span>Interference</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="unisonVizSelection" data-viz-select="wave">
                            <span>Wave</span>
                        </label>
                    </div>
                </div>

                <!-- Wave-Specific Controls -->
                <div class="claude-wave-settings" data-unison="wave-settings-panel">
                    <label class="control-label">Wave View Mode:</label>
                    <div class="wave-mode-options">
                        <label class="radio-label">
                            <input type="radio" name="unisonWaveMode" data-unison="wave-mode" value="side-by-side" checked>
                            <span>Side-by-Side</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="unisonWaveMode" data-unison="wave-mode" value="overlay">
                            <span>Overlay</span>
                        </label>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- General Interval Overview Exercise -->
    <div id="generalIntervalOverviewExercise" class="container exercise-container" style="display: none;">
        <header>
            <button class="back-btn" aria-label="Back" data-interval="exit">‚Üê Back</button>
            <div class="header-center">
                <h1 data-interval="title">Interval Overview</h1>
                <p class="subtitle" data-interval="subtitle"></p>
            </div>
        </header>

        <main>
            <!-- Tutorial Panel -->
            <div class="tutorial-panel card" data-tutorial="panel" style="display: none;">
                <div class="tutorial-text" data-tutorial="text">
                    <!-- Tutorial text injected here -->
                </div>
                <div class="tutorial-nav">
                    <button class="btn-control" data-tutorial="prev">‚Üê</button>
                    <span data-tutorial="progress">1 / 26</span>
                    <button class="btn-control" data-tutorial="next">‚Üí</button>
                </div>
            </div>

            <!-- Visualization Panels -->
            <div class="claude-viz-panels">
                <div class="claude-panel" data-interval-panel="interference" data-tutorial-target="interferencePanel">
                    <h3 class="panel-title">Interference Pattern <span class="panel-hz-labels" data-interval="interference-hz-labels"></span></h3>
                    <div class="claude-canvas-container">
                        <canvas data-interval="interference-canvas"></canvas>
                    </div>
                </div>

                <div class="claude-panel" data-interval-panel="wave" data-tutorial-target="wavePanel">
                    <div class="claude-canvas-container">
                        <canvas data-interval="wave-canvas"></canvas>
                        <div class="wave-flash-overlay wave-flash-left" data-tutorial-target="waveFlashLeft"></div>
                        <div class="wave-flash-overlay wave-flash-right" data-tutorial-target="waveFlashRight"></div>
                    </div>
                </div>
            </div>

            <!-- Advanced Controls (formerly main controls, now at bottom) -->
            <div class="advanced-controls card" data-tutorial-target="advancedControls">
                <h3 style="margin: 0 0 16px 0; color: rgba(0, 255, 136, 0.95);">Advanced Controls</h3>

                <!-- Primary Actions -->
                <div class="claude-primary-actions">
                    <button data-interval="play-both" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        ‚ñ∂ Play Both
                    </button>
                    <button data-interval="randomize" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        üé≤ Randomize
                    </button>
                </div>

                <!-- Tone Controls -->
                <div class="claude-tone-controls">
                    <div class="claude-tone-group">
                        <label class="control-label">Tone 1 (Hz)</label>
                        <input type="range" data-interval="tone1-slider" class="slider" min="20" max="2000" value="440" step="1">
                        <input type="number" data-interval="tone1-input" class="number-input" min="20" max="2000" value="440" step="0.1">
                    </div>
                    <div class="claude-tone-group">
                        <label class="control-label">Tone 2 (Hz)</label>
                        <input type="range" data-interval="tone2-slider" class="slider" min="20" max="2000" value="660" step="1">
                        <input type="number" data-interval="tone2-input" class="number-input" min="20" max="2000" value="660" step="0.1">
                    </div>
                </div>

                <!-- Solfege Selection -->
                <div class="claude-solfege">
                    <label class="control-label">Interval Presets:</label>
                    <div class="solfege-buttons">
                        <button data-interval-solfege="unison" class="btn-solfege no-sound" title="Unison">Unison</button>
                        <button data-interval-solfege="minor-second" class="btn-solfege no-sound" title="Minor 2nd">m2</button>
                        <button data-interval-solfege="major-second" class="btn-solfege no-sound" title="Major 2nd">M2</button>
                        <button data-interval-solfege="minor-third" class="btn-solfege no-sound" title="Minor 3rd">m3</button>
                        <button data-interval-solfege="major-third" class="btn-solfege no-sound" title="Major 3rd">M3</button>
                        <button data-interval-solfege="fourth" class="btn-solfege no-sound" title="Perfect 4th">P4</button>
                        <button data-interval-solfege="tritone" class="btn-solfege no-sound" title="Tritone">TT</button>
                        <button data-interval-solfege="fifth" class="btn-solfege no-sound" title="Perfect 5th">P5</button>
                        <button data-interval-solfege="minor-sixth" class="btn-solfege no-sound" title="Minor 6th">m6</button>
                        <button data-interval-solfege="major-sixth" class="btn-solfege no-sound" title="Major 6th">M6</button>
                        <button data-interval-solfege="minor-seventh" class="btn-solfege no-sound" title="Minor 7th">m7</button>
                        <button data-interval-solfege="major-seventh" class="btn-solfege no-sound" title="Major 7th">M7</button>
                        <button data-interval-solfege="octave" class="btn-solfege no-sound" title="Octave">Octave</button>
                    </div>
                </div>

                <!-- Visualization Selection -->
                <div class="claude-view-toggles" data-tutorial-target="vizSelection">
                    <label class="control-label">Active Visualization:</label>
                    <div class="viz-selection-options">
                        <label class="radio-label">
                            <input type="radio" name="vizSelection" data-viz-select="none" checked>
                            <span>None</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="vizSelection" data-viz-select="interference">
                            <span>Interference</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="vizSelection" data-viz-select="wave">
                            <span>Wave</span>
                        </label>
                    </div>
                </div>

                <!-- Wave-Specific Controls -->
                <div class="claude-wave-settings" data-interval="wave-settings-panel">
                    <label class="control-label">Wave View Mode:</label>
                    <div class="wave-mode-options">
                        <label class="radio-label">
                            <input type="radio" name="waveMode" data-interval="wave-mode" value="side-by-side" checked>
                            <span>Side-by-Side</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="waveMode" data-interval="wave-mode" value="overlay">
                            <span>Overlay</span>
                        </label>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Interference Visualization Exercise -->
    <div id="interferenceVizExercise" class="container exercise-container" style="display: none;" data-interference="exercise">
        <header>
            <button id="interferenceVizExitBtn" class="back-btn" aria-label="Back" data-interference="exit">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Interference Visualization</p>
            </div>
        </header>
        <main>
            <section class="card">
                <!-- Canvas container -->
                <div style="position: relative; width: 100%; height: 600px; background: #0a0a14; border-radius: 8px;">
                    <canvas id="interferenceVizCanvasWebGL" data-interference="canvas" style="position: absolute; top: 0; left: 0; display: block;"></canvas>
                </div>

                <!-- Main Controls -->
                <div style="margin-top: 20px; display: grid; gap: 20px;">
                    <!-- Primary Actions -->
                    <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                        <button id="interferenceVizPlayBothBtn" data-interference="play-both" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            ‚ñ∂Ô∏è Play Both
                        </button>
                        <button id="interferenceVizRandomizeBtn" data-interference="randomize" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            üé≤ Randomize & Play
                        </button>
                    </div>

                    <!-- Individual Tone Controls -->
                    <details open style="border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 16px;">
                        <summary style="cursor: pointer; font-weight: bold; font-size: 16px; margin-bottom: 12px;">üéµ Individual Tone Controls</summary>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 12px;">
                            <!-- Tone 1 -->
                            <div style="padding: 12px; background: rgba(0, 255, 255, 0.05); border-radius: 8px; border: 1px solid rgba(0, 255, 255, 0.2);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <h3 style="margin: 0; color: #00ffff;">Tone 1 (Root)</h3>
                                    <button id="interferenceVizPlayTone1Btn" data-interference="play-tone1" class="btn-control" style="padding: 6px 16px;">Play</button>
                                </div>
                                <div class="frequency-controls">
                                    <input type="range" id="interferenceVizTone1Freq" data-interference="tone1-slider" min="27" max="4186" value="440" step="0.01" style="width: 100%;">
                                    <input type="number" id="interferenceVizTone1FreqNum" data-interference="tone1-input" min="27" max="4186" value="440.00" step="0.01" style="width: 100%; margin-top: 8px;">
                                </div>
                            </div>

                            <!-- Tone 2 -->
                            <div style="padding: 12px; background: rgba(255, 0, 255, 0.05); border-radius: 8px; border: 1px solid rgba(255, 0, 255, 0.2);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <h3 style="margin: 0; color: #ff00ff;">Tone 2 (Interval)</h3>
                                    <button id="interferenceVizPlayTone2Btn" data-interference="play-tone2" class="btn-control" style="padding: 6px 16px;">Play</button>
                                </div>
                                <div class="frequency-controls">
                                    <input type="range" id="interferenceVizTone2Freq" data-interference="tone2-slider" min="27" max="4186" value="440" step="0.01" style="width: 100%;">
                                    <input type="number" id="interferenceVizTone2FreqNum" data-interference="tone2-input" min="27" max="4186" value="440.00" step="0.01" style="width: 100%; margin-top: 8px;">
                                </div>
                            </div>
                        </div>

                        <!-- Solfege Scale Buttons (2 octaves from Do = Tone 1) -->
                        <div style="margin-top: 16px; padding: 12px; background: rgba(255, 255, 255, 0.02); border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="display: flex; flex-wrap: wrap; gap: 6px; justify-content: center;">
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="0" style="padding: 8px 12px;">Do</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="2" style="padding: 8px 12px;">Re</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="4" style="padding: 8px 12px;">Mi</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="5" style="padding: 8px 12px;">Fa</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="7" style="padding: 8px 12px;">Sol</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="9" style="padding: 8px 12px;">La</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="11" style="padding: 8px 12px;">Ti</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="12" style="padding: 8px 12px;">Do¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="14" style="padding: 8px 12px;">Re¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="16" style="padding: 8px 12px;">Mi¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="17" style="padding: 8px 12px;">Fa¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="19" style="padding: 8px 12px;">Sol¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="21" style="padding: 8px 12px;">La¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="23" style="padding: 8px 12px;">Ti¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="24" style="padding: 8px 12px;">Do¬≥</button>
                            </div>
                        </div>
                    </details>
                </div>

                <!-- Settings -->
                <details open style="margin-top: 20px;">
                    <summary style="display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0;">Settings</h3>
                        <div style="display: flex; gap: 8px;">
                            <button id="interferenceVizColorSpectrumBtn" data-interference="color-spectrum" class="btn-control" style="padding: 4px 12px; font-size: 12px;">üåà Color Spectrum</button>
                            <button id="interferenceVizPianoSpectrumBtn" data-interference="piano-spectrum" class="btn-control" style="padding: 4px 12px; font-size: 12px;">üéπ Piano Spectrum</button>
                            <button id="interferenceVizCopySettingsBtn" data-interference="copy-settings" class="btn-control" style="padding: 4px 12px; font-size: 12px;">üìã Copy Settings</button>
                        </div>
                    </summary>
                    <div class="settings-panel">
                        <!-- Note: Most WebGL visualization settings are managed programmatically -->
                        <!-- See lib/harmonicRendererSettings.js for configuration -->
                        
                        <div class="cymatic-setting-group">
                            <h4>‚ÑπÔ∏è About the Visualization</h4>
                            <p style="color: #aaa; font-size: 13px; line-height: 1.6;">
                                This visualization uses WebGL to display harmonic interference patterns between two tones.
                                The patterns are dynamically colored based on the consonance/dissonance of the interval.
                            </p>
                            <p style="color: #aaa; font-size: 13px; line-height: 1.6; margin-top: 12px;">
                                <strong>Features:</strong><br>
                                ‚Ä¢ Gravity wells that pulse with beat frequency<br>
                                ‚Ä¢ Consonant intervals (unison, 5th, octave) ‚Üí Cyan/Blue<br>
                                ‚Ä¢ Dissonant intervals (tritone, minor 2nd) ‚Üí Red/Orange<br>
                                ‚Ä¢ Real-time audio-visual synchronization
                            </p>
                        </div>

                        <div class="cymatic-setting-group">
                            <h4>üéπ Quick Intervals</h4>
                            <p style="color: #888; font-size: 12px; margin-bottom: 12px;">Click to hear common intervals:</p>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                                <button class="solfege-btn" data-interference-solfege data-interval="0" style="padding: 8px; font-size: 12px;">Unison</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="2" style="padding: 8px; font-size: 12px;">Major 2nd</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="4" style="padding: 8px; font-size: 12px;">Major 3rd</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="5" style="padding: 8px; font-size: 12px;">Perfect 4th</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="7" style="padding: 8px; font-size: 12px;">Perfect 5th</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="9" style="padding: 8px; font-size: 12px;">Major 6th</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="11" style="padding: 8px; font-size: 12px;">Major 7th</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="12" style="padding: 8px; font-size: 12px;">Octave</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="6" style="padding: 8px; font-size: 12px;">Tritone</button>
                            </div>
                        </div>
                    </div>
                </details>
            </section>
        </main>
    </div>

    <!-- Color Spectrum Modal -->
    <div id="colorSpectrumModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10000; padding: 20px; overflow: auto;">
        <div style="max-width: 1200px; margin: 0 auto; background: #1a1a2e; border-radius: 12px; padding: 30px; position: relative;">
            <button id="colorSpectrumCloseBtn" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.1); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>

            <h2 style="margin: 0 0 20px 0; color: white;">üåà Color Spectrum</h2>
            <p style="color: #aaa; margin-bottom: 30px;">Piano range (A0 27.5 Hz to C8 4186 Hz) showing how colors change with frequency intervals</p>

            <div style="display: flex; gap: 20px; align-items: stretch;">
                <!-- Frequency Labels (vertical, bottom to top) -->
                <div id="colorSpectrumLabels" style="display: flex; flex-direction: column-reverse; justify-content: space-between; min-width: 80px; font-size: 12px; color: #aaa; padding: 10px 0;">
                </div>

                <!-- Root Color Bar -->
                <div style="display: flex; flex-direction: column;">
                    <div style="text-align: center; margin-bottom: 10px; color: white; font-weight: bold; font-size: 14px;">Root</div>
                    <div id="colorSpectrumRootBar" style="width: 60px; flex: 1; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5);"></div>
                </div>

                <!-- Piano Coloring Spectrum -->
                <div style="display: flex; flex-direction: column;">
                    <div style="text-align: center; margin-bottom: 10px; color: white; font-weight: bold; font-size: 14px;">Piano Coloring</div>
                    <canvas id="colorSpectrumPianoCanvas" style="width: 80px; height: 600px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5);"></canvas>
                </div>

                <!-- Continuous Gradient Spectrum -->
                <div style="display: flex; flex-direction: column; flex: 1;">
                    <div style="text-align: center; margin-bottom: 10px; color: white; font-weight: bold; font-size: 14px;">Continuous Gradient</div>
                    <canvas id="colorSpectrumCanvas" style="width: 100%; height: 600px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5);"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Piano Spectrum Modal -->
    <div id="pianoSpectrumModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10000; padding: 20px; overflow: auto;">
        <div style="max-width: 1400px; margin: 0 auto; background: #1a1a2e; border-radius: 12px; padding: 30px; position: relative;">
            <button id="pianoSpectrumCloseBtn" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.1); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>

            <h2 style="margin: 0 0 20px 0; color: white;">üéπ Piano Spectrum (C as Root)</h2>
            <p style="color: #aaa; margin-bottom: 30px;">Full 88-key piano keyboard showing interval colors relative to C</p>

            <canvas id="pianoSpectrumCanvas" style="width: 100%; height: 300px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5); background: #0a0a0a;"></canvas>
        </div>
    </div>

    <!-- Wave Visualization Exercise -->
    <div id="waveVisualizationExercise" class="container exercise-container" data-wave-viz="exercise" style="display: none;">
        <header>
            <button id="waveVizExitBtn" data-wave-viz="exit" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Wave Visualization</p>
            </div>
        </header>
        <main>
            <section class="card">
                <div class="wave-viz-frame">
                    <div class="wave-viz-frame-inner">
                        <canvas id="waveVizCanvas" data-wave-viz="canvas" width="1200" height="420"></canvas>
                    </div>
                </div>

                <div class="wave-viz-controls">
                    <div class="wave-viz-primary-actions">
                        <button id="waveVizPlayBothBtn" data-wave-viz="play-both" class="btn-control wave-viz-primary-btn">
                            ‚ñ∂Ô∏è Play Both
                        </button>
                        <button id="waveVizRandomizeBtn" data-wave-viz="randomize" class="btn-control wave-viz-primary-btn wave-viz-random">
                            üé≤ Randomize & Play
                        </button>
                    </div>

                    <div class="wave-viz-toggle-group">
                        <span class="wave-viz-toggle-label">View Mode:</span>
                        <label class="wave-viz-toggle-option">
                            <input type="radio" name="waveVizViewMode" value="side-by-side" id="waveVizViewSideBySide" data-wave-viz="view-side" checked>
                            <span>Split View</span>
                        </label>
                        <label class="wave-viz-toggle-option">
                            <input type="radio" name="waveVizViewMode" value="overlay" id="waveVizViewOverlay" data-wave-viz="view-overlay">
                            <span>Overlay</span>
                        </label>
                    </div>

                    <details class="wave-viz-tone-panel" open>
                        <summary>üéõÔ∏è Tone Controls</summary>
                        <div class="wave-viz-tone-grid">
                            <div class="wave-viz-tone-card wave-viz-tone-root">
                                <div class="wave-viz-tone-header">
                                    <h3>Tone 1 ¬∑ Root</h3>
                                    <button id="waveVizPlayTone1Btn" data-wave-viz="play-tone1" class="btn-control">Play</button>
                                </div>
                                <label class="wave-viz-slider-label" for="waveVizTone1Freq">Frequency</label>
                                <input type="range" id="waveVizTone1Freq" data-wave-viz="tone1-slider" min="27" max="4186" value="440" step="0.01">
                                <input type="number" id="waveVizTone1FreqNum" data-wave-viz="tone1-input" min="27" max="4186" value="440.00" step="0.01">
                            </div>
                            <div class="wave-viz-tone-card wave-viz-tone-interval">
                                <div class="wave-viz-tone-header">
                                    <h3>Tone 2 ¬∑ Interval</h3>
                                    <button id="waveVizPlayTone2Btn" data-wave-viz="play-tone2" class="btn-control">Play</button>
                                </div>
                                <label class="wave-viz-slider-label" for="waveVizTone2Freq">Frequency</label>
                                <input type="range" id="waveVizTone2Freq" data-wave-viz="tone2-slider" min="27" max="4186" value="440" step="0.01">
                                <input type="number" id="waveVizTone2FreqNum" data-wave-viz="tone2-input" min="27" max="4186" value="440.00" step="0.01">
                            </div>
                        </div>
                    </details>

                    <div class="wave-viz-solfege">
                        <span class="wave-viz-solfege-label">Intervals:</span>
                        <div class="wave-viz-solfege-buttons">
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="0">Do</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="1">Di</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="2">Re</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="3">Ri</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="4">Mi</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="5">Fa</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="6">Fi</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="7">So</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="8">Si</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="9">La</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="10">Li</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="11">Ti</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="12">Do‚Üë</button>
                        </div>
                    </div>

                    <div class="wave-viz-meta">
                        <div class="wave-viz-meta-item">
                            <span class="wave-viz-meta-label">Root:</span>
                            <span id="waveVizTone1Label" data-wave-viz="tone1-label" class="wave-viz-meta-value">A4 ¬∑ 440 Hz</span>
                        </div>
                        <div class="wave-viz-meta-item">
                            <span class="wave-viz-meta-label">Interval:</span>
                            <span id="waveVizTone2Label" data-wave-viz="tone2-label" class="wave-viz-meta-value">A4 ¬∑ 440 Hz</span>
                        </div>
                        <div class="wave-viz-meta-item">
                            <span class="wave-viz-meta-label">Difference:</span>
                            <span id="waveVizDifferenceLabel" data-wave-viz="difference-label" class="wave-viz-meta-value">0 cents</span>
                        </div>
                    </div>

                    <p class="wave-viz-note">
                        Overlapping waves glow brighter using the Interference Visualization color spectrum. Split View stacks Root and Interval, while Overlay blends them for interference highlights.
                    </p>
                </div>
            </section>
        </main>
    </div>

    <!-- Ear Training Overview Tutorial -->
    <div id="earTrainingOverviewExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="earTrainingOverviewExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>Ear Training Overview</h1>
            </div>
        </header>
        <main>
            <!-- Tutorial Panel -->
            <div class="tutorial-panel card">
                <div class="tutorial-text">
                    <h2 id="earTrainingOverviewTitle" style="margin: 0 0 12px 0; color: rgba(0, 255, 136, 0.95); font-size: 1.5rem;">Welcome to Ear Training!</h2>
                    <div id="earTrainingOverviewContent" style="color: rgba(255, 255, 255, 0.9); line-height: 1.6;">
                        PLACEHOLDER: Introduction to ear training and why it's important for musicians.
                    </div>
                </div>
                <div class="tutorial-nav">
                    <button id="earTrainingOverviewPrevBtn" class="btn-control" style="display: none;">‚Üê</button>
                    <span id="earTrainingOverviewStepIndicator">1 / 5</span>
                    <button id="earTrainingOverviewNextBtn" class="btn-control">‚Üí</button>
                </div>

                <!-- Final buttons (shown on last step) -->
                <div id="earTrainingOverviewFinalButtons" class="tutorial-nav" style="display: none;">
                    <button id="earTrainingOverviewMainMenuBtn" class="btn-control">Main Menu</button>
                    <button id="earTrainingOverviewContinueBtn" class="btn-control">Continue ‚Üí</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Overview Exercise -->
    <div id="overviewExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="overviewExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Overview</p>
            </div>
            <button id="audioSettingsBtnOverview" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>
        <main>
            <section class="card tutorial-main">
                <!-- Step Indicator -->
                <div class="tutorial-step-indicator">
                    <span id="overviewStepIndicator">1 / 4</span>
                </div>

                <!-- Content Area -->
                <div class="tutorial-content-area">
                    <h2 id="overviewTitle" class="tutorial-title">Exercise Types</h2>
                    <p id="overviewContent" class="tutorial-content">
                        PLACEHOLDER: Overview of the different exercise types.
                    </p>

                    <!-- Settings Panel -->
                    <details class="overview-settings-panel">
                        <summary class="overview-settings-header">‚öôÔ∏è Tutorial Settings</summary>
                        <div class="overview-settings-content">
                            <label>
                                <input type="checkbox" id="overviewAutoAdvance">
                                <span>Auto-advance to next step (3 seconds)</span>
                            </label>
                            <label>
                                <input type="checkbox" id="overviewShowProgress" checked>
                                <span>Show progress indicator</span>
                            </label>
                            <label>
                                <input type="checkbox" id="overviewCompactMode">
                                <span>Compact mode</span>
                            </label>
                        </div>
                    </details>
                </div>

                <!-- Navigation Buttons -->
                <div class="tutorial-navigation">
                    <button id="overviewPrevBtn" class="btn-tutorial btn-secondary" style="display: none;">
                        <div class="btn-content">
                            <div class="btn-text">‚Üê Previous</div>
                        </div>
                    </button>

                    <button id="overviewNextBtn" class="btn-tutorial btn-next">
                        <div class="btn-content">
                            <div class="btn-text">Next ‚Üí</div>
                        </div>
                    </button>

                    <!-- Final buttons (shown on last step) -->
                    <div id="overviewFinalButtons" class="tutorial-final-buttons" style="display: none;">
                        <button id="overviewMainMenuBtn" class="btn-tutorial btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Main Menu</div>
                            </div>
                        </button>
                        <button id="overviewContinueBtn" class="btn-tutorial btn-next">
                            <div class="btn-content">
                                <div class="btn-text">Continue ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Scale Darts Exercise -->
    <div id="scaleDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="scaleDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Scale Darts</p>
            </div>
            <button id="audioSettingsBtnScaleDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>
        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="scaleDartsRounds" class="dart-corner-value">0</div>
                </div>
                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="scaleDartsScore" class="dart-corner-value">0</div>
                </div>
                <!-- Target Indicator - Center Top -->
                <div class="dart-target-indicator">
                    <div id="scaleDartsTarget" class="dart-target-text">Target: Re</div>
                </div>
                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="scaleDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>
                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>
                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>
                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="scaleDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="scaleDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Audio System -->
    <script src="audioManager.js"></script>

    <!-- Pitchy library (for alternative pitch detection) - bundled locally -->
    <script src="pitchy.bundle.js?v=1759963744"></script>

    <!-- Pitch Detectors (v2 = custom, pitchy = library-based) -->
    <script src="pitchDetector.v2.js?v=1759963744"></script>
    <script src="pitchDetector.pitchy.js?v=1759963744"></script>
    <script src="pitchDetectorConfig.js?v=1759963744"></script>

    <script src="toneGenerator.v2.js"></script>
    <script src="settings.js"></script>
    <script src="tipsAndTricks.js"></script>
    <script src="debugMode.js"></script>
    <script src="audioSettings.js"></script>
    <script src="setup.js"></script>
    <script src="glissandoExercise.js"></script>
    <script src="intonationExercise.js"></script>
    <script src="pitchHoldExercise.js"></script>
    <script src="octaveExercise.js"></script>
    <script src="scaleExercise.js"></script>
    <script src="toneDartsExercise.js"></script>
    <script src="audioDiagnostics.js"></script>
    <script src="exerciseInstructions.js"></script>
    <script src="feelTheRootExercise.js"></script>
    <script src="intervalSlideExercise.js"></script>
    <script src="intervalDartsExercise.js"></script>
    <script src="scaleDartsExercise.js"></script>
    <script src="earTrainingOverview.js"></script>
    <script src="overviewExercise.js"></script>
    <script src="pitchVisualization.js"></script>
    <script src="tuningForkViz.js"></script>
    <script src="cymaticViz.js"></script>
    <script src="cymaticHarmonicViz.js"></script>
    <script src="cymaticHarmonicVizWebGL.js"></script>
    <!-- Interference Visualization Modules -->
    <script src="lib/consonanceColorSystem.js?v=1"></script>
    <script src="lib/speakerOverlayRenderer.js?v=6"></script>
    <script src="lib/dualToneAudioController.js?v=1"></script>
    <script src="lib/harmonicRendererSettings.js?v=3"></script>
    <script src="waveVisualization.js?v=1"></script>
    <script src="interferenceVisualization.js?v=24"></script>
    <script src="intervalOverviewTutorial.js?v=1"></script>
    <script src="unisonOverviewTutorial.js?v=1"></script>
    <script src="tutorialController.js?v=1"></script>
    <script src="intervalOverview.js?v=2"></script>
    <script src="unisonOverview.js?v=1"></script>
    <script src="intervalConfigs.js?v=1"></script>
    <script src="intervalOverviewTutorialTemplate.js?v=1"></script>
    <script src="generalIntervalOverview.js?v=1"></script>
    <script src="app.js"></script>
    <script>
        // Global button click sound
        const buttonClickGenerator = new ToneGenerator();

        document.addEventListener('DOMContentLoaded', () => {
            // Add click sound to all buttons
            document.addEventListener('click', (e) => {
                const button = e.target.closest('button');
                if (button && !button.disabled) {
                    // Check if we're in the interval overview
                    const overviewExercise = document.getElementById('intervalOverviewExercise');
                    if (overviewExercise && overviewExercise.style.display !== 'none') {
                        const intervalOverviewInstance = window.intervalOverviewInstance;
                        if (intervalOverviewInstance && intervalOverviewInstance.audioController) {
                            // Comprehensive check: never play button sound if ANY tone is playing
                            const checkAndPlay = () => {
                                // Check immediately
                                const stateNow = intervalOverviewInstance.audioController.getState();
                                if (stateNow.isPlayingTone1 || stateNow.isPlayingTone2) {
                                    return; // Tones playing, no sound
                                }

                                // Check after 50ms (for buttons that start tones)
                                setTimeout(() => {
                                    const state1 = intervalOverviewInstance.audioController.getState();
                                    if (state1.isPlayingTone1 || state1.isPlayingTone2) {
                                        return; // Tones started playing, no sound
                                    }

                                    // Check after 100ms (final check)
                                    setTimeout(() => {
                                        const state2 = intervalOverviewInstance.audioController.getState();
                                        if (state2.isPlayingTone1 || state2.isPlayingTone2) {
                                            return; // Tones still/now playing, no sound
                                        }

                                        // All checks passed - no tones playing at any point
                                        buttonClickGenerator.playButtonClick();
                                    }, 50);
                                }, 50);
                            };

                            checkAndPlay();
                            return;
                        }
                    }

                    buttonClickGenerator.playButtonClick();
                }
            });

            // iOS Install Prompt - disabled by default
            // Users can access installation instructions from settings if needed

            // Close install modal
            const closeBtn = document.getElementById('closeInstallModal');
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    document.getElementById('iosInstallModal').style.display = 'none';
                });
            }

            // Don't show again (just close the modal)
            const dontShowBtn = document.getElementById('dontShowAgain');
            if (dontShowBtn) {
                dontShowBtn.addEventListener('click', () => {
                    document.getElementById('iosInstallModal').style.display = 'none';
                });
            }

            // Make install modal globally accessible for settings menu
            window.showInstallInstructions = () => {
                const modal = document.getElementById('iosInstallModal');
                if (modal) {
                    modal.style.display = 'flex';
                }
            };
        });
    </script>
</body>
</html>
