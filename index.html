<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="ToneDeath - Conquer tone deafness with ear training exercises">
    <meta name="theme-color" content="#2D5016">

    <!-- Prevent caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ToneDeath">

    <title>ToneDeath - Ear Training App</title>

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css?v=8">
</head>
<body>
    <!-- Setup Flow -->
    <div id="setupContainer" class="container" style="display: none;">
        <header>
            <h1>ToneDeath</h1>
            <p class="subtitle">Welcome! Let's set up your vocal range</p>
            <button id="audioSettingsBtn" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card">
                <div id="setupStepChoice" class="setup-step">
                    <h2>Choose Your Setup Method</h2>
                    <p>Select a standard vocal range or measure your own</p>

                    <div class="range-choice-container">
                        <button id="chooseStandardRangeBtn" class="btn-primary range-choice-btn">
                            <div class="btn-icon">üéº</div>
                            <div class="btn-text">Standard Range</div>
                            <div class="btn-subtitle">Select from common voice types</div>
                        </button>

                        <div class="choice-divider">
                            <span>OR</span>
                        </div>

                        <button id="chooseCustomRangeBtn" class="btn-primary range-choice-btn">
                            <div class="btn-icon">üé§</div>
                            <div class="btn-text">Custom Range</div>
                            <div class="btn-subtitle">Sing to find your range</div>
                        </button>
                    </div>
                </div>

                <div id="setupStepStandard" class="setup-step" style="display: none;">
                    <h2>Select Your Voice Type</h2>
                    <p>Choose the standard range that best matches your voice</p>

                    <div class="standard-ranges">
                        <button class="standard-range-btn" data-range="bass">
                            <div class="range-name">Bass</div>
                            <div class="range-notes">E2 - E4</div>
                            <div class="range-freq">82 - 330 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="baritone">
                            <div class="range-name">Baritone</div>
                            <div class="range-notes">A2 - A4</div>
                            <div class="range-freq">110 - 440 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="tenor">
                            <div class="range-name">Tenor</div>
                            <div class="range-notes">C3 - C5</div>
                            <div class="range-freq">131 - 523 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="alto">
                            <div class="range-name">Alto</div>
                            <div class="range-notes">F3 - F5</div>
                            <div class="range-freq">175 - 698 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="mezzo">
                            <div class="range-name">Mezzo-Soprano</div>
                            <div class="range-notes">A3 - A5</div>
                            <div class="range-freq">220 - 880 Hz</div>
                        </button>

                        <button class="standard-range-btn" data-range="soprano">
                            <div class="range-name">Soprano</div>
                            <div class="range-notes">C4 - C6</div>
                            <div class="range-freq">262 - 1047 Hz</div>
                        </button>
                    </div>

                    <button id="backToChoiceBtn" class="btn-secondary" style="margin-top: 20px;">Back</button>
                </div>

                <div id="setupPromptLow" class="setup-step setup-prompt" style="display: none;">
                    <div class="prompt-content">
                        <h2>Let's Find Your Vocal Range</h2>
                        <p>To help your ear, we need to know your vocal range. We will start with the lowest note you can sing.</p>
                        <button id="startLowNoteBtn" class="btn-primary">Start</button>
                        <button id="cancelPromptLowBtn" class="btn-secondary" style="margin-top: 10px;">Cancel</button>
                    </div>
                </div>

                <div id="setupStep1" class="setup-step" style="display: none;">
                    <h2>Step 1: Find Your Low Note</h2>
                    <p>Sing the lowest comfortable note you can sustain for a few seconds.</p>
                    <p class="instruction">Hold your lowest note steadily until the button appears.</p>

                    <div class="vocal-range-container">
                        <div class="pitch-display-with-range">
                            <div class="pitch-display">
                                <div id="lowNoteName" class="note-name">--</div>
                                <div id="lowNoteFreq" class="note-freq">-- Hz</div>
                            </div>

                            <div class="range-bar-container">
                                <div class="range-bar">
                                    <div class="range-labels">
                                        <span class="range-label-top">High</span>
                                        <span class="range-label-bottom">Low</span>
                                    </div>
                                    <div class="range-bar-background"></div>
                                    <div id="lowRangeFill" class="range-fill" style="height: 0%;"></div>
                                    <div id="lowRangeMarker" class="range-marker" style="bottom: 0%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button id="setLowBtn" class="btn-success" style="display: none;">Set Note</button>
                    <button id="cancelLowBtn" class="btn-secondary" style="margin-top: 10px;">Cancel</button>
                </div>

                <div id="setupPromptHigh" class="setup-step setup-prompt" style="display: none;">
                    <div class="prompt-content">
                        <h2>Great! Now Your High Note</h2>
                        <p>Thanks! Now we need to set your highest note. Remember to sit up straight and relax your jaw.</p>
                        <button id="cancelPromptHighBtn" class="btn-secondary">Back</button>
                        <button id="startHighNoteBtn" class="btn-primary" style="margin-top: 10px;">Continue</button>
                    </div>
                </div>

                <div id="setupStep2" class="setup-step" style="display: none;">
                    <h2>Step 2: Find Your High Note</h2>
                    <p>Sing the highest comfortable note you can sustain for a few seconds.</p>
                    <p class="instruction">Hold your highest note steadily until the button appears.</p>

                    <div class="vocal-range-container">
                        <div class="pitch-display-with-range">
                            <div class="pitch-display">
                                <div id="highNoteName" class="note-name">--</div>
                                <div id="highNoteFreq" class="note-freq">-- Hz</div>
                            </div>

                            <div class="range-bar-container">
                                <div class="range-bar">
                                    <div class="range-labels">
                                        <span class="range-label-top">High</span>
                                        <span class="range-label-bottom">Low</span>
                                    </div>
                                    <div class="range-bar-background"></div>
                                    <div id="highRangeFill" class="range-fill" style="height: 0%;"></div>
                                    <div id="highRangeMarker" class="range-marker" style="bottom: 0%;"></div>
                                    <div id="highLowMarker" class="range-low-marker" style="bottom: 0%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button id="setHighBtn" class="btn-success" style="display: none;">Set Note</button>
                    <button id="cancelHighBtn" class="btn-secondary" style="margin-top: 10px;">Back</button>
                </div>

                <div id="setupStep3" class="setup-step" style="display: none;">
                    <h2>‚úì Setup Complete!</h2>
                    <p>Your vocal range has been saved:</p>

                    <div class="range-summary">
                        <div class="range-item">
                            <span class="range-label">Low Note:</span>
                            <span id="summaryLowNote" class="range-value">--</span>
                        </div>
                        <div class="range-item">
                            <span class="range-label">High Note:</span>
                            <span id="summaryHighNote" class="range-value">--</span>
                        </div>
                    </div>

                    <button id="redoSetupBtn" class="btn-secondary" style="margin-bottom: 10px;">Redo</button>
                    <button id="startAppBtn" class="btn-primary">Start Training</button>
                </div>
            </section>
        </main>
    </div>

    <!-- Main App -->
    <div id="appContainer" class="container" style="display: none;">
        <header>
            <h1>ToneDeath</h1>
            <p class="subtitle">Conquer tone deafness</p>
            <button id="audioSettingsBtnMain" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card">
                <h2>Choose an Exercise</h2>

                <!-- Tutorial Section -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üìö Tutorial</h3>
                        <button class="category-toggle" aria-label="Toggle Tutorial section">‚àí</button>
                    </div>
                    <p class="category-description">Start here! Guided exercises to learn the basics</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="earTrainingOverview">
                            <div class="exercise-icon">üìñ</div>
                            <h3>Ear Training Overview</h3>
                            <p>Learn the fundamentals of ear training</p>
                        </button>
                        <button class="exercise-card" data-exercise="intervalOverview">
                            <div class="exercise-icon">‚ö°</div>
                            <h3>Pitch Overview</h3>
                            <p>Interactive tutorial on frequency, pitch, and intervals</p>
                        </button>
                    </div>
                </div>

                <!-- Unison Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéØ Unison Exercises</h3>
                        <button class="category-toggle" aria-label="Toggle Unison Exercises section">‚àí</button>
                    </div>
                    <p class="category-description">Match single pitches with precision</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="unisonOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Unison Overview</h3>
                            <p>Learn about pitch, frequency, and matching tones</p>
                        </button>

                        <button class="exercise-card" data-exercise="pitch">
                            <div class="exercise-icon">üé§</div>
                            <h3>Unison Explore</h3>
                            <p>Match your voice to the tone</p>
                        </button>

                        <button class="exercise-card" data-exercise="pitchhold">
                            <div class="exercise-icon">üëç</div>
                            <h3>Car Pitch Hold</h3>
                            <p>Hold a pitch for 3 seconds</p>
                        </button>

                        <button class="exercise-card" data-exercise="toneSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Tone Slide</h3>
                            <div class="exercise-category">Unison</div>
                            <p>Use the slider to match the tone of the played note</p>
                        </button>

                        <button class="exercise-card" data-exercise="unisonDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Unison Darts</h3>
                            <p>Match the root note - hit the bullseye</p>
                        </button>

                        <button class="exercise-card" data-exercise="unisonSystemExercise">
                            <div class="exercise-icon">üìö</div>
                            <h3>Unison System</h3>
                            <p>Guided singing exercises for unison practice</p>
                        </button>
                    </div>
                </div>

                <!-- Octave Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéµ Octave Exercises</h3>
                        <button class="category-toggle" aria-label="Toggle Octave Exercises section">‚àí</button>
                    </div>
                    <p class="category-description">Master octave relationships and jumps</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="octaveOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Octave Overview</h3>
                            <p>Learn about the octave interval and its 2:1 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="octaveFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Octave Explore</h3>
                            <p>Toggle between root and octave to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="octaveSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Octave Slide</h3>
                            <p>Slide your voice to match an octave above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="octaveDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Octave Darts</h3>
                            <p>Sing an octave above - hit the bullseye</p>
                        </button>

                        <button class="exercise-card" data-exercise="octaveSystemExercise">
                            <div class="exercise-icon">üìö</div>
                            <h3>Octave System</h3>
                            <p>Guided singing exercises for octave mastery</p>
                        </button>
                    </div>
                </div>

                <!-- Whole-Step Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéµ Major Second (Whole-Steps)</h3>
                        <button class="category-toggle" aria-label="Toggle Major Second section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand whole-step (2 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="majorSecondOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Major Second Overview</h3>
                            <p>Learn about the major second interval and its 9:8 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="wholeStepFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Whole-Step Explore</h3>
                            <p>Toggle between root and whole-step to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="wholeStepSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Whole-Step Slide</h3>
                            <p>Slide your voice to match a whole-step above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="wholeStepDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Whole-Step Darts</h3>
                            <p>Sing a whole-step above - hit the bullseye</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSecondSystemExercise">
                            <div class="exercise-icon">üìö</div>
                            <h3>Major Second System</h3>
                            <p>Guided singing exercises for major second mastery</p>
                        </button>
                    </div>
                </div>

                <!-- Half-Step Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéº Minor Second (Half-Steps)</h3>
                        <button class="category-toggle" aria-label="Toggle Minor Second section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand half-step (semi-tone) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="minorSecondOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Minor Second Overview</h3>
                            <p>Learn about the minor second interval and its 16:15 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="halfStepFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Half-Step Explore</h3>
                            <p>Toggle between root and half-step to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="halfStepSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Half-Step Slide</h3>
                            <p>Slide your voice to match a half-step above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="halfStepDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Half-Step Darts</h3>
                            <p>Sing a half-step above - hit the bullseye</p>
                        </button>

                        <button class="exercise-card" data-exercise="minorSecondSystemExercise">
                            <div class="exercise-icon">üìö</div>
                            <h3>Minor Second System</h3>
                            <p>Guided singing exercises for minor second mastery</p>
                        </button>
                    </div>
                </div>

                <!-- Major Third Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Major Third</h3>
                        <button class="category-toggle" aria-label="Toggle Major Third section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand major third (4 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="majorThirdOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Major Third Overview</h3>
                            <p>Learn about the major third interval and its 5:4 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorThirdFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Major Third Explore</h3>
                            <p>Toggle between root and major third to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorThirdSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Major Third Slide</h3>
                            <p>Slide your voice to match a major third above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorThirdDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Major Third Darts</h3>
                            <p>Sing a major third above - hit the bullseye</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorThirdSystemExercise">
                            <div class="exercise-icon">üìö</div>
                            <h3>Major Third System</h3>
                            <p>Guided singing exercises for major third mastery</p>
                        </button>
                    </div>
                </div>

                <!-- Perfect Fourth Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Perfect Fourth</h3>
                        <button class="category-toggle" aria-label="Toggle Perfect Fourth section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand perfect fourth (5 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="fourthOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Perfect Fourth Overview</h3>
                            <p>Learn about the perfect fourth interval and its 4:3 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFourthFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Perfect Fourth Explore</h3>
                            <p>Toggle between root and perfect fourth to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFourthSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Perfect Fourth Slide</h3>
                            <p>Slide your voice to match a perfect fourth above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFourthDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Perfect Fourth Darts</h3>
                            <p>Sing a perfect fourth above - hit the bullseye</p>
                        </button>

                        <button class="exercise-card" data-exercise="fourthSystemExercise">
                            <div class="exercise-icon">üìö</div>
                            <h3>Perfect Fourth System</h3>
                            <p>Guided singing exercises for perfect fourth mastery</p>
                        </button>
                    </div>
                </div>

                <!-- Perfect Fifth Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Perfect Fifth</h3>
                        <button class="category-toggle" aria-label="Toggle Perfect Fifth section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand perfect fifth (7 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="fifthOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Perfect Fifth Overview</h3>
                            <p>Learn about the perfect fifth interval and its 3:2 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFifthFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Perfect Fifth Explore</h3>
                            <p>Toggle between root and perfect fifth to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFifthSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Perfect Fifth Slide</h3>
                            <p>Slide your voice to match a perfect fifth above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="perfectFifthDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Perfect Fifth Darts</h3>
                            <p>Sing a perfect fifth above - hit the bullseye</p>
                        </button>

                        <button class="exercise-card" data-exercise="fifthSystemExercise">
                            <div class="exercise-icon">üìö</div>
                            <h3>Perfect Fifth System</h3>
                            <p>Guided singing exercises for perfect fifth mastery</p>
                        </button>
                    </div>
                </div>

                <!-- Major Sixth Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Major Sixth</h3>
                        <button class="category-toggle" aria-label="Toggle Major Sixth section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand major sixth (9 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="majorSixthOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Major Sixth Overview</h3>
                            <p>Learn about the major sixth interval and its 5:3 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSixthFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Major Sixth Explore</h3>
                            <p>Toggle between root and major sixth to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSixthSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Major Sixth Slide</h3>
                            <p>Slide your voice to match a major sixth above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSixthDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Major Sixth Darts</h3>
                            <p>Sing a major sixth above - hit the bullseye</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSixthSystemExercise">
                            <div class="exercise-icon">üìö</div>
                            <h3>Major Sixth System</h3>
                            <p>Guided singing exercises for major sixth mastery</p>
                        </button>
                    </div>
                </div>

                <!-- Major Seventh Interval Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üé∂ Major Seventh</h3>
                        <button class="category-toggle" aria-label="Toggle Major Seventh section">‚àí</button>
                    </div>
                    <p class="category-description">Hear and understand major seventh (11 semi-tones) relationships</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="majorSeventhOverview">
                            <div class="exercise-icon">üåä</div>
                            <h3>Major Seventh Overview</h3>
                            <p>Learn about the major seventh interval and its 15:8 frequency ratio</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSeventhFeelRoot">
                            <div class="exercise-icon">üîÑ</div>
                            <h3>Major Seventh Explore</h3>
                            <p>Toggle between root and major seventh to internalize the interval</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSeventhSlide">
                            <div class="exercise-icon">üéöÔ∏è</div>
                            <h3>Major Seventh Slide</h3>
                            <p>Slide your voice to match a major seventh above the root</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSeventhDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Major Seventh Darts</h3>
                            <p>Sing a major seventh above - hit the bullseye</p>
                        </button>

                        <button class="exercise-card" data-exercise="majorSeventhSystemExercise">
                            <div class="exercise-icon">üìö</div>
                            <h3>Major Seventh System</h3>
                            <p>Guided singing exercises for major seventh mastery</p>
                        </button>
                    </div>
                </div>

                <!-- Scale Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéπ Scale Exercises</h3>
                        <button class="category-toggle" aria-label="Toggle Scale Exercises section">‚àí</button>
                    </div>
                    <p class="category-description">Practice singing scales and melodic patterns</p>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="scale">
                            <div class="exercise-icon">üéπ</div>
                            <h3>Scale Match Up</h3>
                            <p>Sing a major scale ascending</p>
                        </button>

                        <button class="exercise-card" data-exercise="scaleHopping">
                            <div class="exercise-icon">ü¶ò</div>
                            <h3>Scale Hopping</h3>
                            <p>PLACEHOLDER: Do Re Do, Do Mi Do. UP and down the scale</p>
                        </button>

                        <button class="exercise-card" data-exercise="hopToOctave">
                            <div class="exercise-icon">üéµ</div>
                            <h3>Hop to the Octave</h3>
                            <p>PLACEHOLDER: Starting with the root, go through the Do, Re, Mi scale and end on Do. See how close you were.</p>
                        </button>
                        <button class="exercise-card" data-exercise="scaleDarts">
                            <div class="exercise-icon">üéØ</div>
                            <h3>Scale Darts</h3>
                            <p>Hit the target scale degree - only the root is played</p>
                        </button>
                    </div>
                </div>

                <!-- Other Exercises -->
                <div class="exercise-category">
                    <div class="category-header">
                        <h3 class="category-title">üéµ Other Exercises</h3>
                        <button class="category-toggle" aria-label="Toggle Other Exercises section">‚àí</button>
                    </div>
                    <div class="exercise-grid">
                        <button class="exercise-card" data-exercise="glissando">
                            <div class="exercise-icon">üåä</div>
                            <h3>Glissando</h3>
                            <p>Slide your voice smoothly through it's range</p>
                        </button>

                        <button class="exercise-card" data-exercise="diagnostics">
                            <div class="exercise-icon">üî¨</div>
                            <h3>Mic Diagnostics</h3>
                            <p>Test and debug pitch detection</p>
                        </button>
                        <button class="exercise-card" data-exercise="interferenceVisualization">
                            <div class="exercise-icon">‚óà</div>
                            <h3>Interference Visualization</h3>
                            <p>Visualize harmonic interference patterns and intervals</p>
                        </button>
                        <button class="exercise-card" data-exercise="waveVisualization">
                            <div class="exercise-icon">ü™ó</div>
                            <h3>Wave Visualization</h3>
                            <p>Retro waveform blend with interval color spectrum</p>
                        </button>
                    </div>
                </div>
            </section>

            <section class="card">
                <h2>Your Vocal Range</h2>
                <div class="range-summary">
                    <div class="range-item">
                        <span class="range-label">Low Note:</span>
                        <span id="appLowNote" class="range-value">--</span>
                    </div>
                    <div class="range-item">
                        <span class="range-label">High Note:</span>
                        <span id="appHighNote" class="range-value">--</span>
                    </div>
                    <div class="range-item" id="voiceTypeContainer" style="display: none;">
                        <span class="range-label">Voice Type:</span>
                        <span id="appVoiceType" class="range-value">--</span>
                    </div>
                </div>
                <button id="resetSetupBtn" class="btn-secondary">Reset Vocal Range</button>
            </section>

            <button id="installBtn" class="btn-primary" style="display: none; margin-top: 20px;">Install App</button>

            <!-- Tips and Tricks Browse Button -->
            <button id="tipsBrowseBtn" class="btn-secondary" style="margin-top: 20px;">
                üí° Tips & Tricks
            </button>
        </main>

        <footer>
            <p>&copy; 2025 ToneDeath.app</p>
        </footer>
    </div>

    <!-- Tips and Tricks Modal -->
    <div id="tipsModal" class="tips-modal" style="display: none;">
        <div class="tips-modal-content">
            <button id="closeTipBtn" class="tips-close-btn">‚úï</button>

            <div class="tip-card">
                <div class="tip-image" id="tipImage">üí°</div>
                <h2 class="tip-title" id="tipTitle">Tip Title</h2>
                <p class="tip-text" id="tipText">Tip content goes here.</p>
            </div>

            <div class="tips-navigation">
                <button id="prevTipBtn" class="btn-tip-nav">‚Üê</button>
                <button id="nextTipBtn" class="btn-tip-nav">‚Üí</button>
            </div>
        </div>
    </div>

    <!-- iOS Install Instructions Modal -->
    <div id="iosInstallModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Install ToneDeath</h2>
            <button id="closeInstallModal" class="exit-btn" aria-label="Close">‚úï</button>

            <div style="padding: 20px; text-align: left;">
                <p style="margin-bottom: 20px; color: var(--neon-cyan);">For the best experience and proper Bluetooth audio support, install ToneDeath to your home screen:</p>

                <ol style="line-height: 2; color: var(--text-primary); margin-left: 20px;">
                    <li>Tap the <strong style="color: var(--neon-pink);">Share button</strong> <span style="font-size: 1.2em;">‚éã</span> in Safari</li>
                    <li>Scroll down and tap <strong style="color: var(--neon-pink);">"Add to Home Screen"</strong></li>
                    <li>Tap <strong style="color: var(--neon-pink);">"Add"</strong> in the top right</li>
                    <li>Open ToneDeath from your home screen</li>
                </ol>

                <p style="margin-top: 20px; font-size: 0.875rem; color: var(--text-secondary);">Note: iOS requires PWAs to be installed for full Bluetooth speaker support.</p>

                <button id="dontShowAgain" class="btn-secondary" style="margin-top: 20px;">Close</button>
            </div>
        </div>
    </div>

    <!-- System Exercise Menu -->
    <div id="systemExerciseMenu" class="container exercise-container" style="display: none;">
        <header>
            <button id="systemExerciseMenuBack" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle" id="systemExerciseMenuTitle">System Exercises</p>
            </div>
            <button id="audioSettingsBtnSystemMenu" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card">
                <h2 id="systemExerciseMenuIntervalName">Choose an Exercise</h2>
                <p class="category-description" id="systemExerciseMenuDescription">Select a guided singing exercise to practice</p>

                <div class="exercise-grid" id="systemExerciseMenuGrid">
                    <!-- Exercise cards will be dynamically added here -->
                </div>
            </section>
        </main>
    </div>

    <!-- Interval System Exercise (Generic Template) -->
    <div id="intervalSystemExercise" class="container exercise-container" style="display: none;">
        <header>
            <button data-system-exercise="exit" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle" data-system-exercise="title">System Exercise</p>
                <p class="exercise-label" data-system-exercise="exercise-label">Exercise Name</p>
            </div>
            <button id="audioSettingsBtnSystemExercise" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Visual Indicators -->
                <div class="system-exercise-indicators">
                    <div class="tone-indicator" data-system-exercise="root-indicator">
                        <div class="indicator-label">Root</div>
                        <div class="indicator-animation">
                            <div class="indicator-wave"></div>
                            <div class="indicator-wave"></div>
                            <div class="indicator-wave"></div>
                        </div>
                    </div>
                    <div class="tone-indicator" data-system-exercise="interval-indicator">
                        <div class="indicator-label">Interval</div>
                        <div class="indicator-animation">
                            <div class="indicator-wave"></div>
                            <div class="indicator-wave"></div>
                            <div class="indicator-wave"></div>
                        </div>
                    </div>
                    <div class="glissando-indicator" data-system-exercise="glissando-indicator" style="display: none;">
                        <div class="glissando-head" role="img" aria-label="Singer"></div>
                        <div class="glissando-notes" role="img" aria-label="Glissando notes"></div>
                    </div>
                </div>

                <!-- Current Step Display -->
                <div class="system-exercise-step-display">
                    <div class="carousel-step-flow">
                        <!-- Command button overlapping from left -->
                        <div class="flow-command" data-system-exercise="command">
                            Listen
                        </div>

                        <!-- Instruction card -->
                        <div class="flow-instruction-card">
                            <div class="flow-instruction" data-system-exercise="instruction">
                                to the tone carefully
                            </div>
                            <!-- Action button at end of instruction -->
                            <button class="flow-action-button btn-action-primary" data-system-exercise="action">
                                then Match It
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Secondary Navigation -->
                <div class="system-exercise-secondary-nav">
                    <button data-system-exercise="skip-exercise" class="btn-skip">
                        Skip Exercise
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Audio Settings Modal -->
    <div id="audioSettings" class="modal" style="display: none;">
        <div class="modal-content">
            <h2>Audio Settings</h2>
            <button id="closeAudioSettings" class="exit-btn" aria-label="Close">‚úï</button>

            <div class="settings-section">
                <label for="usageModeSelect">Usage Mode:</label>
                <select id="usageModeSelect" class="settings-select">
                    <option value="headphone-mic">üéß Headphone + Mic</option>
                    <option value="speaker-mic">üîä Speaker + Mic</option>
                    <option value="car-mode">üöó Car Mode</option>
                </select>
                <p class="settings-description" id="usageModeDescription">Single headphone with microphone (default)</p>
            </div>

            <div class="settings-divider"></div>

            <div class="settings-section">
                <label for="micSelect">Microphone:</label>
                <select id="micSelect" class="settings-select">
                    <option>Loading...</option>
                </select>
                <p class="settings-description" style="color: var(--neon-yellow); font-size: 0.75rem;">‚ö†Ô∏è iOS Note: Select your AirPods BEFORE starting exercise. Check Debug panel "Device" to verify.</p>
            </div>

            <div class="settings-section">
                <label for="speakerSelect">Speaker:</label>
                <select id="speakerSelect" class="settings-select">
                    <option>Loading...</option>
                </select>
            </div>

            <div class="settings-divider"></div>

            <div class="settings-section">
                <label for="sensitivityPreset">Pitch Sensitivity:</label>
                <select id="sensitivityPreset" class="settings-select">
                    <option value="very-strict">Very Strict</option>
                    <option value="strict">Strict</option>
                    <option value="normal" selected>Normal</option>
                    <option value="forgiving">Forgiving</option>
                    <option value="very-forgiving">Very Forgiving</option>
                </select>
                <p class="settings-description" id="sensitivityDescription">Balanced - good for most users</p>
            </div>

            <div class="settings-section">
                <label for="toleranceSelect">Match Tolerance:</label>
                <select id="toleranceSelect" class="settings-select">
                    <option value="0.0005">0.05% (~8 cents) - Very Strict</option>
                    <option value="0.001" selected>0.1% (~17 cents) - Strict</option>
                    <option value="0.01">1% (~85 cents) - Normal</option>
                    <option value="0.02">2% (~170 cents) - Forgiving</option>
                </select>
                <p class="settings-description">How close your pitch must match the target</p>
            </div>

            <div class="settings-divider"></div>

            <div class="settings-section">
                <label for="micGainSlider">Microphone Gain:</label>
                <div class="gain-control-container">
                    <input type="range" id="micGainSlider" class="gain-slider" min="0.1" max="5.0" step="0.1" value="1.0">
                    <span id="micGainValue" class="gain-value">1.0x</span>
                </div>
                <p class="settings-description">Increase if microphone is too quiet (1.0x = normal)</p>
            </div>

            <div class="settings-divider"></div>

            <div class="settings-section">
                <label for="debugControlsToggle">Debug Controls:</label>
                <div class="toggle-container">
                    <input type="checkbox" id="debugControlsToggle" class="toggle-checkbox" checked>
                    <label for="debugControlsToggle" class="toggle-label">
                        <span class="toggle-slider"></span>
                    </label>
                    <span id="debugControlsStatus" class="toggle-status">On</span>
                </div>
                <p class="settings-description">Show debug button and diagnostics exercise</p>
            </div>

            <div class="settings-divider"></div>

            <button id="requestPermissions" class="btn-primary">Request Microphone Access</button>
            <button id="testAudio" class="btn-secondary">Test Audio</button>
            <button id="showInstallBtn" class="btn-secondary" style="margin-top: 10px;">Installation Instructions</button>
        </div>
    </div>

    <!-- Glissando Exercise -->
    <div id="glissandoExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitGlissandoExercise" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Glissando</p>
            </div>
            <button id="audioSettingsBtnGlissando" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>

            <section class="card exercise-main">
                <div class="glissando-container">
                    <!-- Progress Display -->
                    <div class="glissando-progress">
                        <div class="progress-text">
                            <span id="glissandoCount">0</span> / 5 Complete
                        </div>
                        <div class="progress-direction" id="glissandoDirection">Slide Up! üîº</div>
                    </div>

                    <!-- Pitch Display with Range Visualization -->
                    <div class="pitch-display-with-range">
                        <div class="pitch-display" id="glissandoPitchDisplay">
                            <div class="note-name" id="glissandoNoteName">‚ô™</div>
                            <div class="note-freq" id="glissandoNoteFreq">Sing to begin</div>
                        </div>

                        <div class="range-bar-container">
                            <div class="range-bar">
                                <div class="range-labels">
                                    <div class="range-label-top" id="glissandoHighLabel">--</div>
                                    <div class="range-label-bottom" id="glissandoLowLabel">--</div>
                                </div>
                                <div class="range-bar-background">
                                    <div class="range-fill" id="glissandoRangeFill"></div>
                                    <div class="range-marker" id="glissandoMarker"></div>
                                    <div class="range-low-marker" id="glissandoLowMarker"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Instruction -->
                    <div class="glissando-instruction">
                        Start at your lowest note and smoothly slide your voice to your highest note
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Pitch Match Exercise -->
    <div id="intonationExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitExercise" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Unison Explore</p>
            </div>
            <button id="audioSettingsBtnExercise" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>

            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="currentNote" style="display: none;">--</div>
                <div id="currentFreq" style="display: none;">-- Hz</div>

                <!-- Instructions Container -->
                <div id="pitchMatchInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Play/Pause Button -->
                    <button id="pitchMatchPlayBtn" class="btn-exercise-big btn-stop">
                        <div class="btn-content-vertical">
                            <div id="toneAnimation" class="tone-animation-btn">
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                            </div>
                            <div class="btn-text">Play Tone</div>
                            <div id="pitchMatchPlayIcon" class="play-pause-icon">‚è∏</div>
                        </div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="nextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="toneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Pitch Hold Exercise -->
    <div id="pitchHoldExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitPitchHold" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Car Pitch Hold</p>
            </div>
            <button id="audioSettingsBtnPitchHold" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="pitchHoldNote" style="display: none;">--</div>
                <div id="pitchHoldFreq" style="display: none;">-- Hz</div>

                <!-- Instruction -->
                <div class="pitch-match-instruction">
                    Headphones with a microphone is ideal
                </div>

                <!-- Tone Counter -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="pitchHoldCounter">0</span>
                </div>

                <!-- Success Animation -->
                <div id="pitchHoldSuccess" class="pitch-hold-success" style="display: none;">
                    <div class="success-thumbs">üëç</div>
                </div>

                <div class="exercise-controls-big">
                    <div class="pitch-hold-controls-row">
                        <!-- Progress Bucket (left side) -->
                        <div id="pitchHoldProgress" class="pitch-hold-bucket" style="display: none;">
                            <div class="bucket-container">
                                <div id="pitchHoldProgressFill" class="bucket-fill"></div>
                                <svg class="bucket-outline" viewBox="0 0 100 120" xmlns="http://www.w3.org/2000/svg">
                                    <!-- Bucket shape: wider at top, narrower at bottom -->
                                    <path d="M 15 10 L 25 110 L 75 110 L 85 10 Z"
                                          fill="none"
                                          stroke="var(--neon-cyan)"
                                          stroke-width="3"
                                          stroke-linejoin="round"/>
                                    <!-- Handle -->
                                    <path d="M 20 10 Q 50 0 80 10"
                                          fill="none"
                                          stroke="var(--neon-cyan)"
                                          stroke-width="2.5"/>
                                </svg>
                            </div>
                        </div>

                        <div class="pitch-hold-buttons">
                            <!-- Match This Button -->
                            <button id="pitchHoldMatchBtn" class="btn-exercise-big btn-stop">
                        <div class="btn-content">
                            <div id="pitchHoldAnimation" class="tone-animation-btn">
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                            </div>
                            <div class="btn-text">Match This</div>
                        </div>
                    </button>

                            <!-- Next Tone Button -->
                            <button id="pitchHoldNextBtn" class="btn-exercise-big btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-icon">‚Üí</div>
                                    <div class="btn-text">Next Tone</div>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Octave Match Exercise -->
    <div id="octaveExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitOctaveExercise" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Octave Match</p>
            </div>
            <button id="audioSettingsBtnOctave" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>

            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="octaveNote" style="display: none;">--</div>
                <div id="octaveFreq" style="display: none;">-- Hz</div>

                <div class="exercise-controls-big">
                    <!-- High Note Button (Top) -->
                    <button id="playHighOctaveBtn" class="btn-exercise-big btn-next">
                        <div class="btn-content-vertical">
                            <div id="octaveHighAnimation" class="tone-animation-btn">
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                            </div>
                            <div class="btn-icon">‚¨ÜÔ∏è</div>
                            <div class="btn-text">High Note</div>
                            <div id="octaveHighPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>

                    <!-- Both Button -->
                    <button id="playBothOctaveBtn" class="btn-exercise-small btn-secondary">
                        <div class="btn-content">
                            <div class="btn-text">Both</div>
                        </div>
                    </button>

                    <!-- Next Octave Button -->
                    <button id="nextOctavePairBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Octave</div>
                        </div>
                    </button>

                    <!-- Low Note Button (Bottom) -->
                    <button id="playLowOctaveBtn" class="btn-exercise-big btn-next">
                        <div class="btn-content-vertical">
                            <div id="octaveLowAnimation" class="tone-animation-btn">
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                                <div class="tone-wave"></div>
                            </div>
                            <div class="btn-icon">‚¨áÔ∏è</div>
                            <div class="btn-text">Low Note</div>
                            <div id="octaveLowPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Scale Match Up Exercise -->
    <div id="scaleExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitScaleExercise" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Scale Match</p>
            </div>
            <button id="audioSettingsBtnScale" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>

            <section class="card exercise-main">
                <!-- Scale Horizontal Layout -->
                <div class="scale-horizontal-layout">
                    <!-- High Do (note 7) - Top, Right Aligned -->
                    <div class="scale-row scale-row-do-high">
                        <button id="scaleNote7Btn" class="btn-scale-horizontal btn-do-half">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote7Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Do</div>
                                <div id="scaleNote7PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Ti (note 6) -->
                    <div class="scale-row scale-row-6">
                        <button id="scaleNote6Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote6Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Ti</div>
                                <div id="scaleNote6PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- La (note 5) -->
                    <div class="scale-row scale-row-5">
                        <button id="scaleNote5Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote5Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">La</div>
                                <div id="scaleNote5PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Sol (note 4) -->
                    <div class="scale-row scale-row-4">
                        <button id="scaleNote4Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote4Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Sol</div>
                                <div id="scaleNote4PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Fa (note 3) -->
                    <div class="scale-row scale-row-3">
                        <button id="scaleNote3Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote3Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Fa</div>
                                <div id="scaleNote3PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Mi (note 2) -->
                    <div class="scale-row scale-row-2">
                        <button id="scaleNote2Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote2Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Mi</div>
                                <div id="scaleNote2PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Re (note 1) -->
                    <div class="scale-row scale-row-1">
                        <button id="scaleNote1Btn" class="btn-scale-horizontal">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote1Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Re</div>
                                <div id="scaleNote1PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- Low Do (note 0) - Bottom, Left Aligned -->
                    <div class="scale-row scale-row-do-low">
                        <button id="scaleNote0Btn" class="btn-scale-horizontal btn-do-half">
                            <div class="btn-scale-content-vertical">
                                <div id="scaleNote0Animation" class="tone-animation-btn-small">
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                    <div class="tone-wave"></div>
                                </div>
                                <div class="solfege-label">Do</div>
                                <div id="scaleNote0PlayIcon" class="play-pause-icon-small">‚ñ∂</div>
                            </div>
                        </button>
                    </div>

                    <!-- New Scale Button -->
                    <button id="newScaleBtn" class="btn-scale-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">üîÑ</div>
                            <div class="btn-text">New Scale</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Tone Slide Exercise -->
    <div id="toneSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="toneSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Tone Slide</p>
            </div>
            <button id="audioSettingsBtnToneSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="toneSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="toneSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="toneSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="toneSlideSlider" class="tone-slide-slider">
                        <div id="toneSlideKnob" class="tone-slide-knob"></div>
                        <div id="toneSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="toneSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="toneSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="toneSlidePlayBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Play Tone</div>
                                    <div id="toneSlidePlayIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="toneSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Tone Darts Exercise -->
    <div id="toneDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="exitToneDarts" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Tone Darts</p>
            </div>
            <button id="audioSettingsBtnDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="dartRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="dartScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="dartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="dartPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Tone</div>
                            <div id="dartPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Unison Darts Exercise -->
    <div id="unisonDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="unisonDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Unison Darts</p>
            </div>
            <button id="audioSettingsBtnUnisonDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="unisonDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="unisonDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="unisonDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="unisonDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="unisonDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Half-Step Darts Exercise -->
    <div id="halfStepDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="halfStepDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Half-Step Darts</p>
            </div>
            <button id="audioSettingsBtnHalfStepDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="halfStepDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="halfStepDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="halfStepDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="halfStepDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="halfStepDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Whole-Step Darts Exercise -->
    <div id="wholeStepDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="wholeStepDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Whole-Step Darts</p>
            </div>
            <button id="audioSettingsBtnWholeStepDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="wholeStepDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="wholeStepDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="wholeStepDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="wholeStepDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="wholeStepDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Octave Darts Exercise -->
    <div id="octaveDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="octaveDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Octave Darts</p>
            </div>
            <button id="audioSettingsBtnOctaveDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="octaveDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="octaveDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="octaveDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="octaveDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="octaveDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Mic Diagnostics Exercise -->
    <div id="audioDiagnostics" class="container exercise-container" style="display: none;">
        <header>
            <h1>üî¨ Mic Diagnostics</h1>
            <button id="exitDiagnostics" class="exit-btn">‚úï</button>
        </header>

        <main class="diag-main">
            <section class="card diag-controls">
                <h2>Run Tests</h2>
                <p class="diag-instructions">
                    These tests help diagnose why pitch detection might drop off during singing.
                    Run each test and report the results back.
                </p>

                <div class="diag-test-buttons">
                    <button id="diagTestSpeech" class="btn-diag">Test: Speech</button>
                    <button id="diagTestSinging" class="btn-diag">Test: Singing</button>
                    <button id="diagTestTone" class="btn-diag">Test: Match Tone</button>
                    <button id="diagStopTest" class="btn-diag btn-stop" disabled>Stop Test</button>
                </div>

                <div class="diag-current-test">
                    <span class="diag-label">Current Test:</span>
                    <span id="diagCurrentTest" class="diag-value">None</span>
                </div>
            </section>

            <section class="card diag-waveform-section">
                <h2>Live Waveform (Time Domain)</h2>
                <canvas id="diagWaveform" width="800" height="200"></canvas>
            </section>

            <section class="card diag-waveform-section">
                <h2>FFT Spectrum (Frequency Domain)</h2>
                <canvas id="diagSpectrum" width="800" height="200"></canvas>
            </section>

            <section class="card diag-metrics">
                <h2>Real-Time Metrics</h2>
                <div class="diag-metrics-grid">
                    <div class="diag-metric">
                        <span class="diag-label">RMS (Raw):</span>
                        <span id="diagRMS" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">RMS Threshold:</span>
                        <span id="diagRMSThreshold" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Detected Pitch:</span>
                        <span id="diagPitch" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Clipping:</span>
                        <span id="diagClipping" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Buffer Size:</span>
                        <span id="diagBufferSize" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">FFT Size:</span>
                        <span id="diagFFTSize" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Audio Processing:</span>
                        <span id="diagProcessing" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Detection Method:</span>
                        <span id="diagMethod" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">FFT Freq:</span>
                        <span id="diagFFTFreq" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Autocorr Freq:</span>
                        <span id="diagAutocorrFreq" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">FFT Confidence:</span>
                        <span id="diagFFTConfidence" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">FFT Threshold:</span>
                        <span id="diagFFTThreshold" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Smoothing:</span>
                        <span id="diagSmoothing" class="diag-value">--</span>
                    </div>
                    <div class="diag-metric">
                        <span class="diag-label">Mic Gain:</span>
                        <span id="diagMicGain" class="diag-value">--</span>
                    </div>
                </div>
            </section>

            <section class="card diag-results-section">
                <h2>Test Results & Recommendations</h2>
                <button id="diagCopyLog" class="btn-diag" style="width: 100%; margin-bottom: 15px;">
                    üìã Copy Diagnostic Log to Clipboard
                </button>
                <div id="diagResults" class="diag-results"></div>
            </section>
        </main>
    </div>

    <!-- Half-Step Feel the Root Exercise -->
    <div id="halfStepFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="halfStepFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Half-Step Explore</p>
            </div>
            <button id="audioSettingsBtnHalfStepFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="halfStepFeelRootCurrentNote" style="display: none;">--</div>
                <div id="halfStepFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="halfStepFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="halfStepFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="halfStepFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="halfStepFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="halfStepFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="halfStepFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="halfStepFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Half-Step</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="halfStepFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="halfStepFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Octave Feel the Root Exercise -->
    <div id="octaveFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="octaveFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Octave Explore</p>
            </div>
            <button id="audioSettingsBtnOctaveFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="octaveFeelRootCurrentNote" style="display: none;">--</div>
                <div id="octaveFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="octaveFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="octaveFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="octaveFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="octaveFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="octaveFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="octaveFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="octaveFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Octave</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="octaveFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="octaveFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Whole-Step Feel the Root Exercise -->
    <div id="wholeStepFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="wholeStepFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Whole-Step Explore</p>
            </div>
            <button id="audioSettingsBtnWholeStepFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="wholeStepFeelRootCurrentNote" style="display: none;">--</div>
                <div id="wholeStepFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="wholeStepFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="wholeStepFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="wholeStepFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="wholeStepFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="wholeStepFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="wholeStepFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="wholeStepFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Whole-Step</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="wholeStepFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="wholeStepFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Half-Step Slide Exercise -->
    <div id="halfStepSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="halfStepSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Half-Step Slide</p>
            </div>
            <button id="audioSettingsBtnHalfStepSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="halfStepSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="halfStepSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="halfStepSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="halfStepSlideSlider" class="tone-slide-slider">
                        <div id="halfStepSlideKnob" class="tone-slide-knob"></div>
                        <div id="halfStepSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="halfStepSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="halfStepSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="halfStepSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="halfStepSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="halfStepSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="halfStepSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="halfStepSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Whole-Step Slide Exercise -->
    <div id="wholeStepSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="wholeStepSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Whole-Step Slide</p>
            </div>
            <button id="audioSettingsBtnWholeStepSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="wholeStepSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="wholeStepSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="wholeStepSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="wholeStepSlideSlider" class="tone-slide-slider">
                        <div id="wholeStepSlideKnob" class="tone-slide-knob"></div>
                        <div id="wholeStepSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="wholeStepSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="wholeStepSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="wholeStepSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="wholeStepSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="wholeStepSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="wholeStepSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="wholeStepSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Octave Slide Exercise -->
    <div id="octaveSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="octaveSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Octave Slide</p>
            </div>
            <button id="audioSettingsBtnOctaveSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="octaveSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="octaveSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="octaveSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="octaveSlideSlider" class="tone-slide-slider">
                        <div id="octaveSlideKnob" class="tone-slide-knob"></div>
                        <div id="octaveSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="octaveSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="octaveSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="octaveSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="octaveSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="octaveSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="octaveSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="octaveSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Third Feel the Root Exercise -->
    <div id="majorThirdFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorThirdFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Third Explore</p>
            </div>
            <button id="audioSettingsBtnMajorThirdFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="majorThirdFeelRootCurrentNote" style="display: none;">--</div>
                <div id="majorThirdFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="majorThirdFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="majorThirdFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorThirdFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="majorThirdFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="majorThirdFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="majorThirdFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorThirdFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Major Third</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="majorThirdFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="majorThirdFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Third Slide Exercise -->
    <div id="majorThirdSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorThirdSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Third Slide</p>
            </div>
            <button id="audioSettingsBtnMajorThirdSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="majorThirdSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="majorThirdSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="majorThirdSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="majorThirdSlideSlider" class="tone-slide-slider">
                        <div id="majorThirdSlideKnob" class="tone-slide-knob"></div>
                        <div id="majorThirdSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="majorThirdSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="majorThirdSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="majorThirdSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="majorThirdSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="majorThirdSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="majorThirdSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="majorThirdSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Third Darts Exercise -->
    <div id="majorThirdDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorThirdDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Third Darts</p>
            </div>
            <button id="audioSettingsBtnMajorThirdDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="majorThirdDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="majorThirdDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="majorThirdDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="majorThirdDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="majorThirdDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fourth Feel the Root Exercise -->
    <div id="perfectFourthFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFourthFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fourth Explore</p>
            </div>
            <button id="audioSettingsBtnPerfectFourthFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="perfectFourthFeelRootCurrentNote" style="display: none;">--</div>
                <div id="perfectFourthFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="perfectFourthFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="perfectFourthFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="perfectFourthFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="perfectFourthFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="perfectFourthFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="perfectFourthFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="perfectFourthFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Perfect Fourth</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="perfectFourthFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="perfectFourthFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fourth Slide Exercise -->
    <div id="perfectFourthSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFourthSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fourth Slide</p>
            </div>
            <button id="audioSettingsBtnPerfectFourthSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="perfectFourthSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="perfectFourthSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="perfectFourthSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="perfectFourthSlideSlider" class="tone-slide-slider">
                        <div id="perfectFourthSlideKnob" class="tone-slide-knob"></div>
                        <div id="perfectFourthSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="perfectFourthSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="perfectFourthSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="perfectFourthSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="perfectFourthSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="perfectFourthSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="perfectFourthSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="perfectFourthSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fourth Darts Exercise -->
    <div id="perfectFourthDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFourthDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fourth Darts</p>
            </div>
            <button id="audioSettingsBtnPerfectFourthDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="perfectFourthDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="perfectFourthDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="perfectFourthDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="perfectFourthDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="perfectFourthDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fifth Feel the Root Exercise -->
    <div id="perfectFifthFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFifthFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fifth Explore</p>
            </div>
            <button id="audioSettingsBtnPerfectFifthFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="perfectFifthFeelRootCurrentNote" style="display: none;">--</div>
                <div id="perfectFifthFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="perfectFifthFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="perfectFifthFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="perfectFifthFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="perfectFifthFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="perfectFifthFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="perfectFifthFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="perfectFifthFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Perfect Fifth</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="perfectFifthFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="perfectFifthFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fifth Slide Exercise -->
    <div id="perfectFifthSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFifthSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fifth Slide</p>
            </div>
            <button id="audioSettingsBtnPerfectFifthSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="perfectFifthSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="perfectFifthSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="perfectFifthSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="perfectFifthSlideSlider" class="tone-slide-slider">
                        <div id="perfectFifthSlideKnob" class="tone-slide-knob"></div>
                        <div id="perfectFifthSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="perfectFifthSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="perfectFifthSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="perfectFifthSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="perfectFifthSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="perfectFifthSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="perfectFifthSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="perfectFifthSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Perfect Fifth Darts Exercise -->
    <div id="perfectFifthDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="perfectFifthDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Perfect Fifth Darts</p>
            </div>
            <button id="audioSettingsBtnPerfectFifthDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="perfectFifthDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="perfectFifthDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="perfectFifthDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="perfectFifthDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="perfectFifthDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Sixth Feel the Root Exercise -->
    <div id="majorSixthFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSixthFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Sixth Explore</p>
            </div>
            <button id="audioSettingsBtnMajorSixthFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="majorSixthFeelRootCurrentNote" style="display: none;">--</div>
                <div id="majorSixthFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="majorSixthFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="majorSixthFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorSixthFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="majorSixthFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="majorSixthFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="majorSixthFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorSixthFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Major Sixth</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="majorSixthFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="majorSixthFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Sixth Slide Exercise -->
    <div id="majorSixthSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSixthSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Sixth Slide</p>
            </div>
            <button id="audioSettingsBtnMajorSixthSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="majorSixthSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="majorSixthSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="majorSixthSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="majorSixthSlideSlider" class="tone-slide-slider">
                        <div id="majorSixthSlideKnob" class="tone-slide-knob"></div>
                        <div id="majorSixthSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="majorSixthSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="majorSixthSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="majorSixthSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="majorSixthSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="majorSixthSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="majorSixthSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="majorSixthSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Sixth Darts Exercise -->
    <div id="majorSixthDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSixthDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Sixth Darts</p>
            </div>
            <button id="audioSettingsBtnMajorSixthDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="majorSixthDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="majorSixthDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="majorSixthDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="majorSixthDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="majorSixthDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Seventh Feel the Root Exercise -->
    <div id="majorSeventhFeelRootExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSeventhFeelRootExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Seventh Explore</p>
            </div>
            <button id="audioSettingsBtnMajorSeventhFeelRoot" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main">
                <!-- Hidden elements for exercise state -->
                <div id="majorSeventhFeelRootCurrentNote" style="display: none;">--</div>
                <div id="majorSeventhFeelRootCurrentFreq" class="current-freq-display">-- Hz</div>

                <!-- Instructions Container -->
                <div id="majorSeventhFeelRootInstructions"></div>

                <div class="exercise-controls-big">
                    <!-- Root Button with Animation -->
                    <button id="majorSeventhFeelRootRootBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorSeventhFeelRootRootAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Root</div>
                    </button>

                    <!-- Both and Swap Buttons (side by side) -->
                    <div class="btn-group-horizontal">
                        <button id="majorSeventhFeelRootBothBtn" class="btn-both-notes">
                            <div class="btn-text">Both</div>
                        </button>
                        <button id="majorSeventhFeelRootSwapBtn" class="btn-both-notes">
                            <div class="btn-text">Swap</div>
                        </button>
                    </div>

                    <!-- Interval Button with Animation -->
                    <button id="majorSeventhFeelRootIntervalBtn" class="btn-exercise-big btn-feel-root">
                        <div id="majorSeventhFeelRootIntervalAnimation" class="tone-animation-btn">
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                            <div class="tone-wave"></div>
                        </div>
                        <div class="btn-text">‚ñ∂ Major Seventh</div>
                    </button>

                    <!-- Next Tone Button -->
                    <button id="majorSeventhFeelRootNextToneBtn" class="btn-exercise-big btn-secondary">
                        <div class="btn-content">
                            <div class="btn-icon">‚Üí</div>
                            <div class="btn-text">Next Tone</div>
                        </div>
                    </button>
                </div>

                <!-- Tone Counter (moved to bottom) -->
                <div class="tone-counter-display">
                    <span class="counter-label">Tones Completed:</span>
                    <span class="counter-value" id="majorSeventhFeelRootToneCounter">0</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Seventh Slide Exercise -->
    <div id="majorSeventhSlideExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSeventhSlideExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Seventh Slide</p>
            </div>
            <button id="audioSettingsBtnMajorSeventhSlide" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card tone-slide-main">
                <!-- Accuracy Display (Upper Right) -->
                <div id="majorSeventhSlideAccuracy" class="tone-slide-accuracy" style="display: none;">
                    <div class="accuracy-label">Last Attempt:</div>
                    <div id="majorSeventhSlideAccuracyValue" class="accuracy-value">--</div>
                </div>

                <!-- Vertical Slider (Full Height, Left Side) -->
                <div id="majorSeventhSlideSliderContainer" class="tone-slide-slider-container">
                    <div id="majorSeventhSlideSlider" class="tone-slide-slider">
                        <div id="majorSeventhSlideKnob" class="tone-slide-knob"></div>
                        <div id="majorSeventhSlideTrack" class="tone-slide-track"></div>
                    </div>
                </div>

                <!-- Right side content: Instructions and Controls -->
                <div class="tone-slide-right-panel">
                    <!-- Instructions Container -->
                    <div id="majorSeventhSlideInstructions"></div>

                    <!-- Control Buttons -->
                    <div class="tone-slide-controls">
                        <div class="tone-slide-top-buttons">
                            <button id="majorSeventhSlideBackBtn" class="btn-exercise-small btn-secondary">
                                <div class="btn-content">
                                    <div class="btn-text">Back</div>
                                </div>
                            </button>

                            <button id="majorSeventhSlidePlayRootBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Root</div>
                                    <div id="majorSeventhSlidePlayRootIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>

                            <button id="majorSeventhSlidePlayTargetBtn" class="btn-exercise-small btn-next">
                                <div class="btn-content-vertical">
                                    <div class="btn-text">Target</div>
                                    <div id="majorSeventhSlidePlayTargetIcon" class="play-pause-icon">‚ñ∂</div>
                                </div>
                            </button>
                        </div>

                        <button id="majorSeventhSlideNextBtn" class="btn-exercise-large btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Next ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Major Seventh Darts Exercise -->
    <div id="majorSeventhDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="majorSeventhDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Major Seventh Darts</p>
            </div>
            <button id="audioSettingsBtnMajorSeventhDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>

        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="majorSeventhDartsRounds" class="dart-corner-value">0</div>
                </div>

                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="majorSeventhDartsScore" class="dart-corner-value">0</div>
                </div>

                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="majorSeventhDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>

                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>

                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>

                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="majorSeventhDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="majorSeventhDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>


    <!-- Interference Visualization Exercise -->
    <div id="interferenceVizExercise" class="container exercise-container" style="display: none;" data-interference="exercise">
        <header>
            <button id="interferenceVizExitBtn" class="back-btn" aria-label="Back" data-interference="exit">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Interference Visualization</p>
            </div>
        </header>
        <main>
            <section class="card">
                <!-- Canvas container -->
                <div style="position: relative; width: 100%; height: 600px; background: #0a0a14; border-radius: 8px;">
                    <canvas id="interferenceVizCanvasWebGL" data-interference="canvas" style="position: absolute; top: 0; left: 0; display: block;"></canvas>
                </div>

                <!-- Main Controls -->
                <div style="margin-top: 20px; display: grid; gap: 20px;">
                    <!-- Primary Actions -->
                    <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                        <button id="interferenceVizPlayBothBtn" data-interference="play-both" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            ‚ñ∂Ô∏è Play Both
                        </button>
                        <button id="interferenceVizRandomizeBtn" data-interference="randomize" class="btn-control" style="font-size: 18px; padding: 12px 32px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            üé≤ Randomize & Play
                        </button>
                    </div>

                    <!-- Individual Tone Controls -->
                    <details open style="border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 16px;">
                        <summary style="cursor: pointer; font-weight: bold; font-size: 16px; margin-bottom: 12px;">üéµ Individual Tone Controls</summary>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 12px;">
                            <!-- Tone 1 -->
                            <div style="padding: 12px; background: rgba(0, 255, 255, 0.05); border-radius: 8px; border: 1px solid rgba(0, 255, 255, 0.2);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <h3 style="margin: 0; color: #00ffff;">Tone 1 (Root)</h3>
                                    <button id="interferenceVizPlayTone1Btn" data-interference="play-tone1" class="btn-control" style="padding: 6px 16px;">Play</button>
                                </div>
                                <div class="frequency-controls">
                                    <input type="range" id="interferenceVizTone1Freq" data-interference="tone1-slider" min="27" max="4186" value="440" step="0.01" style="width: 100%;">
                                    <input type="number" id="interferenceVizTone1FreqNum" data-interference="tone1-input" min="27" max="4186" value="440.00" step="0.01" style="width: 100%; margin-top: 8px;">
                                </div>
                            </div>

                            <!-- Tone 2 -->
                            <div style="padding: 12px; background: rgba(255, 0, 255, 0.05); border-radius: 8px; border: 1px solid rgba(255, 0, 255, 0.2);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <h3 style="margin: 0; color: #ff00ff;">Tone 2 (Interval)</h3>
                                    <button id="interferenceVizPlayTone2Btn" data-interference="play-tone2" class="btn-control" style="padding: 6px 16px;">Play</button>
                                </div>
                                <div class="frequency-controls">
                                    <input type="range" id="interferenceVizTone2Freq" data-interference="tone2-slider" min="27" max="4186" value="440" step="0.01" style="width: 100%;">
                                    <input type="number" id="interferenceVizTone2FreqNum" data-interference="tone2-input" min="27" max="4186" value="440.00" step="0.01" style="width: 100%; margin-top: 8px;">
                                </div>
                            </div>
                        </div>

                        <!-- Solfege Scale Buttons (2 octaves from Do = Tone 1) -->
                        <div style="margin-top: 16px; padding: 12px; background: rgba(255, 255, 255, 0.02); border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="display: flex; flex-wrap: wrap; gap: 6px; justify-content: center;">
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="0" style="padding: 8px 12px;">Do</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="2" style="padding: 8px 12px;">Re</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="4" style="padding: 8px 12px;">Mi</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="5" style="padding: 8px 12px;">Fa</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="7" style="padding: 8px 12px;">Sol</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="9" style="padding: 8px 12px;">La</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="11" style="padding: 8px 12px;">Ti</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="12" style="padding: 8px 12px;">Do¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="14" style="padding: 8px 12px;">Re¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="16" style="padding: 8px 12px;">Mi¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="17" style="padding: 8px 12px;">Fa¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="19" style="padding: 8px 12px;">Sol¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="21" style="padding: 8px 12px;">La¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="23" style="padding: 8px 12px;">Ti¬≤</button>
                                <button class="btn-control solfege-btn" data-interference-solfege data-interval="24" style="padding: 8px 12px;">Do¬≥</button>
                            </div>
                        </div>
                    </details>
                </div>

                <!-- Settings -->
                <details open style="margin-top: 20px;">
                    <summary style="display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0;">Settings</h3>
                        <div style="display: flex; gap: 8px;">
                            <button id="interferenceVizColorSpectrumBtn" data-interference="color-spectrum" class="btn-control" style="padding: 4px 12px; font-size: 12px;">üåà Color Spectrum</button>
                            <button id="interferenceVizPianoSpectrumBtn" data-interference="piano-spectrum" class="btn-control" style="padding: 4px 12px; font-size: 12px;">üéπ Piano Spectrum</button>
                            <button id="interferenceVizCopySettingsBtn" data-interference="copy-settings" class="btn-control" style="padding: 4px 12px; font-size: 12px;">üìã Copy Settings</button>
                        </div>
                    </summary>
                    <div class="settings-panel">
                        <!-- Note: Most WebGL visualization settings are managed programmatically -->
                        <!-- See lib/harmonicRendererSettings.js for configuration -->
                        
                        <div class="cymatic-setting-group">
                            <h4>‚ÑπÔ∏è About the Visualization</h4>
                            <p style="color: #aaa; font-size: 13px; line-height: 1.6;">
                                This visualization uses WebGL to display harmonic interference patterns between two tones.
                                The patterns are dynamically colored based on the consonance/dissonance of the interval.
                            </p>
                            <p style="color: #aaa; font-size: 13px; line-height: 1.6; margin-top: 12px;">
                                <strong>Features:</strong><br>
                                ‚Ä¢ Gravity wells that pulse with beat frequency<br>
                                ‚Ä¢ Consonant intervals (unison, 5th, octave) ‚Üí Cyan/Blue<br>
                                ‚Ä¢ Dissonant intervals (tritone, minor 2nd) ‚Üí Red/Orange<br>
                                ‚Ä¢ Real-time audio-visual synchronization
                            </p>
                        </div>

                        <div class="cymatic-setting-group">
                            <h4>üéπ Quick Intervals</h4>
                            <p style="color: #888; font-size: 12px; margin-bottom: 12px;">Click to hear common intervals:</p>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                                <button class="solfege-btn" data-interference-solfege data-interval="0" style="padding: 8px; font-size: 12px;">Unison</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="2" style="padding: 8px; font-size: 12px;">Major 2nd</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="4" style="padding: 8px; font-size: 12px;">Major 3rd</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="5" style="padding: 8px; font-size: 12px;">Perfect 4th</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="7" style="padding: 8px; font-size: 12px;">Perfect 5th</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="9" style="padding: 8px; font-size: 12px;">Major 6th</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="11" style="padding: 8px; font-size: 12px;">Major 7th</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="12" style="padding: 8px; font-size: 12px;">Octave</button>
                                <button class="solfege-btn" data-interference-solfege data-interval="6" style="padding: 8px; font-size: 12px;">Tritone</button>
                            </div>
                        </div>
                    </div>
                </details>
            </section>
        </main>
    </div>

    <!-- Color Spectrum Modal -->
    <div id="colorSpectrumModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10000; padding: 20px; overflow: auto;">
        <div style="max-width: 1200px; margin: 0 auto; background: #1a1a2e; border-radius: 12px; padding: 30px; position: relative;">
            <button id="colorSpectrumCloseBtn" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.1); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>

            <h2 style="margin: 0 0 20px 0; color: white;">üåà Color Spectrum</h2>
            <p style="color: #aaa; margin-bottom: 30px;">Piano range (A0 27.5 Hz to C8 4186 Hz) showing how colors change with frequency intervals</p>

            <div style="display: flex; gap: 20px; align-items: stretch;">
                <!-- Frequency Labels (vertical, bottom to top) -->
                <div id="colorSpectrumLabels" style="display: flex; flex-direction: column-reverse; justify-content: space-between; min-width: 80px; font-size: 12px; color: #aaa; padding: 10px 0;">
                </div>

                <!-- Root Color Bar -->
                <div style="display: flex; flex-direction: column;">
                    <div style="text-align: center; margin-bottom: 10px; color: white; font-weight: bold; font-size: 14px;">Root</div>
                    <div id="colorSpectrumRootBar" style="width: 60px; flex: 1; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5);"></div>
                </div>

                <!-- Piano Coloring Spectrum -->
                <div style="display: flex; flex-direction: column;">
                    <div style="text-align: center; margin-bottom: 10px; color: white; font-weight: bold; font-size: 14px;">Piano Coloring</div>
                    <canvas id="colorSpectrumPianoCanvas" style="width: 80px; height: 600px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5);"></canvas>
                </div>

                <!-- Continuous Gradient Spectrum -->
                <div style="display: flex; flex-direction: column; flex: 1;">
                    <div style="text-align: center; margin-bottom: 10px; color: white; font-weight: bold; font-size: 14px;">Continuous Gradient</div>
                    <canvas id="colorSpectrumCanvas" style="width: 100%; height: 600px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5);"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Piano Spectrum Modal -->
    <div id="pianoSpectrumModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10000; padding: 20px; overflow: auto;">
        <div style="max-width: 1400px; margin: 0 auto; background: #1a1a2e; border-radius: 12px; padding: 30px; position: relative;">
            <button id="pianoSpectrumCloseBtn" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.1); border: none; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>

            <h2 style="margin: 0 0 20px 0; color: white;">üéπ Piano Spectrum (C as Root)</h2>
            <p style="color: #aaa; margin-bottom: 30px;">Full 88-key piano keyboard showing interval colors relative to C</p>

            <canvas id="pianoSpectrumCanvas" style="width: 100%; height: 300px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5); background: #0a0a0a;"></canvas>
        </div>
    </div>

    <!-- Wave Visualization Exercise -->
    <div id="waveVisualizationExercise" class="container exercise-container" data-wave-viz="exercise" style="display: none;">
        <header>
            <button id="waveVizExitBtn" data-wave-viz="exit" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Wave Visualization</p>
            </div>
        </header>
        <main>
            <section class="card">
                <div class="wave-viz-frame">
                    <div class="wave-viz-frame-inner">
                        <canvas id="waveVizCanvas" data-wave-viz="canvas" width="1200" height="420"></canvas>
                    </div>
                </div>

                <div class="wave-viz-controls">
                    <div class="wave-viz-primary-actions">
                        <button id="waveVizPlayBothBtn" data-wave-viz="play-both" class="btn-control wave-viz-primary-btn">
                            ‚ñ∂Ô∏è Play Both
                        </button>
                        <button id="waveVizRandomizeBtn" data-wave-viz="randomize" class="btn-control wave-viz-primary-btn wave-viz-random">
                            üé≤ Randomize & Play
                        </button>
                    </div>

                    <div class="wave-viz-toggle-group">
                        <span class="wave-viz-toggle-label">View Mode:</span>
                        <label class="wave-viz-toggle-option">
                            <input type="radio" name="waveVizViewMode" value="side-by-side" id="waveVizViewSideBySide" data-wave-viz="view-side" checked>
                            <span>Split View</span>
                        </label>
                        <label class="wave-viz-toggle-option">
                            <input type="radio" name="waveVizViewMode" value="overlay" id="waveVizViewOverlay" data-wave-viz="view-overlay">
                            <span>Overlay</span>
                        </label>
                    </div>

                    <details class="wave-viz-tone-panel" open>
                        <summary>üéõÔ∏è Tone Controls</summary>
                        <div class="wave-viz-tone-grid">
                            <div class="wave-viz-tone-card wave-viz-tone-root">
                                <div class="wave-viz-tone-header">
                                    <h3>Tone 1 ¬∑ Root</h3>
                                    <button id="waveVizPlayTone1Btn" data-wave-viz="play-tone1" class="btn-control">Play</button>
                                </div>
                                <label class="wave-viz-slider-label" for="waveVizTone1Freq">Frequency</label>
                                <input type="range" id="waveVizTone1Freq" data-wave-viz="tone1-slider" min="27" max="4186" value="440" step="0.01">
                                <input type="number" id="waveVizTone1FreqNum" data-wave-viz="tone1-input" min="27" max="4186" value="440.00" step="0.01">
                            </div>
                            <div class="wave-viz-tone-card wave-viz-tone-interval">
                                <div class="wave-viz-tone-header">
                                    <h3>Tone 2 ¬∑ Interval</h3>
                                    <button id="waveVizPlayTone2Btn" data-wave-viz="play-tone2" class="btn-control">Play</button>
                                </div>
                                <label class="wave-viz-slider-label" for="waveVizTone2Freq">Frequency</label>
                                <input type="range" id="waveVizTone2Freq" data-wave-viz="tone2-slider" min="27" max="4186" value="440" step="0.01">
                                <input type="number" id="waveVizTone2FreqNum" data-wave-viz="tone2-input" min="27" max="4186" value="440.00" step="0.01">
                            </div>
                        </div>
                    </details>

                    <div class="wave-viz-solfege">
                        <span class="wave-viz-solfege-label">Intervals:</span>
                        <div class="wave-viz-solfege-buttons">
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="0">Do</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="1">Di</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="2">Re</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="3">Ri</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="4">Mi</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="5">Fa</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="6">Fi</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="7">So</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="8">Si</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="9">La</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="10">Li</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="11">Ti</button>
                            <button class="btn-control wave-viz-solfege-btn" data-wave-viz-solfege data-interval="12">Do‚Üë</button>
                        </div>
                    </div>

                    <div class="wave-viz-meta">
                        <div class="wave-viz-meta-item">
                            <span class="wave-viz-meta-label">Root:</span>
                            <span id="waveVizTone1Label" data-wave-viz="tone1-label" class="wave-viz-meta-value">A4 ¬∑ 440 Hz</span>
                        </div>
                        <div class="wave-viz-meta-item">
                            <span class="wave-viz-meta-label">Interval:</span>
                            <span id="waveVizTone2Label" data-wave-viz="tone2-label" class="wave-viz-meta-value">A4 ¬∑ 440 Hz</span>
                        </div>
                        <div class="wave-viz-meta-item">
                            <span class="wave-viz-meta-label">Difference:</span>
                            <span id="waveVizDifferenceLabel" data-wave-viz="difference-label" class="wave-viz-meta-value">0 cents</span>
                        </div>
                    </div>

                    <p class="wave-viz-note">
                        Overlapping waves glow brighter using the Interference Visualization color spectrum. Split View stacks Root and Interval, while Overlay blends them for interference highlights.
                    </p>
                </div>
            </section>
        </main>
    </div>

    <!-- Ear Training Overview Tutorial -->
    <div id="earTrainingOverviewExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="earTrainingOverviewExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>Ear Training Overview</h1>
            </div>
        </header>
        <main>
            <!-- Tutorial Panel -->
            <div class="tutorial-panel card">
                <div class="tutorial-text">
                    <h2 id="earTrainingOverviewTitle" style="margin: 0 0 12px 0; color: rgba(0, 255, 136, 0.95); font-size: 1.5rem;">Welcome to Ear Training!</h2>
                    <div id="earTrainingOverviewContent" style="color: rgba(255, 255, 255, 0.9); line-height: 1.6;">
                        PLACEHOLDER: Introduction to ear training and why it's important for musicians.
                    </div>
                </div>
                <div class="tutorial-nav">
                    <button id="earTrainingOverviewPrevBtn" class="btn-control" style="display: none;">‚Üê</button>
                    <span id="earTrainingOverviewStepIndicator">1 / 5</span>
                    <button id="earTrainingOverviewNextBtn" class="btn-control">‚Üí</button>
                </div>

                <!-- Final buttons (shown on last step) -->
                <div id="earTrainingOverviewFinalButtons" class="tutorial-nav" style="display: none;">
                    <button id="earTrainingOverviewMainMenuBtn" class="btn-control">Main Menu</button>
                    <button id="earTrainingOverviewContinueBtn" class="btn-control">Continue ‚Üí</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Overview Exercise -->
    <div id="overviewExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="overviewExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Overview</p>
            </div>
            <button id="audioSettingsBtnOverview" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>
        <main>
            <section class="card tutorial-main">
                <!-- Step Indicator -->
                <div class="tutorial-step-indicator">
                    <span id="overviewStepIndicator">1 / 4</span>
                </div>

                <!-- Content Area -->
                <div class="tutorial-content-area">
                    <h2 id="overviewTitle" class="tutorial-title">Exercise Types</h2>
                    <p id="overviewContent" class="tutorial-content">
                        PLACEHOLDER: Overview of the different exercise types.
                    </p>

                    <!-- Settings Panel -->
                    <details class="overview-settings-panel">
                        <summary class="overview-settings-header">‚öôÔ∏è Tutorial Settings</summary>
                        <div class="overview-settings-content">
                            <label>
                                <input type="checkbox" id="overviewAutoAdvance">
                                <span>Auto-advance to next step (3 seconds)</span>
                            </label>
                            <label>
                                <input type="checkbox" id="overviewShowProgress" checked>
                                <span>Show progress indicator</span>
                            </label>
                            <label>
                                <input type="checkbox" id="overviewCompactMode">
                                <span>Compact mode</span>
                            </label>
                        </div>
                    </details>
                </div>

                <!-- Navigation Buttons -->
                <div class="tutorial-navigation">
                    <button id="overviewPrevBtn" class="btn-tutorial btn-secondary" style="display: none;">
                        <div class="btn-content">
                            <div class="btn-text">‚Üê Previous</div>
                        </div>
                    </button>

                    <button id="overviewNextBtn" class="btn-tutorial btn-next">
                        <div class="btn-content">
                            <div class="btn-text">Next ‚Üí</div>
                        </div>
                    </button>

                    <!-- Final buttons (shown on last step) -->
                    <div id="overviewFinalButtons" class="tutorial-final-buttons" style="display: none;">
                        <button id="overviewMainMenuBtn" class="btn-tutorial btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Main Menu</div>
                            </div>
                        </button>
                        <button id="overviewContinueBtn" class="btn-tutorial btn-next">
                            <div class="btn-content">
                                <div class="btn-text">Continue ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Interval Overview Exercise (Tutorial: Frequency, Pitch, Intervals) -->
    <div id="intervalOverviewExercise" class="container exercise-container" style="display: none;">
        <header>
            <button data-claude="exit" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Pitch Overview</p>
            </div>
            <button id="audioSettingsBtnIntervalOverview" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>
        <main>
            <section class="card">
                <!-- Tutorial Instructions -->
                <div style="margin-bottom: 0; padding: 20px; background: rgba(0,255,136,0.1); border-radius: 8px;">
                    <div data-tutorial="text" style="color: rgba(255,255,255,0.9); line-height: 1.6; font-size: 1.1rem;">
                        Loading tutorial...
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px; gap: 15px;">
                        <button data-tutorial="prev" class="btn-control tutorial-nav-btn tutorial-prev-btn" style="min-width: 120px; padding: 12px 24px; background: linear-gradient(135deg, rgba(100,100,120,0.3), rgba(80,80,100,0.3)); border: 2px solid rgba(255,255,255,0.4); box-shadow: 0 4px 12px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.2); border-radius: 6px; font-weight: 600; letter-spacing: 0.5px; transition: all 0.15s ease;">‚Üê Previous</button>
                        <span data-tutorial="progress" style="color: rgba(255,255,255,0.8); font-weight: 500; font-size: 0.95rem;">1 / 15</span>
                        <button data-tutorial="next" class="btn-control tutorial-nav-btn tutorial-next-btn" style="min-width: 120px; padding: 12px 24px; background: linear-gradient(135deg, rgba(0,255,136,0.4), rgba(0,200,100,0.4)); border: 2px solid rgba(0,255,136,0.6); box-shadow: 0 4px 12px rgba(0,255,136,0.3), inset 0 1px 0 rgba(255,255,255,0.2); border-radius: 6px; font-weight: 600; letter-spacing: 0.5px; transition: all 0.15s ease;">Next ‚Üí</button>
                    </div>
                </div>

                <!-- Visualizations (tucked under text box) -->
                <div data-claude-panel="interference" style="margin-top: -10px; margin-bottom: 15px; display: none; position: relative;">
                    <canvas data-claude="interference-canvas" style="width: 100%; max-width: 100%; height: 350px; display: block; background: #000; border-radius: 4px;"></canvas>
                    <div data-claude="interference-hz-labels" style="margin-top: 8px; text-align: center; color: rgba(255,255,255,0.6); font-size: 0.9rem;"></div>
                </div>

                <div data-claude-panel="wave" style="margin-top: -10px; margin-bottom: 15px; display: none;">
                    <canvas data-claude="wave-canvas" style="width: 100%; max-width: 100%; height: 350px; display: block; background: #000; border-radius: 4px;"></canvas>
                    <div data-claude="wave-settings-panel" style="margin-top: 10px; text-align: center; display: none;">
                        <label style="color: rgba(255,255,255,0.9); margin-right: 15px; cursor: pointer;">
                            <input type="radio" name="waveMode" data-claude="wave-mode" value="sideBySide" checked>
                            Side-by-Side
                        </label>
                        <label style="color: rgba(255,255,255,0.9); cursor: pointer;">
                            <input type="radio" name="waveMode" data-claude="wave-mode" value="overlay">
                            Overlay
                        </label>
                    </div>
                </div>

                <!-- Visualization Selection (hidden - tutorial controls viz directly) -->
                <div data-tutorial-target="vizSelection" style="display: none;">
                    <label style="color: rgba(255,255,255,0.9); margin-right: 20px; cursor: pointer;">
                        <input type="radio" name="vizSelect" data-viz-select="none" value="none">
                        None
                    </label>
                    <label style="color: rgba(255,255,255,0.9); margin-right: 20px; cursor: pointer;">
                        <input type="radio" name="vizSelect" data-viz-select="wave" value="wave" checked>
                        Wave
                    </label>
                    <label style="color: rgba(255,255,255,0.9); cursor: pointer;">
                        <input type="radio" name="vizSelect" data-viz-select="interference" value="interference">
                        Interference
                    </label>
                </div>

                <!-- Simplified Controls (tutorial-controlled) -->
                <div data-tutorial-target="simplifiedControls" class="tutorial-hidden" style="margin-bottom: 15px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 8px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div style="text-align: center;">
                            <div style="color: rgba(255,255,255,0.6); margin-bottom: 10px; text-transform: uppercase; font-size: 0.9rem;">Root</div>
                            <button data-simple="play-root" class="btn-control" style="font-size: 1.5rem; padding: 15px 30px; width: 100%;">440 Hz</button>
                        </div>
                        <div style="text-align: center;">
                            <div style="color: rgba(255,255,255,0.6); margin-bottom: 10px; text-transform: uppercase; font-size: 0.9rem;">Interval</div>
                            <div style="display: flex; gap: 6px; justify-content: center; margin-bottom: 10px;">
                                <button data-simple="interval-down" class="btn-control" style="padding: 8px 12px;">‚Üì</button>
                                <button data-simple="interval-flat" class="btn-control" style="padding: 8px 12px;">‚ô≠</button>
                                <button data-simple="interval-value" class="btn-control" style="font-size: 1.2rem; padding: 8px 16px; min-width: 100px;">660 Hz</button>
                                <button data-simple="interval-sharp" class="btn-control" style="padding: 8px 12px;">‚ôØ</button>
                                <button data-simple="interval-up" class="btn-control" style="padding: 8px 12px;">‚Üë</button>
                            </div>
                            <button data-simple="play-interval" class="btn-control" style="width: 100%;">Play Interval</button>
                        </div>
                    </div>
                </div>

                <!-- Advanced Controls (tutorial-controlled) -->
                <div data-tutorial-target="advancedControls" class="tutorial-hidden" style="margin-bottom: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px;">
                    <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                        <button data-claude="play-both" class="btn-control">Play Both</button>
                        <button data-claude="randomize" class="btn-control">Randomize</button>
                        <button data-claude="toggle-interference" class="btn-control">Interference</button>
                        <button data-claude="toggle-wave" class="btn-control">Wave</button>
                    </div>
                    <div style="display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 15px;">
                        <button class="btn-control" data-claude-solfege data-interval="0">Unison</button>
                        <button class="btn-control" data-claude-solfege data-interval="1">m2</button>
                        <button class="btn-control" data-claude-solfege data-interval="2">M2</button>
                        <button class="btn-control" data-claude-solfege data-interval="3">m3</button>
                        <button class="btn-control" data-claude-solfege data-interval="4">M3</button>
                        <button class="btn-control" data-claude-solfege data-interval="5">P4</button>
                        <button class="btn-control" data-claude-solfege data-interval="6">TT</button>
                        <button class="btn-control" data-claude-solfege data-interval="7">P5</button>
                        <button class="btn-control" data-claude-solfege data-interval="8">m6</button>
                        <button class="btn-control" data-claude-solfege data-interval="9">M6</button>
                        <button class="btn-control" data-claude-solfege data-interval="10">m7</button>
                        <button class="btn-control" data-claude-solfege data-interval="11">M7</button>
                        <button class="btn-control" data-claude-solfege data-interval="12">8ve</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: rgba(255,255,255,0.8); display: block; margin-bottom: 5px; font-size: 0.85rem;">Tone 1 (Hz)</label>
                            <input type="range" data-claude="tone1-slider" min="220" max="880" value="440" style="width: 100%;">
                            <input type="number" data-claude="tone1-input" min="220" max="880" value="440" class="btn-control" style="width: 100%; margin-top: 5px; padding: 6px;">
                        </div>
                        <div>
                            <label style="color: rgba(255,255,255,0.8); display: block; margin-bottom: 5px; font-size: 0.85rem;">Tone 2 (Hz)</label>
                            <input type="range" data-claude="tone2-slider" min="220" max="880" value="660" style="width: 100%;">
                            <input type="number" data-claude="tone2-input" min="220" max="880" value="660" class="btn-control" style="width: 100%; margin-top: 5px; padding: 6px;">
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Unison Overview Exercise (Tutorial: Pitch, Frequency, Unison) -->
    <div id="unisonOverviewExercise" class="container exercise-container" style="display: none;">
        <header>
            <button data-unison="exit" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Unison Overview</p>
            </div>
            <button id="audioSettingsBtnUnisonOverview" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>
        <main>
            <section class="card">
                <!-- Tutorial Instructions -->
                <div style="margin-bottom: 0; padding: 20px; background: rgba(0,255,136,0.1); border-radius: 8px;">
                    <div data-tutorial="text" style="color: rgba(255,255,255,0.9); line-height: 1.6; font-size: 1.1rem;">
                        Loading tutorial...
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px; gap: 15px;">
                        <button data-tutorial="prev" class="btn-control tutorial-nav-btn tutorial-prev-btn" style="min-width: 120px; padding: 12px 24px; background: linear-gradient(135deg, rgba(100,100,120,0.3), rgba(80,80,100,0.3)); border: 2px solid rgba(255,255,255,0.4); box-shadow: 0 4px 12px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.2); border-radius: 6px; font-weight: 600; letter-spacing: 0.5px; transition: all 0.15s ease;">‚Üê Previous</button>
                        <span data-tutorial="progress" style="color: rgba(255,255,255,0.8); font-weight: 500; font-size: 0.95rem;">1 / 15</span>
                        <button data-tutorial="next" class="btn-control tutorial-nav-btn tutorial-next-btn" style="min-width: 120px; padding: 12px 24px; background: linear-gradient(135deg, rgba(0,255,136,0.4), rgba(0,200,100,0.4)); border: 2px solid rgba(0,255,136,0.6); box-shadow: 0 4px 12px rgba(0,255,136,0.3), inset 0 1px 0 rgba(255,255,255,0.2); border-radius: 6px; font-weight: 600; letter-spacing: 0.5px; transition: all 0.15s ease;">Next ‚Üí</button>
                    </div>
                </div>

                <!-- Visualizations (tucked under text box) -->
                <div data-unison-panel="interference" style="margin-top: -10px; margin-bottom: 15px; display: none; position: relative;">
                    <canvas data-unison="interference-canvas" style="width: 100%; max-width: 100%; height: 350px; display: block; background: #000; border-radius: 4px;"></canvas>
                    <div data-unison="interference-hz-labels" style="margin-top: 8px; text-align: center; color: rgba(255,255,255,0.6); font-size: 0.9rem;"></div>
                </div>

                <div data-unison-panel="wave" style="margin-top: -10px; margin-bottom: 15px; display: none;">
                    <canvas data-unison="wave-canvas" style="width: 100%; max-width: 100%; height: 350px; display: block; background: #000; border-radius: 4px;"></canvas>
                    <div data-unison="wave-settings-panel" style="margin-top: 10px; text-align: center; display: none;">
                        <label style="color: rgba(255,255,255,0.9); margin-right: 15px; cursor: pointer;">
                            <input type="radio" name="unisonWaveMode" data-unison="wave-mode" value="sideBySide" checked>
                            Side-by-Side
                        </label>
                        <label style="color: rgba(255,255,255,0.9); cursor: pointer;">
                            <input type="radio" name="unisonWaveMode" data-unison="wave-mode" value="overlay">
                            Overlay
                        </label>
                    </div>
                </div>

                <!-- Visualization Selection (hidden - tutorial controls viz directly) -->
                <div data-tutorial-target="vizSelection" style="display: none;">
                    <label style="color: rgba(255,255,255,0.9); margin-right: 20px; cursor: pointer;">
                        <input type="radio" name="unisonVizSelect" data-viz-select="none" value="none">
                        None
                    </label>
                    <label style="color: rgba(255,255,255,0.9); margin-right: 20px; cursor: pointer;">
                        <input type="radio" name="unisonVizSelect" data-viz-select="wave" value="wave" checked>
                        Wave
                    </label>
                    <label style="color: rgba(255,255,255,0.9); cursor: pointer;">
                        <input type="radio" name="unisonVizSelect" data-viz-select="interference" value="interference">
                        Interference
                    </label>
                </div>

                <!-- Simplified Controls (tutorial-controlled) -->
                <div data-tutorial-target="simplifiedControls" class="tutorial-hidden" style="margin-bottom: 15px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 8px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div style="text-align: center;">
                            <div style="color: rgba(255,255,255,0.6); margin-bottom: 10px; text-transform: uppercase; font-size: 0.9rem;">Root</div>
                            <button data-simple="play-root" class="btn-control" style="font-size: 1.5rem; padding: 15px 30px; width: 100%;">440 Hz</button>
                        </div>
                        <div style="text-align: center;">
                            <div style="color: rgba(255,255,255,0.6); margin-bottom: 10px; text-transform: uppercase; font-size: 0.9rem;">Root Note</div>
                            <div style="display: flex; gap: 6px; justify-content: center; margin-bottom: 10px;">
                                <button data-simple="interval-down" class="btn-control" style="padding: 8px 12px;">‚Üì</button>
                                <button data-simple="interval-flat" class="btn-control" style="padding: 8px 12px;">‚ô≠</button>
                                <button data-simple="interval-value" class="btn-control" style="font-size: 1.2rem; padding: 8px 16px; min-width: 100px;">440 Hz</button>
                                <button data-simple="interval-sharp" class="btn-control" style="padding: 8px 12px;">‚ôØ</button>
                                <button data-simple="interval-up" class="btn-control" style="padding: 8px 12px;">‚Üë</button>
                            </div>
                            <button data-simple="play-interval" class="btn-control" style="width: 100%;">Play Root Note</button>
                        </div>
                    </div>
                </div>

                <!-- Advanced Controls (tutorial-controlled) -->
                <div data-tutorial-target="advancedControls" class="tutorial-hidden" style="margin-bottom: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px;">
                    <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                        <button data-unison="play-both" class="btn-control">Play Both</button>
                        <button data-unison="randomize" class="btn-control">Randomize</button>
                        <button data-unison="toggle-interference" class="btn-control">Interference</button>
                        <button data-unison="toggle-wave" class="btn-control">Wave</button>
                    </div>
                    <div style="display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 15px;">
                        <button class="btn-control" data-unison-solfege="unison">Unison</button>
                        <button class="btn-control" data-unison-solfege="minor-second">m2</button>
                        <button class="btn-control" data-unison-solfege="major-second">M2</button>
                        <button class="btn-control" data-unison-solfege="minor-third">m3</button>
                        <button class="btn-control" data-unison-solfege="major-third">M3</button>
                        <button class="btn-control" data-unison-solfege="fourth">P4</button>
                        <button class="btn-control" data-unison-solfege="tritone">TT</button>
                        <button class="btn-control" data-unison-solfege="fifth">P5</button>
                        <button class="btn-control" data-unison-solfege="minor-sixth">m6</button>
                        <button class="btn-control" data-unison-solfege="major-sixth">M6</button>
                        <button class="btn-control" data-unison-solfege="minor-seventh">m7</button>
                        <button class="btn-control" data-unison-solfege="major-seventh">M7</button>
                        <button class="btn-control" data-unison-solfege="octave">8ve</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="color: rgba(255,255,255,0.8); display: block; margin-bottom: 5px; font-size: 0.85rem;">Tone 1 (Hz)</label>
                            <input type="range" data-unison="tone1-slider" min="220" max="880" value="440" style="width: 100%;">
                            <input type="number" data-unison="tone1-input" min="220" max="880" value="440" class="btn-control" style="width: 100%; margin-top: 5px; padding: 6px;">
                        </div>
                        <div>
                            <label style="color: rgba(255,255,255,0.8); display: block; margin-bottom: 5px; font-size: 0.85rem;">Tone 2 (Hz)</label>
                            <input type="range" data-unison="tone2-slider" min="220" max="880" value="440" style="width: 100%;">
                            <input type="number" data-unison="tone2-input" min="220" max="880" value="440" class="btn-control" style="width: 100%; margin-top: 5px; padding: 6px;">
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- General Interval Overview Exercise -->
    <div id="generalIntervalOverviewExercise" class="container exercise-container" style="display: none;">
        <header>
            <button data-interval="exit" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1 data-interval="title">ToneDeath</h1>
                <p data-interval="subtitle" class="subtitle">Interval Overview</p>
            </div>
            <button id="audioSettingsBtnGeneralIntervalOverview" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>
        <main>
            <section class="card tutorial-main">

                <!-- Interference Visualization Panel -->
                <div data-interval-panel="interference" style="margin-bottom: 20px;">
                    <canvas data-interval="interference-canvas" style="width: 100%; height: 400px; display: block; background: #000;"></canvas>
                </div>

                <!-- Wave Visualization Panel -->
                <div data-interval-panel="wave" style="margin-bottom: 20px; display: none;">
                    <canvas data-interval="wave-canvas" style="width: 100%; height: 400px; display: block; background: #000;"></canvas>
                </div>

                <!-- Tone Controls (hidden initially, shown by tutorial) -->
                <div style="display: none; margin-bottom: 20px;" id="generalIntervalToneControls">
                    <button data-interval="play-both" class="btn-control">Play Both</button>
                    <button data-interval="randomize" class="btn-control">Randomize</button>
                    <input type="range" data-interval="tone1-slider" min="220" max="880" value="440">
                    <input type="number" data-interval="tone1-input" min="220" max="880" value="440">
                    <input type="range" data-interval="tone2-slider" min="220" max="880" value="660">
                    <input type="number" data-interval="tone2-input" min="220" max="880" value="660">
                </div>

                <!-- Tutorial Content Area -->
                <div class="tutorial-content-area">
                    <h2 id="generalIntervalOverviewTitle" class="tutorial-title">Interval Overview</h2>
                    <p id="generalIntervalOverviewContent" class="tutorial-content">
                        Loading tutorial...
                    </p>

                    <!-- Settings Panel -->
                    <details class="overview-settings-panel">
                        <summary class="overview-settings-header">‚öôÔ∏è Tutorial Settings</summary>
                        <div class="overview-settings-content">
                            <label>
                                <input type="checkbox" id="generalIntervalOverviewAutoAdvance">
                                <span>Auto-advance to next step (3 seconds)</span>
                            </label>
                            <label>
                                <input type="checkbox" id="generalIntervalOverviewShowProgress" checked>
                                <span>Show progress indicator</span>
                            </label>
                            <label>
                                <input type="checkbox" id="generalIntervalOverviewCompactMode">
                                <span>Compact mode</span>
                            </label>
                        </div>
                    </details>
                </div>

                <!-- Step Indicator -->
                <div class="tutorial-step-indicator">
                    <span id="generalIntervalOverviewStepIndicator">1 / 10</span>
                </div>

                <!-- Navigation Buttons -->
                <div class="tutorial-navigation">
                    <button id="generalIntervalOverviewPrevBtn" class="btn-tutorial btn-secondary" style="display: none;">
                        <div class="btn-content">
                            <div class="btn-text">‚Üê Previous</div>
                        </div>
                    </button>

                    <button id="generalIntervalOverviewNextBtn" class="btn-tutorial btn-next">
                        <div class="btn-content">
                            <div class="btn-text">Next ‚Üí</div>
                        </div>
                    </button>

                    <!-- Final buttons (shown on last step) -->
                    <div id="generalIntervalOverviewFinalButtons" class="tutorial-final-buttons" style="display: none;">
                        <button id="generalIntervalOverviewMainMenuBtn" class="btn-tutorial btn-secondary">
                            <div class="btn-content">
                                <div class="btn-text">Main Menu</div>
                            </div>
                        </button>
                        <button id="generalIntervalOverviewContinueBtn" class="btn-tutorial btn-next">
                            <div class="btn-content">
                                <div class="btn-text">Continue ‚Üí</div>
                            </div>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Scale Darts Exercise -->
    <div id="scaleDartsExercise" class="container exercise-container" style="display: none;">
        <header>
            <button id="scaleDartsExitBtn" class="back-btn" aria-label="Back">‚Üê Back</button>
            <div class="header-center">
                <h1>ToneDeath</h1>
                <p class="subtitle">Scale Darts</p>
            </div>
            <button id="audioSettingsBtnScaleDarts" class="settings-btn" aria-label="Audio Settings">‚öôÔ∏è</button>
        </header>
        <main>
            <section class="card exercise-main dart-game-container">
                <!-- Rounds Display - Upper Left -->
                <div class="dart-rounds-corner">
                    <div class="dart-corner-label">Rounds</div>
                    <div id="scaleDartsRounds" class="dart-corner-value">0</div>
                </div>
                <!-- Score Display - Upper Right -->
                <div class="dart-score-corner">
                    <div class="dart-corner-label">Score</div>
                    <div id="scaleDartsScore" class="dart-corner-value">0</div>
                </div>
                <!-- Target Indicator - Center Top -->
                <div class="dart-target-indicator">
                    <div id="scaleDartsTarget" class="dart-target-text">Target: Re</div>
                </div>
                <!-- Dartboard -->
                <div class="dartboard-container">
                    <div id="scaleDartsDartboard" class="dartboard">
                        <!-- Black ring (50-100 cents) -->
                        <div class="dart-segment dart-black-ring"></div>
                        <!-- Main scoring area (0-50 cents) -->
                        <div class="dart-segment dart-main-area"></div>
                        <!-- Perfect center (bullseye) -->
                        <div class="dart-segment dart-bullseye"></div>
                    </div>
                </div>
                <!-- Play Button - Below dartboard -->
                <div class="dart-button-container">
                    <button id="scaleDartsPlayBtn" class="btn-dart-play btn-next">
                        <div class="btn-content-vertical">
                            <div class="btn-text">Play Root</div>
                            <div id="scaleDartsPlayIcon" class="play-pause-icon">‚ñ∂</div>
                        </div>
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Audio System -->
    <script src="audioManager.js"></script>

    <!-- Pitchy library (for alternative pitch detection) - bundled locally -->
    <script src="pitchy.bundle.js?v=1759963744"></script>

    <!-- Pitch Detectors (v2 = custom, pitchy = library-based) -->
    <script src="pitchDetector.v2.js?v=1759963744"></script>
    <script src="pitchDetector.pitchy.js?v=1759963744"></script>
    <script src="pitchDetectorConfig.js?v=1759963744"></script>

    <script src="toneGenerator.v2.js"></script>
    <script src="settings.js"></script>
    <script src="tipsAndTricks.js"></script>
    <script src="debugMode.js"></script>
    <script src="audioSettings.js"></script>
    <script src="setup.js"></script>
    <script src="glissandoExercise.js"></script>
    <script src="intonationExercise.js"></script>
    <script src="pitchHoldExercise.js"></script>
    <script src="octaveExercise.js"></script>
    <script src="scaleExercise.js"></script>
    <script src="toneDartsExercise.js"></script>
    <script src="audioDiagnostics.js"></script>
    <script src="exerciseInstructions.js"></script>
    <script src="feelTheRootExercise.js"></script>
    <script src="intervalSlideExercise.js"></script>
    <script src="intervalDartsExercise.js"></script>
    <script src="scaleDartsExercise.js"></script>
    <script src="earTrainingOverview.js"></script>
    <script src="overviewExercise.js"></script>
    <!-- Interference Visualization Modules -->
    <script src="lib/consonanceColorSystem.js?v=1"></script>
    <script src="lib/speakerOverlayRenderer.js?v=6"></script>
    <script src="lib/dualToneAudioController.js?v=1"></script>
    <script src="lib/harmonicRendererSettings.js?v=3"></script>
    <script src="waveVisualization.js?v=1"></script>
    <script src="interferenceVisualization.js?v=24"></script>
    <script src="intervalOverviewTutorial.js?v=1"></script>
    <script src="unisonOverviewTutorial.js?v=1"></script>
    <script src="tutorialController.js?v=1"></script>
    <script src="intervalOverview.js?v=2"></script>
    <script src="unisonOverview.js?v=1"></script>
    <script src="intervalConfigs.js?v=1"></script>
    <script src="intervalOverviewTutorialTemplate.js?v=1"></script>
    <script src="generalIntervalOverview.js?v=1"></script>
    <script src="intervalSystemExerciseConfigs.js?v=1"></script>
    <script src="intervalSystemExercise.js?v=1"></script>
    <script src="app.js"></script>
    <script>
        // Global button click sound
        const buttonClickGenerator = new ToneGenerator();

        document.addEventListener('DOMContentLoaded', () => {
            // Add click sound to all buttons
            document.addEventListener('click', (e) => {
                const button = e.target.closest('button');
                console.log('[Global Click Handler] Received click event, button:', button?.textContent || 'none');
                if (button && !button.disabled) {
                    // Skip sound for buttons with no-sound class
                    if (button.classList.contains('no-sound')) {
                        // Add visual flash effect
                        button.style.transition = 'filter 0.08s ease, transform 0.08s ease';
                        button.style.filter = 'brightness(2.0)';
                        button.style.transform = 'scale(1.05)';
                        setTimeout(() => {
                            button.style.filter = 'brightness(1)';
                            button.style.transform = 'scale(1)';
                        }, 80);
                        return;
                    }

                    // Check if we're in the interval overview or unison overview
                    const intervalOverviewExercise = document.getElementById('intervalOverviewExercise');
                    const unisonOverviewExercise = document.getElementById('unisonOverviewExercise');

                    // Handle Interval Overview (Pitch Overview) - suppress all sounds
                    if (intervalOverviewExercise && intervalOverviewExercise.style.display !== 'none') {
                        console.log('[Button Click] In Pitch Overview - suppressing sound for button:', button.textContent);
                        // Add visual flash effect
                        button.style.transition = 'filter 0.08s ease, transform 0.08s ease';
                        button.style.filter = 'brightness(2.0)';
                        button.style.transform = 'scale(1.05)';
                        setTimeout(() => {
                            button.style.filter = 'brightness(1)';
                            button.style.transform = 'scale(1)';
                        }, 80);
                        return;
                    }

                    console.log('[Button Click] NOT in Pitch Overview, display:', intervalOverviewExercise?.style.display);

                    // Handle Unison Overview - suppress all sounds
                    if (unisonOverviewExercise && unisonOverviewExercise.style.display !== 'none') {
                        // Add visual flash effect
                        button.style.transition = 'filter 0.08s ease, transform 0.08s ease';
                        button.style.filter = 'brightness(2.0)';
                        button.style.transform = 'scale(1.05)';
                        setTimeout(() => {
                            button.style.filter = 'brightness(1)';
                            button.style.transform = 'scale(1)';
                        }, 80);
                        return;
                    }

                    buttonClickGenerator.playButtonClick();
                }
            });

            // iOS Install Prompt - disabled by default
            // Users can access installation instructions from settings if needed

            // Close install modal
            const closeBtn = document.getElementById('closeInstallModal');
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    document.getElementById('iosInstallModal').style.display = 'none';
                });
            }

            // Don't show again (just close the modal)
            const dontShowBtn = document.getElementById('dontShowAgain');
            if (dontShowBtn) {
                dontShowBtn.addEventListener('click', () => {
                    document.getElementById('iosInstallModal').style.display = 'none';
                });
            }

            // Make install modal globally accessible for settings menu
            window.showInstallInstructions = () => {
                const modal = document.getElementById('iosInstallModal');
                if (modal) {
                    modal.style.display = 'flex';
                }
            };
        });
    </script>
</body>
</html>
